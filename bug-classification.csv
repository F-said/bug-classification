Statement,Bug
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'test', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStream', ';']",0
"['import', 'java', '.', 'util', '.', 'HashMap', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'java', '.', 'util', '.', 'Properties', ';']",0
"['import', 'java', '.', 'net', '.', 'URL', ';']",0
"['import', 'java', '.', 'util', '.', 'List', ';']",0
"['import', 'java', '.', 'util', '.', 'ArrayList', ';']",0
"['import', 'java', '.', 'util', '.', 'Set', ';']",0
"['import', 'junit', '.', 'framework', '.', 'AssertionFailedError', ';']",0
"['import', 'org', '.', 'junit', '.', 'Test', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'LoadFunc', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'FuncSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'PigStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataBag', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'TupleFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ExecType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'builtin', '.', 'GFAny', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'BufferedPositionedInputStream', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'OperatorKey', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', '*', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'schema', '.', 'Schema', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'parser', '.', 'ParseException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'MultiMap', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'test', '.', 'utils', '.', 'Identity', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['public', 'class', 'TestLogicalPlanBuilder', 'extends', 'junit', '.', 'framework', '.', 'TestCase', '{']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['public', 'void', 'testQuery1', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '$', '1', ',', '$', '2', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery2', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", 'using', '""', '+', 'PigStorage', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ""'"", ':', ""'"", ')', ')', 'generate', '$', '1', ',', ""'"", 'aoeuaoeu', ""'"", ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['/', '/', 'TODO', 'FIX', 'Query3', 'and', 'Query4']",0
"['public', 'void', 'testQuery3', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'cogroup', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '$', '1', ',', '(', 'load', ""'"", 'b', ""'"", ')', 'by', '$', '1', ')', 'generate', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'AVG', '(', '$', '1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery4', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', 'AVG', '(', '$', '1', ',', '$', '2', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery5', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'ALL', ')', 'generate', '$', '1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery6', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '$', '1', ')', 'generate', 'group', ',', ""'"", '1', ""'"", ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery7', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", 'using', '""', '+', 'PigStorage', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', ')', 'generate', '$', '1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery10', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'cogroup', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '(', '$', '1', ')', ',', '(', 'load', ""'"", 'b', ""'"", ')', 'by', '(', '$', '1', ')', ')', 'generate', '$', '1', '.', '$', '1', ',', '$', '2', '.', '$', '1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['/', '/', 'TODO', 'FIX', 'Query11', 'and', 'Query12']",0
"['public', 'void', 'testQuery11', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '$', '1', ',', '(', 'load', ""'"", 'b', ""'"", ')', 'by', '$', '2', ')', 'generate', 'group', ',', 'AVG', '(', '$', '1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery12', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", 'using', '""', '+', 'PigStorage', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', ')', 'generate', 'AVG', '(', '$', '1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery13', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'cogroup', '(', 'load', ""'"", 'a', ""'"", ')', 'ALL', ')', 'generate', 'group', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery14', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '(', '$', '6', ',', '$', '7', ')', ')', 'generate', 'flatten', '(', 'group', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery15', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '$', '1', ',', ""'"", 'hello', ""'"", ',', '$', '3', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery100', '(', ')', '{']",0
"['/', '/', 'test', 'define', 'syntax']",0
"['String', 'query', '=', '""', 'define', 'FUNC', 'ARITY', '(', ')', ';', '""', ';']",0
"['LogicalOperator', 'lo', '=', 'buildPlan', '(', 'query', ')', '.', 'getRoots', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'lo', 'instanceof', 'LODefine', ')', ';']",0
"['public', 'void', 'testQueryFail1', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'group', '(', 'A', '=', 'load', ""'"", 'a', ""'"", ')', 'by', '$', '1', ')', 'generate', 'A', '.', ""'"", '1', ""'"", ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQueryFail2', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'by', '$', '1', 'generate', '$', '1', '.', '*', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQueryFail3', '(', ')', '{']",0
"['String', 'query', '=', '""', 'generate', 'DISTINCT', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQueryFail4', '(', ')', '{']",0
"['String', 'query', '=', '""', 'generate', '[', 'ORDER', 'BY', '$', '0', ']', '[', '$', '3', ',', '$', '4', ']', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQueryFail5', '(', ')', '{']",0
"['String', 'query', '=', '""', 'generate', '""', '+', 'TestApplyFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '2', '.', '*', ')', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['/', '*', '*']",0
"['/', '/', 'TODO', 'FIX', 'Query17']",0
"['public', 'void', 'testQuery17', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'A', ""'"", ')', '""', '+', '""', 'generate', '""', '+', 'TestApplyFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['static', 'public', 'class', 'TestApplyFunc', 'extends', 'org', '.', 'apache', '.', 'pig', '.', 'EvalFunc', '<', 'Tuple', '>', '{']",0
"['public', 'Tuple', 'exec', '(', 'Tuple', 'input', ')', 'throws', 'IOException', '{']",0
"['Tuple', 'output', '=', 'TupleFactory', '.', 'getInstance', '(', ')', '.', 'newTuple', '(', 'input', '.', 'getAll', '(', ')', ')', ';']",0
"['return', 'output', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'testQuery18', '(', ')', '{']",0
"['String', 'query', '=', '""', 'FOREACH', '(', 'group', '(', 'load', ""'"", 'a', ""'"", ')', 'ALL', 'PARALLEL', '16', ')', 'generate', 'group', ';', '""', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', 'query', ')', ';']",0
"['LogicalOperator', 'root', '=', 'lp', '.', 'getRoots', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['List', '<', 'LogicalOperator', '>', 'listOp', '=', 'lp', '.', 'getSuccessors', '(', 'root', ')', ';']",0
"['LogicalOperator', 'lo', '=', 'listOp', '.', 'get', '(', '0', ')', ';']",0
"['if', '(', 'lo', 'instanceof', 'LOCogroup', ')', '{']",0
"['assertTrue', '(', '(', '(', 'LOCogroup', ')', 'lo', ')', '.', 'getRequestedParallelism', '(', ')', '=', '=', '16', ')', ';']",0
"['}', 'else', '{']",1
"['fail', '(', '""', 'Error', ':', 'Unexpected', 'Parse', 'Tree', 'output', '""', ')', ';']",0
"['public', 'void', 'testQuery19', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', '$', '1', '=', '=', ""'"", '3', ""'"", ';', '""', ')', ';']",0
"['public', 'void', 'testQuery20', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '(', '$', '1', '=', '=', ""'"", '3', ""'"", '?', '$', '2', ':', '$', '3', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery21', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'foreach', '(', 'cogroup', 'A', 'by', '(', '$', '1', ')', ',', 'B', 'by', '(', '$', '1', ')', ')', 'generate', 'A', ',', 'flatten', '(', 'B', '.', '(', '$', '1', ',', '$', '2', ',', '$', '3', ')', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery22', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'cogroup', 'A', 'by', '(', '$', '1', ')', ',', 'B', 'by', '(', '$', '1', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', 'C', '{', '""', '+']",0
"['""', 'B', '=', 'order', 'B', 'by', '$', '0', ';', '""', '+']",0
"['""', 'generate', 'FLATTEN', '(', 'A', ')', ',', 'B', '.', '(', '$', '1', ',', '$', '2', ',', '$', '3', ')', ';', '""', '+']",0
"['""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery22Fail', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'group', 'A', 'by', '(', '*', ',', '$', '0', ')', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Grouping', 'attributes', 'can', 'either', 'be', 'star', '(', '*', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery23', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'cogroup', 'A', 'by', '(', '$', '1', ')', ',', 'B', 'by', '(', '$', '1', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', 'C', '{', '""', '+']",0
"['""', 'A', '=', 'Distinct', 'A', ';', '""', '+']",0
"['""', 'B', '=', 'FILTER', 'A', 'BY', '$', '1', '<', ""'"", 'z', ""'"", ';', '""', '+']",0
"['/', '/', 'TODO']",0
"['/', '/', 'A', 'sequence', 'of', 'filters', 'within', 'a', 'foreach', 'translates', 'to']",0
"['/', '/', 'a', 'split', 'statement', '.', 'Currently', 'it', 'breaks', 'as', 'adding', 'an']",0
"['/', '/', 'additional', 'output', 'to', 'the', 'filter', 'fails', 'as', 'filter', 'supports']",0
"['/', '/', 'single', 'output']",0
"['""', 'C', '=', 'FILTER', 'A', 'BY', '$', '2', '=', '=', '$', '3', ';', '""', '+']",0
"['""', 'B', '=', 'ARRANGE', 'B', 'BY', '$', '1', ';', '""', '+']",0
"['""', 'GENERATE', 'A', ',', 'FLATTEN', '(', 'B', '.', '$', '0', ')', ';', '""', '+']",0
"['""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery23Fail', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'group', 'A', 'by', '(', '*', ',', '$', '0', ')', ',', 'B', 'by', '(', '$', '0', ',', '$', '1', ')', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Grouping', 'attributes', 'can', 'either', 'be', 'star', '(', '*', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery24', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', 'a', 'generate', '(', '(', '$', '0', '=', '=', '$', '1', ')', '?', ""'"", 'a', ""'"", ':', '$', '2', ')', ',', '$', '4', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery25', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', '{', '""', '+']",0
"['""', 'B', '=', 'FILTER', '$', '0', 'BY', '(', '(', '$', '1', '=', '=', '$', '2', ')', 'AND', '(', ""'"", 'a', ""'"", '<', ""'"", 'b', ""'"", ')', ')', ';', '""', '+']",0
"['""', 'generate', 'B', ';', '""', '+']",0
"['""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery26', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '(', '(', 'NOT', '(', '(', '$', '1', '=', '=', '$', '2', ')', 'OR', '(', ""'"", 'a', ""'"", '<', ""'"", 'b', ""'"", ')', ')', ')', '?', ""'"", 'a', ""'"", ':', '$', '2', ')', ',', ""'"", 'x', ""'"", ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['/', '/', 'TODO', 'FIX', 'Query27', 'and', 'Query28']",0
"['public', 'void', 'testQuery27', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', '{', '""', '+']",0
"['""', 'A', '=', 'DISTINCT', '$', '3', '.', '$', '1', ';', '""', '+']",0
"['""', 'generate', '""', '+', 'TestApplyFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '2', ',', '$', '1', '.', '(', '$', '1', ',', '$', '4', ')', ')', ';', '""', '+']",0
"['""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery28', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '""', '+', 'TestApplyFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '2', ',', '""', '+', 'TestApplyFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '2', '.', '$', '3', ')', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery29', '(', ')', '{']",0
"['String', 'query', '=', '""', 'load', ""'"", 'myfile', ""'"", 'using', '""', '+', 'TestStorageFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', 'as', '(', 'col1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery30', '(', ')', '{']",0
"['String', 'query', '=', '""', 'load', ""'"", 'myfile', ""'"", 'using', '""', '+', 'TestStorageFunc', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', 'as', '(', 'col1', ',', 'col2', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'static', 'class', 'TestStorageFunc', 'implements', 'LoadFunc', '{']",0
"['public', 'void', 'bindTo', '(', 'String', 'fileName', ',', 'BufferedPositionedInputStream', 'is', ',', 'long', 'offset', ',', 'long', 'end', ')', 'throws', 'IOException', '{']",0
"['public', 'Tuple', 'getNext', '(', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'void', 'fieldsToRead', '(', 'Schema', 'schema', ')', '{']",0
"['public', 'DataBag', 'bytesToBag', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Boolean', 'bytesToBoolean', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'String', 'bytesToCharArray', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Double', 'bytesToDouble', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Float', 'bytesToFloat', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Integer', 'bytesToInteger', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Long', 'bytesToLong', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Map', '<', 'Object', ',', 'Object', '>', 'bytesToMap', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'Tuple', 'bytesToTuple', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'DataBag', 'bag', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'String', 's', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Double', 'd', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Float', 'f', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Integer', 'i', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Long', 'l', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Map', '<', 'Object', ',', 'Object', '>', 'm', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Tuple', 't', ')', 'throws', 'IOException', '{']",0
"['return', 'null', ';']",0
"['/', '*', '(', 'non', '-', 'Javadoc', ')']",0
"['public', 'Schema', 'determineSchema', '(', 'String', 'fileName', ',', 'ExecType', 'execType', ',']",0
"['DataStorage', 'storage', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'TODO', 'Auto', '-', 'generated', 'method', 'stub']",0
"['return', 'null', ';']",0
"['public', 'void', 'testQuery31', '(', ')', '{']",0
"['String', 'query', '=', '""', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'col1', ',', 'col2', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery32', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'col1', ',', 'col2', ':', 'tuple', '(', 'sub1', ',', 'sub2', ')', ',', 'col3', ':', 'tuple', '(', 'bag1', ')', ')', ')', 'generate', 'col1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery33', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'aCol1', ',', 'aCol2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'bCol1', ',', 'bCol2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'cogroup', 'A', 'by', '(', 'aCol1', ')', ',', 'B', 'by', 'bCol1', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', 'C', 'generate', 'group', ',', 'A', '.', 'aCol1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['/', '/', 'TODO', ':', 'Nested', 'schemas', 'don', ""'"", 't', 'work', 'now', '.', 'Probably', 'a', 'bug', 'in', 'the', 'new', 'parser', '.']",0
"['public', 'void', 'testQuery34', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'aCol1', ',', 'aCol2', ':', 'tuple', '(', 'subCol1', ',', 'subCol2', ')', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'A', '=', 'filter', 'A', 'by', 'aCol2', '=', '=', ""'"", '1', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'bCol1', ',', 'bCol2', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', '(', 'cogroup', 'A', 'by', '(', 'aCol1', ')', ',', 'B', 'by', 'bCol1', ')', 'generate', 'A', '.', 'aCol2', ',', 'B', '.', 'bCol2', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery35', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", 'as', '(', 'col1', ',', 'col2', ')', ')', 'generate', 'col1', ',', 'col2', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery36', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'cogroup', '(', 'load', ""'"", 'a', ""'"", 'as', '(', 'col1', ',', 'col2', ')', ')', 'by', 'col1', ')', 'generate', '$', '1', '.', '(', 'col2', ',', 'col1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQueryFail37', '(', ')', '{']",0
"['String', 'query', '=', '""', 'A', '=', 'load', ""'"", 'a', ""'"", ';', 'asdasdas', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery38', '(', ')', '{']",0
"['String', 'query', '=', '""', 'c', '=', 'cross', '(', 'load', ""'"", 'a', ""'"", ')', ',', '(', 'load', ""'"", 'b', ""'"", ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['/', '/', 'TODO', 'FIX', 'Query39', 'and', 'Query40']",0
"['public', 'void', 'testQuery39', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'host', ',', 'rank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'url', ',', 'host', ')', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', '.', 'url', ')', ',', 'SUM', '(', 'a', '.', 'rank', ')', 'as', 'totalRank', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'filter', 'c', 'by', 'totalRank', '>', ""'"", '10', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'totalRank', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail39', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'host', ',', 'rank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'url', ',', 'host', ')', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', '.', 'url', ')', ',', 'SUM', '(', 'a', '.', 'rank', ')', 'as', 'totalRank', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'filter', 'c', 'by', 'totalRank', '>', ""'"", '10', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'url', ';', '""', ')', ';', '/', '/', 'url', 'has', 'been', 'falttened', 'and', 'hence', 'the', 'failure']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery40', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'FILTER', '(', 'load', ""'"", 'a', ""'"", ')', 'BY', 'IsEmpty', '(', '$', '2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'FILTER', '(', 'load', ""'"", 'a', ""'"", ')', 'BY', '(', 'IsEmpty', '(', '$', '2', ')', 'AND', '(', '$', '3', '=', '=', '$', '2', ')', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail41', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'a', 'as', '(', 'host', ',', 'url', ')', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Currently', 'PIG', 'does', 'not', 'support', 'assigning', 'an', 'existing', 'relation', '""', ')', ')', ';']",0
"['/', '/', 'TODO']",0
"['/', '/', 'the', 'following', 'statement', 'was', 'earlier', 'present']",0
"['/', '/', 'eventually', 'when', 'we', 'do', 'allow', 'assignments', 'of', 'the', 'form']",0
"['/', '/', 'above', ',', 'we', 'should', 'test', 'with', 'the', 'line', 'below']",0
"['/', '/', 'uncommented']",0
"['/', '/', 'buildPlan', '(', '""', 'foreach', 'b', 'generate', 'host', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery42', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '$', '0', 'as', 'url', ',', '$', '1', 'as', 'rank', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'foreach', 'b', 'generate', 'url', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery43', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'rank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', 'url', ',', 'b', 'by', 'url', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'group', ',', 'flatten', '(', 'a', ')', ',', 'flatten', '(', 'b', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'group', ',', 'a', ':', ':', 'url', ',', 'b', ':', ':', 'url', ',', 'b', ':', ':', 'rank', ',', 'rank', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail43', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'cogroup', 'a', 'by', '(', 'name', ',', 'age', ')', ',', 'b', 'by', '(', 'height', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery44', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'pagerank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'url', ',', 'query', ',', 'rank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', '(', 'pagerank', '#', ""'"", 'nonspam', ""'"", ',', 'url', ')', ',', 'b', 'by', '(', 'rank', '/', ""'"", '2', ""'"", ',', 'url', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'foreach', 'c', 'generate', 'group', '.', 'url', ';', '""', ')', ';']",0
"['/', '/', 'TODO']",0
"['/', '/', 'Commented', 'out', 'testQueryFail44', 'as', 'I', 'am', 'not', 'able', 'to', 'include', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['public', 'void', 'testQueryFail44', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'pig', '=', 'null', ';']",0
"['pig', '=', 'new', 'PigServer', '(', '""', 'local', '""', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['assertTrue', '(', 'false', ')', ';', '/', '/', 'pig', 'server', 'failed', 'for', 'some', 'reason']",0
"['pig', '.', 'registerFunction', '(', '""', 'myTr', '""', ',']",0
"['new', 'FuncSpec', '(', 'GFAny', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ""'"", 'tr', 'o', '0', ""'"", ')', '""', ')', ')', ';']",0
"['pig', '.', 'registerQuery', '(', '""', 'b', '=', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', 'myTr', '(', 'myTr', '(', '*', ')', ')', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['assertTrue', '(', 'false', ')', ';']",0
"['/', '/', 'Select']",0
"['public', 'void', 'testQuery45', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'select', 'url', ',', 'hitCount', 'from', 'A', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'url', ',', 'hitCount', 'from', 'B', ';', '""', ')', ';']",0
"['/', '/', 'Select', '+', 'Join']",0
"['public', 'void', 'testQuery46', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'url', ',', 'pageRank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'A', '.', 'hitCount', ',', 'B', '.', 'pageRank', 'from', 'A', 'join', 'B', 'on', 'A', '.', 'url', '=', '=', 'B', '.', 'url', ';', '""', ')', ';']",0
"['/', '/', 'Mutliple', 'Joins']",0
"['public', 'void', 'testQuery47', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'url', ',', 'pageRank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'load', ""'"", 'c', ""'"", 'as', '(', 'pageRank', ',', 'position', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'select', 'A', '.', 'url', ',', 'A', '.', 'hitCount', ',', 'B', '.', 'pageRank', 'from', '(', 'A', 'join', 'B', 'on', 'A', '.', 'url', '=', '=', 'B', '.', 'url', ')', 'join', 'C', 'on', 'B', '.', 'pageRank', '=', '=', 'C', '.', 'pageRank', ';', '""', ')', ';']",0
"['/', '/', 'Group']",0
"['public', 'void', 'testQuery48', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', ';', '""', ')', ';']",0
"['/', '/', 'Join', '+', 'Group']",0
"['public', 'void', 'testQuery49', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'B', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'url', ',', 'pageRank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'B', '.', 'pageRank', ')', ',', 'SUM', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'join', 'B', 'on', 'A', '.', 'url', '=', '=', 'B', '.', 'url', 'group', 'by', 'A', '.', 'url', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having']",0
"['public', 'void', 'testQuery50', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', 'having', 'AVG', '(', 'A', '.', 'hitCount', ')', '>', ""'"", '6', ""'"", ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order']",0
"['public', 'void', 'testQuery51', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', 'order', 'by', 'A', '.', 'url', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order']",0
"['public', 'void', 'testQuery52', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', 'having', 'AVG', '(', 'A', '.', 'hitCount', ')', '>', ""'"", '6', ""'"", 'order', 'by', 'A', '.', 'url', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order', '2']",0
"['public', 'void', 'testQuery53', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', 'having', 'AVG', '(', 'A', '.', 'hitCount', ')', '>', ""'"", '6', ""'"", 'order', 'by', 'AVG', '(', 'A', '.', 'hitCount', ')', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order', '2']",0
"['public', 'void', 'testQuery54', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ',', 'size', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', 'having', 'AVG', '(', 'A', '.', 'size', ')', '>', ""'"", '6', ""'"", 'order', 'by', 'AVG', '(', 'A', '.', 'hitCount', ')', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order', '2']",0
"['public', 'void', 'testQuery55', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ',', 'size', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'AVG', '(', 'A', '.', 'hitCount', ')', ',', 'SUM', '(', 'A', '.', 'size', ')', 'from', 'A', 'group', 'by', 'url', 'having', 'AVG', '(', 'A', '.', 'size', ')', '>', ""'"", '6', ""'"", 'order', 'by', 'AVG', '(', 'A', '.', 'hitCount', ')', ';', '""', ')', ';']",0
"['/', '/', 'Group', '+', 'Having', '+', 'Order', '2']",0
"['public', 'void', 'testQuery56', '(', ')', '{']",0
"['buildPlan', '(', '""', 'A', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'hitCount', ',', 'date', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'C', '=', 'select', 'A', '.', 'url', ',', 'A', '.', 'date', ',', 'SUM', '(', 'A', '.', 'hitCount', ')', 'from', 'A', 'group', 'by', 'url', ',', 'date', 'having', 'AVG', '(', 'A', '.', 'hitCount', ')', '>', ""'"", '6', ""'"", 'order', 'by', 'A', '.', 'date', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery57', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'a', ""'"", ')', 'generate', '(', '$', '1', '+', '$', '2', ')', ',', '(', '$', '1', '-', '$', '2', ')', ',', '(', '$', '1', '*', '$', '2', ')', ',', '(', '$', '1', '/', '$', '2', ')', ',', '(', '$', '1', '%', '$', '2', ')', ',', '-', '(', '$', '1', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery58', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'foreach', 'b', '{', 'd', '=', 'a', '.', 'name', ';', 'generate', 'group', ',', 'd', ';', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQueryFail58', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'url', ',', 'host', ',', 'rank', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'url', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', '.', 'url', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery59', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'join', 'a', 'by', 'name', ',', 'b', 'by', 'name', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery60', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'cross', 'a', ',', 'b', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery61', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'union', 'a', ',', 'b', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery62', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'cross', 'a', ',', 'b', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['buildPlan', '(', '""', 'd', '=', 'order', 'c', 'by', 'b', ':', ':', 'name', ',', 'height', ',', 'a', ':', ':', 'gpa', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'order', 'a', 'by', 'name', ',', 'age', ',', 'gpa', 'desc', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'f', '=', 'order', 'a', 'by', '$', '0', 'asc', ',', 'age', ',', 'gpa', 'desc', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'g', '=', 'order', 'a', 'by', '*', 'asc', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'h', '=', 'cogroup', 'a', 'by', 'name', ',', 'b', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'i', '=', 'foreach', 'h', '{', 'i1', '=', 'order', 'a', 'by', '*', ';', 'generate', 'i1', ';', '}', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail62', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'cross', 'a', ',', 'b', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['buildPlan', '(', '""', 'd', '=', 'order', 'c', 'by', 'name', ',', 'b', ':', ':', 'name', ',', 'height', ',', 'a', ':', ':', 'gpa', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery63', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'details', ':', 'tuple', '(', 'age', ',', 'gpa', ')', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'details', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'b', 'generate', 'group', '.', 'age', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'a', 'generate', 'name', ',', 'details', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail63', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'col1', ',', 'col2', ':', '(', 'sub1', ',', 'sub2', ')', ',', 'col3', ':', '(', 'bag1', ')', ')', ')', 'generate', 'col1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery64', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ':', 'chararray', ',', 'details', ':', 'tuple', '(', 'age', ',', 'gpa', ')', ',', 'mymap', ':', 'map', '[', ']', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'details', ':', 'bag', '{', 'mytuple', ':', 'tuple', '(', 'age', ':', 'int', ',', 'gpa', ')', '}', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'details', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'b', 'generate', 'group', '.', 'age', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'a', 'generate', 'name', ',', 'details', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'f', '=', 'LOAD', ""'"", 'myfile', ""'"", 'AS', '(', 'garage', ':', 'bag', '{', 'tuple1', ':', 'tuple', '(', 'num_tools', ':', 'int', ')', '}', ',', 'links', ':', 'bag', '{', 'tuple2', ':', 'tuple', '(', 'websites', ':', 'chararray', ')', '}', ',', 'page', ':', 'bag', '{', 'something_stupid', ':', 'tuple', '(', 'yeah_double', ':', 'double', ')', '}', ',', 'coordinates', ':', 'bag', '{', 'another_tuple', ':', 'tuple', '(', 'ok_float', ':', 'float', ',', 'bite_the_array', ':', 'bytearray', ',', 'bag_of_unknown', ':', 'bag', '{', '}', ')', '}', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail64', '(', ')', '{']",0
"['String', 'query', '=', '""', 'foreach', '(', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'col1', ',', 'col2', ':', 'bag', '{', 'age', ':', 'int', '}', ')', ')', 'generate', 'col1', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery65', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', '(', 'name', ',', 'age', ')', ',', 'b', 'by', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'group', '.', 'name', ',', 'a', '.', 'name', 'as', 'aName', ',', 'b', '.', 'name', 'as', 'b', ':', ':', 'name', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail65', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', '(', 'name', ',', 'age', ')', ',', 'b', 'by', '(', 'name', ',', 'height', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'group', '.', 'name', ',', 'a', '.', 'name', ',', 'b', '.', 'height', 'as', 'age', ',', 'a', '.', 'age', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery67', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'age', ',', 'age', '*', '10L', ',', 'gpa', '/', '0', '.', '2f', ',', '{', '(', '16', ',', '4', '.', '0e', '-', '2', ',', ""'"", 'hello', ""'"", ')', '}', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery68', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '10', ',', '{', '(', '16', ',', '4', '.', '0e', '-', '2', ',', ""'"", 'hello', ""'"", ')', ',', '(', '0', '.', '5f', ',', '12l', ',', ""'"", 'another', 'tuple', ""'"", ')', '}', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery69', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '16', ',', '4', '.', '0e', '-', '2', ',', ""'"", 'hello', ""'"", ')', ',', '(', '0', '.', '5f', ',', ""'"", 'another', 'tuple', ""'"", ',', '12L', ',', '(', '1', ')', ')', '}', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery70', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '[', '10L', '#', ""'"", 'hello', ""'"", ',', '4', '.', '0e', '-', '2', '#', '10L', ',', '0', '.', '5f', '#', '(', '1', ')', ',', ""'"", 'world', ""'"", '#', '42', ',', '42', '#', '{', '(', ""'"", 'guide', ""'"", ')', '}', ']', 'as', 'mymap', ':', 'map', '[', ']', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'mymap', '#', '10L', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail67', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'age', ',', 'age', '*', '10L', ',', 'gpa', '/', '0', '.', '2f', ',', '{', '16', ',', '4', '.', '0e', '-', '2', ',', ""'"", 'hello', ""'"", '}', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQueryFail68', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '16', 'L', ',', '4', '.', '0e', '-', '2', ',', ""'"", 'hello', ""'"", ')', ',', '(', '0', '.', '5f', ',', ""'"", 'another', 'tuple', ""'"", ',', '12L', ',', '{', '(', ')', '}', ')', '}', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery71', '(', ')', '{']",0
"['buildPlan', '(', '""', 'split', '(', 'load', ""'"", 'a', ""'"", ')', 'into', 'x', 'if', '$', '0', '>', ""'"", '7', ""'"", ',', 'y', 'if', '$', '0', '<', ""'"", '7', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'x', 'generate', '$', '0', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '$', '1', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery72', '(', ')', '{']",0
"['buildPlan', '(', '""', 'split', '(', 'load', ""'"", 'a', ""'"", ')', 'into', 'x', 'if', '$', '0', '>', ""'"", '7', ""'"", ',', 'y', 'if', '$', '0', '<', ""'"", '7', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'x', 'generate', '(', 'int', ')', '$', '0', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '(', 'bag', '{', '}', ')', '$', '1', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'y', 'generate', '(', 'int', ')', '(', '$', '1', '/', '2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'y', 'generate', '(', 'bag', '{', 'tuple', '(', 'int', ',', 'float', ')', '}', ')', '(', '$', '1', '/', '2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'f', '=', 'foreach', 'x', 'generate', '(', 'tuple', '(', 'int', ',', 'float', ')', ')', '(', '$', '1', '/', '2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'g', '=', 'foreach', 'x', 'generate', '(', 'tuple', '(', ')', ')', '(', '$', '1', '/', '2', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'h', '=', 'foreach', 'x', 'generate', '(', 'chararray', ')', '(', '$', '1', '/', '2', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail72', '(', ')', '{']",0
"['buildPlan', '(', '""', 'split', '(', 'load', ""'"", 'a', ""'"", ')', 'into', 'x', 'if', '$', '0', '>', ""'"", '7', ""'"", ',', 'y', 'if', '$', '0', '<', ""'"", '7', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '(', 'bag', ')', '$', '1', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '(', 'bag', '{', 'int', ',', 'float', '}', ')', '$', '1', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '(', 'tuple', ')', '$', '1', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery73', '(', ')', '{']",0
"['buildPlan', '(', '""', 'split', '(', 'load', ""'"", 'a', ""'"", ')', 'into', 'x', 'if', '$', '0', '>', ""'"", '7', ""'"", ',', 'y', 'if', '$', '0', '<', ""'"", '7', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'x', 'by', '$', '0', 'matches', ""'"", '^', 'fred', '.', '*', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'y', 'generate', '$', '0', ',', '(', '$', '0', 'matches', ""'"", 'yuri', '.', '*', ""'"", '?', '$', '1', '-', '10', ':', '$', '1', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery74', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'field1', ':', 'int', ',', 'field2', ':', 'long', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'field1', ':', 'bytearray', ',', 'field2', ':', 'double', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'a', 'by', 'field1', ',', 'b', 'by', 'field1', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'cogroup', 'a', 'by', '(', '(', 'field1', '+', 'field2', ')', '*', 'field1', ')', ',', 'b', 'by', 'field1', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery77', '(', ')', '{']",0
"['buildPlan', '(', '""', 'limit', '(', 'load', ""'"", 'a', ""'"", ')', '100', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery75', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'union', '(', 'load', ""'"", 'a', ""'"", ')', ',', '(', 'load', ""'"", 'b', ""'"", ')', ',', '(', 'load', ""'"", 'c', ""'"", ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', '{', 'generate', '$', '0', ';', '}', 'parallel', '10', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery76', '(', ')', '{']",0
"['buildPlan', '(', '""', 'split', '(', 'load', ""'"", 'a', ""'"", ')', 'into', 'x', 'if', '$', '0', '>', ""'"", '7', ""'"", ',', 'y', 'if', '$', '0', '<', ""'"", '7', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'x', 'by', '$', '0', 'IS', 'NULL', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'filter', 'y', 'by', '$', '0', 'IS', 'NOT', 'NULL', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'b', 'generate', '$', '0', ',', '(', '$', '1', 'IS', 'NULL', '?', '0', ':', '$', '1', '-', '7', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'c', 'generate', '$', '0', ',', '(', '$', '1', 'IS', 'NOT', 'NULL', '?', '$', '1', '-', '5', ':', '0', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery80', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'age', '<', ""'"", '20', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', 'age', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'c', '{', '""']",0
"['+', '""', 'cf', '=', 'filter', 'b', 'by', 'gpa', '<', ""'"", '3', '.', '0', ""'"", ';', '""']",0
"['+', '""', 'cp', '=', 'cf', '.', 'gpa', ';', '""']",0
"['+', '""', 'cd', '=', 'distinct', 'cp', ';', '""']",0
"['+', '""', 'co', '=', 'order', 'cd', 'by', 'gpa', ';', '""']",0
"['+', '""', 'generate', 'group', ',', 'flatten', '(', 'co', ')', ';', '""']",0
"['/', '/', '+', '""', 'generate', 'group', ',', 'flatten', '(', 'cd', ')', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery81', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'using', 'PigStorage', '(', ')', 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'split', 'a', 'into', 'b', 'if', 'name', 'lt', ""'"", 'f', ""'"", ',', 'c', 'if', '(', 'name', 'gte', ""'"", 'f', ""'"", 'and', 'name', 'lte', ""'"", 'h', ""'"", ')', ',', 'd', 'if', 'name', 'gt', ""'"", 'h', ""'"", ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail81', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'using', 'PigStorage', '(', ')', 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'split', 'a', 'into', 'b', 'if', 'name', 'lt', ""'"", 'f', ""'"", ',', 'c', 'if', '(', 'name', 'ge', ""'"", 'f', ""'"", 'and', 'name', 'le', ""'"", 'h', ""'"", ')', ',', 'd', 'if', 'name', 'gt', ""'"", 'h', ""'"", ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery82', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '$', '0', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'foreach', 'b', '{', '""']",0
"['+', '""', 'c1', '=', 'order', '$', '1', 'by', '*', ';', '""']",0
"['+', '""', 'c2', '=', '$', '1', '.', '$', '0', ';', '""']",0
"['+', '""', 'generate', 'flatten', '(', 'c1', ')', ',', 'c2', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQueryFail82', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '$', '0', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'foreach', 'b', '{', '""']",0
"['+', '""', 'c1', '=', 'order', '$', '1', 'by', '*', ';', '""']",0
"['+', '""', 'c2', '=', '$', '1', ';', '""']",0
"['+', '""', 'generate', 'flatten', '(', 'c1', ')', ',', 'c2', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Exception', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery83', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'age', '<', ""'"", '20', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'c', '{', '""']",0
"['+', '""', 'cf', '=', 'filter', 'b', 'by', 'gpa', '<', ""'"", '3', '.', '0', ""'"", ';', '""']",0
"['+', '""', 'cp', '=', 'cf', '.', 'gpa', ';', '""']",0
"['+', '""', 'cd', '=', 'distinct', 'cp', ';', '""']",0
"['+', '""', 'co', '=', 'order', 'cd', 'by', 'gpa', ';', '""']",0
"['+', '""', 'generate', 'group', ',', 'flatten', '(', 'co', ')', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery84', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'age', '<', ""'"", '20', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'c', '{', '""']",0
"['+', '""', 'cf', '=', 'filter', 'b', 'by', 'gpa', '<', ""'"", '3', '.', '0', ""'"", ';', '""']",0
"['+', '""', 'cp', '=', 'cf', '.', '$', '2', ';', '""']",0
"['+', '""', 'cd', '=', 'distinct', 'cp', ';', '""']",0
"['+', '""', 'co', '=', 'order', 'cd', 'by', 'gpa', ';', '""']",0
"['+', '""', 'generate', 'group', ',', 'flatten', '(', 'co', ')', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery85', '(', ')', 'throws', 'FrontendException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['LOCogroup', 'cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'nameFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'name', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'ageFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'age', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'gpaFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'gpa', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ';']",0
"['Schema', 'groupSchema', '=', 'new', 'Schema', '(', 'nameFs', ')', ';']",0
"['groupSchema', '.', 'add', '(', 'ageFs', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'groupFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'group', '""', ',', 'groupSchema', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'loadSchema', '=', 'new', 'Schema', '(', 'nameFs', ')', ';']",0
"['loadSchema', '.', 'add', '(', 'ageFs', ')', ';']",0
"['loadSchema', '.', 'add', '(', 'gpaFs', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'a', '""', ',', 'loadSchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', 'cogroupExpectedSchema', '=', 'new', 'Schema', '(', 'groupFs', ')', ';']",0
"['cogroupExpectedSchema', '.', 'add', '(', 'bagFs', ')', ';']",0
"['assertTrue', '(', 'cogroup', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'cogroupExpectedSchema', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', '.', 'name', ',', 'group', '.', 'age', ',', 'COUNT', '(', 'a', '.', 'gpa', ')', ';', '""', ')', ';']",0
"['LOForEach', 'foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 'foreachExpectedSchema', '=', 'new', 'Schema', '(', 'nameFs', ')', ';']",0
"['foreachExpectedSchema', '.', 'add', '(', 'ageFs', ')', ';']",0
"['foreachExpectedSchema', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'LONG', ')', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'foreachExpectedSchema', ')', ')', ';']",0
"['public', 'void', 'testQuery86', '(', ')', 'throws', 'FrontendException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ':', 'Chararray', ',', 'age', ':', 'Int', ',', 'gpa', ':', 'Float', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['LOCogroup', 'cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'nameFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'name', '""', ',', 'DataType', '.', 'CHARARRAY', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'ageFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'age', '""', ',', 'DataType', '.', 'INTEGER', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'gpaFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'gpa', '""', ',', 'DataType', '.', 'FLOAT', ')', ';']",0
"['Schema', 'groupSchema', '=', 'new', 'Schema', '(', 'nameFs', ')', ';']",0
"['groupSchema', '.', 'add', '(', 'ageFs', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'groupFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'group', '""', ',', 'groupSchema', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'loadSchema', '=', 'new', 'Schema', '(', 'nameFs', ')', ';']",0
"['loadSchema', '.', 'add', '(', 'ageFs', ')', ';']",0
"['loadSchema', '.', 'add', '(', 'gpaFs', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'a', '""', ',', 'loadSchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', 'cogroupExpectedSchema', '=', 'new', 'Schema', '(', 'groupFs', ')', ';']",0
"['cogroupExpectedSchema', '.', 'add', '(', 'bagFs', ')', ';']",0
"['assertTrue', '(', 'cogroup', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'cogroupExpectedSchema', ')', ')', ';']",0
"['public', 'void', 'testQuery87', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '$', '0', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', '{', 'c1', '=', 'order', '$', '1', 'by', '$', '1', ';', 'generate', 'flatten', '(', 'c1', ')', ';', '}', ';', '""', ')', ';']",0
"['LOForEach', 'foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LogicalPlan', 'nestedPlan', '=', 'foreach', '.', 'getForEachPlans', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOProject', 'sortInput', '=', '(', 'LOProject', ')', 'nestedPlan', '.', 'getRoots', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOSort', 'nestedSort', '=', '(', 'LOSort', ')', 'nestedPlan', '.', 'getSuccessors', '(', 'sortInput', ')', '.', 'get', '(', '0', ')', ';']",0
"['LogicalPlan', 'sortPlan', '=', 'nestedSort', '.', 'getSortColPlans', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'sortPlan', '.', 'getLeaves', '(', ')', '.', 'size', '(', ')', '=', '=', '1', ')', ';']",0
"['public', 'void', 'testQuery88', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '$', '0', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'order', 'b', 'by', '$', '1', ';', '""', ')', ';']",0
"['LOSort', 'sort', '=', '(', 'LOSort', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOProject', 'project1', '=', '(', 'LOProject', ')', 'sort', '.', 'getSortColPlans', '(', ')', '.', 'get', '(', '0', ')', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOCogroup', 'cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getPredecessors', '(', 'sort', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertEquals', '(', 'project1', '.', 'getExpression', '(', ')', ',', 'cogroup', ')', ';']",0
"['public', 'void', 'testQuery89', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '$', '0', ',', '$', '100', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'i', ':', 'int', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', '$', '0', 'as', 'zero', ',', 'i', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail89', '(', ')', '{']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'i', ':', 'int', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', '$', '0', ',', '$', '5', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Out', 'of', 'bound', 'access', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery90', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ':', 'Chararray', ',', 'age', ':', 'Int', ',', 'gpa', ':', 'Float', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['/', '/', 'the', 'first', 'element', 'in', 'group', ',', 'i', '.', 'e', '.', ',', 'name', 'is', 'renamed', 'as', 'myname']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', 'as', '(', 'myname', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'myname', ':', 'chararray', ',', 'age', ':', 'int', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'the', 'first', 'and', 'second', 'elements', 'in', 'group', ',', 'i', '.', 'e', '.', ',', 'name', 'and', 'age', 'are', 'renamed', 'as', 'myname', 'and', 'myage']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', 'as', '(', 'myname', ',', 'myage', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'myname', ':', 'chararray', ',', 'myage', ':', 'int', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'the', 'schema', 'of', 'group', 'is', 'unchanged']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', 'as', '(', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'group', ':', ':', 'name', ':', 'chararray', ',', 'group', ':', ':', 'age', ':', 'int', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'the', 'first', 'element', 'in', 'group', ',', 'i', '.', 'e', '.', ',', 'name', 'is', 'renamed', 'as', 'myname']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', 'as', 'myname', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'myname', ':', 'chararray', ',', 'age', ':', 'int', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'group', 'is', 'renamed', 'as', 'mygroup']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'mygroup', ':', '(', 'name', ':', 'chararray', ',', 'age', ':', 'int', ')', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'group', 'is', 'renamed', 'as', 'mygroup', 'and', 'the', 'first', 'element', 'is', 'renamed', 'as', 'myname']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', 'myname', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'mygroup', ':', '(', 'myname', ':', 'chararray', ',', 'age', ':', 'int', ')', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'group', 'is', 'renamed', 'as', 'mygroup', 'and', 'the', 'elements', 'are', 'renamed', 'as', 'myname', 'and', 'myage']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', 'myname', ',', 'myage', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'mygroup', ':', '(', 'myname', ':', 'chararray', ',', 'myage', ':', 'int', ')', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'group', 'is', 'renamed', 'to', 'mygroup', 'as', 'the', 'tuple', 'schema', 'is', 'empty']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'mygroup', ':', '(', 'name', ':', 'chararray', ',', 'age', ':', 'int', ')', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'setting', 'the', 'schema', 'of', 'flattened', 'bag', 'that', 'has', 'no', 'schema', 'with', 'the', 'user', 'defined', 'schema']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'another_file', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'cogroup', 'a', 'by', '$', '0', ',', 'c', 'by', '$', '0', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'flatten', '(', 'DIFF', '(', 'a', ',', 'c', ')', ')', 'as', '(', 'x', ',', 'y', ',', 'z', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'bytearray', ',', 'y', ':', 'bytearray', ',', 'z', ':', 'bytearray', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'setting', 'the', 'schema', 'of', 'flattened', 'bag', 'that', 'has', 'no', 'schema', 'with', 'the', 'user', 'defined', 'schema']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'another_file', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'cogroup', 'a', 'by', '$', '0', ',', 'c', 'by', '$', '0', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'flatten', '(', 'DIFF', '(', 'a', ',', 'c', ')', ')', 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'float', ',', 'z', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'int', ',', 'y', ':', 'float', ',', 'z', ':', 'bytearray', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'setting', 'the', 'schema', 'of', 'flattened', 'bag', 'that', 'has', 'no', 'schema', 'with', 'the', 'user', 'defined', 'schema']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'another_file', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'cogroup', 'a', 'by', '$', '0', ',', 'c', 'by', '$', '0', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'flatten', '(', 'DIFF', '(', 'a', ',', 'c', ')', ')', 'as', 'x', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'bytearray', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['/', '/', 'setting', 'the', 'schema', 'of', 'flattened', 'bag', 'that', 'has', 'no', 'schema', 'with', 'the', 'user', 'defined', 'schema']",0
"['buildPlan', '(', '""', 'c', '=', 'load', ""'"", 'another_file', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'cogroup', 'a', 'by', '$', '0', ',', 'c', 'by', '$', '0', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'flatten', '(', 'DIFF', '(', 'a', ',', 'c', ')', ')', 'as', 'x', ':', 'int', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'foreach', '.', 'getSchema', '(', ')', '.', 'equals', '(', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'int', ',', 'mycount', ':', 'long', '""', ')', ')', ')', ';']",0
"['public', 'void', 'testQueryFail90', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ':', 'Chararray', ',', 'age', ':', 'Int', ',', 'gpa', ':', 'Float', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', 'myname', ',', 'myage', ',', 'mygpa', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Schema', 'size', 'mismatch', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', 'myname', ':', 'int', ',', 'myage', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Type', 'mismatch', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '(', 'myname', ',', 'myage', ':', 'chararray', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Type', 'mismatch', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'group', 'as', 'mygroup', ':', '{', 't', ':', '(', 'myname', ',', 'myage', ')', '}', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Type', 'mismatch', '""', ')', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', 'as', '(', 'myname', ',', 'myage', ',', 'mygpa', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'mycount', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Schema', 'size', 'mismatch', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery91', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ':', 'Chararray', ',', 'age', ':', 'Int', ',', 'gpa', ':', 'Float', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'SUM', '(', 'a', '.', 'age', ')', '+', 'SUM', '(', 'a', '.', 'gpa', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery92', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'c', '=', 'foreach', 'b', '{', '""']",0
"['+', '""', 'alias', '=', 'name', '#', ""'"", 'alias', ""'"", ';', '""']",0
"['+', '""', 'af', '=', 'alias', '#', ""'"", 'first', ""'"", ';', '""']",0
"['+', '""', 'al', '=', 'alias', '#', ""'"", 'last', ""'"", ';', '""']",0
"['+', '""', 'generate', 'SUM', '(', 'a', '.', 'age', ')', '+', 'SUM', '(', 'a', '.', 'gpa', ')', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['public', 'void', 'testQuery93', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'a', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'name', ';', '""', ')', ';']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', '""', 'name', '""', 'field', 'and', 'not', 'a', ':', ':', 'name']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'name', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail93', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'a', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'name', ';', '""', ')', ';']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', '""', 'name', '""', 'field', 'and', 'a', ':', ':', 'name']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'a', ':', ':', 'name', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery94', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'two', ""'"", 'as', '(', 'name', ',', 'age', ',', 'somethingelse', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', 'name', ',', 'b', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'flatten', '(', 'a', ')', ',', 'flatten', '(', 'b', ')', ';', '""', ')', ';']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', '""', 'a', ':', ':', 'name', '""', 'field', 'and', 'not', 'name']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', '""', 'b', ':', ':', 'name', '""', 'field', 'and', 'not', 'name']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'a', ':', ':', 'name', ',', 'b', ':', ':', 'name', ';', '""', ')', ';']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', 'gpa', 'and', 'somethingelse']",0
"['buildPlan', '(', '""', 'f', '=', 'foreach', 'd', 'generate', 'gpa', ',', 'somethingelse', ',', 'a', ':', ':', 'gpa', ',', 'b', ':', ':', 'somethingelse', ';', '""', ')', ';']",0
"['public', 'void', 'testQueryFail94', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'two', ""'"", 'as', '(', 'name', ',', 'age', ',', 'somethingelse', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', 'name', ',', 'b', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'flatten', '(', 'a', ')', ',', 'flatten', '(', 'b', ')', ';', '""', ')', ';']",0
"['/', '/', 'test', 'that', 'we', 'can', 'refer', 'to', '""', 'a', ':', ':', 'name', '""', 'field', 'and', 'not', 'name']",0
"['buildPlan', '(', '""', 'e', '=', 'foreach', 'd', 'generate', 'name', ';', '""', ')', ';']",0
"['}', 'catch', '(', 'AssertionFailedError', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Found', 'more', 'than', 'one', 'match', ':', '""', ')', ')', ';']",0
"['public', 'void', 'testQuery95', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'myfile', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', '{', 'd', '=', 'order', 'a', 'by', '$', '1', ';', 'generate', 'flatten', '(', 'd', ')', ',', 'MAX', '(', 'a', '.', 'age', ')', 'as', 'max_age', ';', '}', ';', '""', ')', ';']",0
"['LOForEach', 'foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOCogroup', 'cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getPredecessors', '(', 'foreach', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'a', '""', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'groupFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'group', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ';']",0
"['Schema', 'cogroupExpectedSchema', '=', 'new', 'Schema', '(', ')', ';']",0
"['cogroupExpectedSchema', '.', 'add', '(', 'groupFs', ')', ';']",0
"['cogroupExpectedSchema', '.', 'add', '(', 'bagFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'cogroup', '.', 'getSchema', '(', ')', ',', 'cogroupExpectedSchema', ',', 'false', ',', 'false', ')', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', ',', 'max_age', ':', 'double', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery96', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'input', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'age', '<', '20', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', 'age', ';', '""', ')', ';']",0
"['String', 'query', '=', '""', 'd', '=', 'foreach', 'c', '{', '""']",0
"['+', '""', 'cf', '=', 'filter', 'b', 'by', 'gpa', '<', '3', '.', '0', ';', '""']",0
"['+', '""', 'cd', '=', 'distinct', 'cf', '.', 'gpa', ';', '""']",0
"['+', '""', 'co', '=', 'order', 'cd', 'by', '$', '0', ';', '""']",0
"['+', '""', 'generate', 'group', ',', 'flatten', '(', 'co', ')', ';', '""']",0
"['+', '""', '}', ';', '""', ';']",0
"['LogicalPlan', 'lp', '=', 'buildPlan', '(', 'query', ')', ';']",0
"['LOForEach', 'foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['ArrayList', '<', 'LogicalPlan', '>', 'foreachPlans', '=', 'foreach', '.', 'getForEachPlans', '(', ')', ';']",0
"['LogicalPlan', 'flattenPlan', '=', 'foreachPlans', '.', 'get', '(', '1', ')', ';']",0
"['LogicalOperator', 'project', '=', 'flattenPlan', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'project', 'instanceof', 'LOProject', ')', ';']",0
"['LogicalOperator', 'sort', '=', 'flattenPlan', '.', 'getPredecessors', '(', 'project', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'sort', 'instanceof', 'LOSort', ')', ';']",0
"['LogicalOperator', 'distinct', '=', 'flattenPlan', '.', 'getPredecessors', '(', 'sort', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'distinct', 'instanceof', 'LODistinct', ')', ';']",0
"['/', '/', 'testing', 'the', 'presence', 'of', 'the', 'nested', 'foreach']",0
"['LogicalOperator', 'nestedForeach', '=', 'flattenPlan', '.', 'getPredecessors', '(', 'distinct', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'nestedForeach', 'instanceof', 'LOForEach', ')', ';']",0
"['LogicalPlan', 'nestedForeachPlan', '=', '(', '(', 'LOForEach', ')', 'nestedForeach', ')', '.', 'getForEachPlans', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LogicalOperator', 'nestedProject', '=', 'nestedForeachPlan', '.', 'getRoots', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'nestedProject', 'instanceof', 'LOProject', ')', ';']",0
"['assertTrue', '(', '(', '(', 'LOProject', ')', 'nestedProject', ')', '.', 'getCol', '(', ')', '=', '=', '2', ')', ';']",0
"['/', '/', 'testing', 'the', 'filter', 'inner', 'plan', 'for', 'the', 'absence', 'of', 'the', 'project', 'connected', 'to', 'project']",0
"['LogicalOperator', 'filter', '=', 'flattenPlan', '.', 'getPredecessors', '(', 'nestedForeach', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'filter', 'instanceof', 'LOFilter', ')', ';']",0
"['LogicalPlan', 'comparisonPlan', '=', '(', '(', 'LOFilter', ')', 'filter', ')', '.', 'getComparisonPlan', '(', ')', ';']",0
"['LOLesserThan', 'lessThan', '=', '(', 'LOLesserThan', ')', 'comparisonPlan', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LOProject', 'filterProject', '=', '(', 'LOProject', ')', 'lessThan', '.', 'getLhsOperand', '(', ')', ';']",0
"['assertTrue', '(', 'null', '=', '=', 'comparisonPlan', '.', 'getPredecessors', '(', 'filterProject', ')', ')', ';']",0
"['public', 'void', 'testQuery97', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '1', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'int', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '1L', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'long', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '1', '.', '0', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'double', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '1', '.', '0f', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'float', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', ""'"", 'hello', ""'"", ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'x', ':', 'chararray', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery98', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', '1', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'int', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', '1L', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'long', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', '1', '.', '0', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'double', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', '1', '.', '0f', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'float', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', ""'"", 'hello', ""'"", ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'chararray', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', ""'"", 'hello', ""'"", ',', '1', ',', '1L', ',', '1', '.', '0f', ',', '1', '.', '0', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'chararray', ',', 'y', ':', 'int', ',', 'z', ':', 'long', ',', 'a', ':', 'float', ',', 'b', ':', 'double', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', ""'"", 'hello', ""'"", ',', '{', '(', '1', ')', ',', '(', '1', '.', '0', ')', '}', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 't', ':', '(', 'x', ':', 'chararray', ',', 'ib', ':', '{', 'it', ':', '(', 'd', ':', 'double', ')', '}', ')', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery99', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", 'hello', ""'"", ')', ',', '(', '2', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'int', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1L', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'long', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0f', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'float', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'double', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1L', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0f', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'float', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1L', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'double', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', '.', '0f', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'double', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', '.', '0', ',', ""'"", 'hello', ""'"", ')', ',', '(', '1', '.', '0f', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', 'x', ':', 'double', ',', 'y', ':', 'chararray', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', '.', '0', ',', ""'"", 'hello', ""'"", ',', '3', '.', '14', ')', ',', '(', '1', '.', '0f', ',', ""'"", 'world', ""'"", ')', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'b', ':', '{', 't', ':', '(', ')', '}', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery101', '(', ')', '{']",0
"['/', '/', 'test', 'usage', 'of', 'an', 'alias', 'from', 'define']",0
"['String', 'query', '=', '""', 'define', 'FUNC', 'ARITY', '(', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['query', '=', '""', 'foreach', '(', 'load', ""'"", 'data', ""'"", ')', 'generate', 'FUNC', '(', '$', '0', ')', ';', '""', ';']",0
"['buildPlan', '(', 'query', ')', ';']",1
"['public', 'void', 'testQuery102', '(', ')', '{']",0
"['/', '/', 'test', 'basic', 'store']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'store', 'a', 'into', ""'"", 'out', ""'"", ';', '""', ')', ';']",0
"['public', 'void', 'testQuery103', '(', ')', '{']",0
"['/', '/', 'test', 'store', 'with', 'store', 'function']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'store', 'a', 'into', ""'"", 'out', ""'"", 'using', 'PigStorage', '(', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery104', '(', ')', '{']",0
"['/', '/', 'check', 'that', 'a', 'field', 'alias', 'can', 'be', 'referenced']",0
"['/', '/', 'by', 'unambiguous', 'free', 'form', 'alias', ',', 'fully', 'qualified', 'alias']",0
"['/', '/', 'and', 'partially', 'qualified', 'unambiguous', 'alias']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'st10k', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'a', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'filter', 'c', 'by', 'name', '!', '=', ""'"", 'fred', ""'"", ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'e', '=', 'group', 'd', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'f', '=', 'foreach', 'e', 'generate', 'flatten', '(', 'd', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'g', '=', 'foreach', 'f', 'generate', 'name', ',', 'd', ':', ':', 'a', ':', ':', 'name', ',', 'a', ':', ':', 'name', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery105', '(', ')', '{']",0
"['/', '/', 'test', 'that', 'the', 'alias', '""', 'group', '""', 'can', 'be', 'used']",0
"['/', '/', 'after', 'a', 'flatten', '(', 'group', ')']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'st10k', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', 'name', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'foreach', 'b', 'generate', 'flatten', '(', 'group', ')', ',', 'COUNT', '(', 'a', ')', 'as', 'cnt', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'group', ';', '""', ')', ';']",0
"['public', 'void', 'testQuery106', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '*', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery107', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '*', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['LogicalPlan', 'foreachPlan', '=', 'foreach', '.', 'getForEachPlans', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'foreachPlan', ')', ')', ';']",0
"['public', 'void', 'testQuery108', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOCogroup', 'cogroup', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '*', ';', '""', ')', ';']",0
"['cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 'groupSchema', '=', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ';']",0
"['Schema', 'bagASchema', '=', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'groupFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'group', '""', ',', 'groupSchema', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagAFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'a', '""', ',', 'bagASchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'groupFs', ')', ';']",0
"['expectedSchema', '.', 'add', '(', 'bagAFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'cogroup', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery109', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOCogroup', 'cogroup', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'two', ""'"", 'as', '(', 'first_name', ',', 'enrol_age', ',', 'high_school_gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'group', 'a', 'by', '*', ',', 'b', 'by', '*', ';', '""', ')', ';']",0
"['cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 'groupSchema', '=', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ';']",0
"['Schema', 'bagASchema', '=', 'Util', '.', 'getSchemaFromString', '(', '""', 'name', ':', 'bytearray', ',', 'age', ':', 'bytearray', ',', 'gpa', ':', 'bytearray', '""', ')', ';']",0
"['Schema', 'bagBSchema', '=', 'Util', '.', 'getSchemaFromString', '(', '""', 'first_name', ':', 'bytearray', ',', 'enrol_age', ':', 'bytearray', ',', 'high_school_gpa', ':', 'bytearray', '""', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'groupFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'group', '""', ',', 'groupSchema', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagAFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'a', '""', ',', 'bagASchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagBFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'b', '""', ',', 'bagBSchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'groupFs', ')', ';']",0
"['expectedSchema', '.', 'add', '(', 'bagAFs', ')', ';']",0
"['expectedSchema', '.', 'add', '(', 'bagBFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'cogroup', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery110', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOLoad', 'load', ';']",0
"['LOCogroup', 'cogroup', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'two', ""'"", ';', '""', ')', ';']",0
"['load', '=', '(', 'LOLoad', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', '$', '0', ',', 'b', 'by', '*', ';', '""', ')', ';']",0
"['cogroup', '=', '(', 'LOCogroup', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['MultiMap', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', 'mapGByPlans', '=', 'cogroup', '.', 'getGroupByPlans', '(', ')', ';']",0
"['LogicalPlan', 'cogroupPlan', '=', '(', 'LogicalPlan', ')', '(', 'mapGByPlans', '.', 'get', '(', 'load', ')', '.', 'toArray', '(', ')', ')', '[', '0', ']', ';']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'cogroupPlan', ')', '=', '=', 'true', ')', ';']",0
"['public', 'void', 'testQuery111', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'order', 'a', 'by', '*', ';', '""', ')', ';']",0
"['sort', '=', '(', 'LOSort', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['for', '(', 'LogicalPlan', 'sortPlan', ':', 'sort', '.', 'getSortColPlans', '(', ')', ')', '{']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'sortPlan', ')', '=', '=', 'false', ')', ';']",0
"['public', 'void', 'testQuery112', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'group', 'a', 'by', '*', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'c', '=', 'foreach', 'b', '{', 'a1', '=', 'order', 'a', 'by', '*', ';', 'generate', 'a1', ';', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['for', '(', 'LogicalPlan', 'foreachPlan', ':', 'foreach', '.', 'getForEachPlans', '(', ')', ')', '{']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'foreachPlan', ')', '=', '=', 'true', ')', ';']",0
"['LogicalPlan', 'foreachPlan', '=', 'foreach', '.', 'getForEachPlans', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['sort', '=', '(', 'LOSort', ')', 'foreachPlan', '.', 'getPredecessors', '(', 'foreachPlan', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', '0', ')', ';']",0
"['for', '(', 'LogicalPlan', 'sortPlan', ':', 'sort', '.', 'getSortColPlans', '(', ')', ')', '{']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'sortPlan', ')', '=', '=', 'true', ')', ';']",0
"['public', 'void', 'testQuery113', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', '{', 'exp1', '=', 'age', '+', 'gpa', ';', 'exp2', '=', 'exp1', '+', 'age', ';', 'generate', 'exp1', ',', 'exp2', ';', '}', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['for', '(', 'LogicalPlan', 'foreachPlan', ':', 'foreach', '.', 'getForEachPlans', '(', ')', ')', '{']",0
"['printPlan', '(', 'foreachPlan', ')', ';']",0
"['assertTrue', '(', 'checkPlanForProjectStar', '(', 'foreachPlan', ')', '=', '=', 'false', ')', ';']",0
"['public', 'void', 'testQuery114', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '""', '+', 'Identity', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'name', ',', 'age', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 's', '=', 'new', 'Schema', '(', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'name', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'age', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tupleFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 's', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'tupleFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery115', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'name', ',', 'age', ',', 'gpa', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '""', '+', 'Identity', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '*', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 's', '=', 'new', 'Schema', '(', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'name', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'age', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'gpa', '""', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tupleFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 's', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'tupleFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery116', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '""', '+', 'Identity', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '0', ',', '$', '1', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', 's', '=', 'new', 'Schema', '(', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['s', '.', 'add', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tupleFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 's', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'tupleFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testQuery117', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['LOSort', 'sort', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '""', '+', 'Identity', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '*', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tupleFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'null', ',', 'DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'expectedSchema', '=', 'new', 'Schema', '(', 'tupleFs', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'expectedSchema', ',', 'false', ',', 'true', ')', ')', ';']",0
"['public', 'void', 'testNullConsArithExprs', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'x', '+', 'null', ',', 'x', '*', 'null', ',', 'x', '/', 'null', ',', 'x', '-', 'null', ',', 'null', '%', 'x', ',', '""', '+']",0
"['""', 'y', '+', 'null', ',', 'y', '*', 'null', ',', 'y', '/', 'null', ',', 'y', '-', 'null', ';', '""']",0
"['public', 'void', 'testNullConsBincond1', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', '2', '>', '1', '?', 'null', ':', '1', ')', ',', '(', '2', '<', '1', '?', 'null', ':', '1', ')', ',', '""', '+']",0
"['""', '(', '2', '>', '1', '?', '1', ':', 'null', ')', ',', '(', '2', '<', '1', '?', '1', ':', 'null', ')', ';', '""']",0
"['public', 'void', 'testNullConsBincond2', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', 'null', 'is', 'null', '?', '1', ':', '2', ')', ',', '(', 'null', 'is', 'not', 'null', '?', '2', ':', '1', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testNullConsForEachGenerate', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'x', ',', 'null', ',', 'y', ',', 'null', ';', '""', ')', ';']",0
"['public', 'void', 'testNullConsOuterJoin', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'load', ""'"", 'b', ""'"", 'as', '(', 'u', ':', 'int', ',', 'v', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'cogroup', 'a', 'by', 'x', ',', 'b', 'by', 'u', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'd', '=', 'foreach', 'c', 'generate', 'flatten', '(', '(', 'SIZE', '(', 'a', ')', '=', '=', '0', '?', 'null', ':', 'a', ')', ')', ',', '""', '+']",0
"['""', 'flatten', '(', '(', 'SIZE', '(', 'b', ')', '=', '=', '0', '?', 'null', ':', 'b', ')', ')', ';', '""']",0
"['public', 'void', 'testNullConsConcatSize', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'SIZE', '(', 'null', ')', ',', 'CONCAT', '(', 'str', ',', 'null', ')', ',', '""', '+']",0
"['""', 'CONCAT', '(', 'null', ',', 'str', ')', ';', '""']",0
"['public', 'void', 'testFilterUdfDefine', '(', ')', '{']",0
"['buildPlan', '(', '""', 'define', 'isempty', 'IsEmpty', '(', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'isempty', '(', '*', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testLoadUdfDefine', '(', ')', '{']",0
"['buildPlan', '(', '""', 'define', 'PS', 'PigStorage', '(', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'using', 'PS', 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'IsEmpty', '(', '*', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testLoadUdfConstructorArgDefine', '(', ')', '{']",0
"['buildPlan', '(', '""', 'define', 'PS', 'PigStorage', '(', ""'"", ':', ""'"", ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'using', 'PS', 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'IsEmpty', '(', '*', ')', ';', '""', ')', ';']",0
"['public', 'void', 'testStoreUdfDefine', '(', ')', '{']",0
"['buildPlan', '(', '""', 'define', 'PS', 'PigStorage', '(', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'using', 'PS', 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'IsEmpty', '(', '*', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'store', 'b', 'into', ""'"", 'x', ""'"", 'using', 'PS', ';', '""', ')', ';']",0
"['public', 'void', 'testStoreUdfConstructorArgDefine', '(', ')', '{']",0
"['buildPlan', '(', '""', 'define', 'PS', 'PigStorage', '(', ""'"", ':', ""'"", ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'a', ""'"", 'using', 'PS', 'as', '(', 'x', ':', 'int', ',', 'y', ':', 'double', ',', 'str', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'filter', 'a', 'by', 'IsEmpty', '(', '*', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'store', 'b', 'into', ""'"", 'x', ""'"", 'using', 'PS', ';', '""', ')', ';']",0
"['public', 'void', 'testCastAlias', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', '.', 'txt', ""'"", 'as', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', 'int', ')', 'x', ',', '(', 'double', ')', 'y', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', 'x', ';', '""', ')', ';']",0
"['public', 'void', 'testCast', '(', ')', '{']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', '.', 'txt', ""'"", 'as', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', '(', 'int', ')', '$', '0', ',', '(', 'double', ')', '$', '1', ';', '""', ')', ';']",0
"['buildPlan', '(', '""', 'c', '=', 'group', 'b', 'by', '$', '0', ';', '""', ')', ';']",0
"['public', 'void', 'testTokenizeSchema', '(', ')', 'throws', 'FrontendException', ',', 'ParseException', '{']",0
"['LogicalPlan', 'lp', ';']",0
"['LOForEach', 'foreach', ';']",0
"['buildPlan', '(', '""', 'a', '=', 'load', ""'"", 'one', ""'"", 'as', '(', 'f1', ':', 'chararray', ')', ';', '""', ')', ';']",0
"['lp', '=', 'buildPlan', '(', '""', 'b', '=', 'foreach', 'a', 'generate', 'TOKENIZE', '(', 'f1', ')', ';', '""', ')', ';']",0
"['foreach', '=', '(', 'LOForEach', ')', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tokenFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'token', '""', ',']",0
"['DataType', '.', 'CHARARRAY', ')', ';']",0
"['Schema', 'tupleSchema', '=', 'new', 'Schema', '(', 'tokenFs', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'tupleFs', ';']",0
"['tupleFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(', '""', 'tuple_of_tokens', '""', ',', 'tupleSchema', ',']",0
"['DataType', '.', 'TUPLE', ')', ';']",0
"['Schema', 'bagSchema', '=', 'new', 'Schema', '(', 'tupleFs', ')', ';']",0
"['bagSchema', '.', 'setTwoLevelAccessRequired', '(', 'true', ')', ';']",0
"['Schema', '.', 'FieldSchema', 'bagFs', '=', 'new', 'Schema', '.', 'FieldSchema', '(']",0
"['""', 'bag_of_tokenTuples', '""', ',', 'bagSchema', ',', 'DataType', '.', 'BAG', ')', ';']",0
"['assertTrue', '(', 'Schema', '.', 'equals', '(', 'foreach', '.', 'getSchema', '(', ')', ',', 'new', 'Schema', '(', 'bagFs', ')', ',', 'false', ',', 'true', ')', ')', ';']",0
"['private', 'void', 'printPlan', '(', 'LogicalPlan', 'lp', ')', '{']",0
"['LOPrinter', 'graphPrinter', '=', 'new', 'LOPrinter', '(', 'System', '.', 'err', ',', 'lp', ')', ';']",0
"['System', '.', 'err', '.', 'println', '(', '""', 'Printing', 'the', 'logical', 'plan', '""', ')', ';']",0
"['graphPrinter', '.', 'visit', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['System', '.', 'err', '.', 'println', '(', 'e', '.', 'getMessage', '(', ')', ')', ';']",0
"['System', '.', 'err', '.', 'println', '(', ')', ';']",0
"['private', 'boolean', 'checkPlanForProjectStar', '(', 'LogicalPlan', 'lp', ')', '{']",0
"['List', '<', 'LogicalOperator', '>', 'leaves', '=', 'lp', '.', 'getLeaves', '(', ')', ';']",0
"['for', '(', 'LogicalOperator', 'op', ':', 'leaves', ')', '{']",0
"['if', '(', 'op', 'instanceof', 'LOProject', ')', '{']",0
"['if', '(', '(', '(', 'LOProject', ')', 'op', ')', '.', 'isStar', '(', ')', ')', '{']",0
"['return', 'true', ';']",1
"['return', 'false', ';']",1
"['/', '/', 'Helper', 'Functions']",0
"['/', '/', 'Helper', 'Functions']",0
"['/', '/', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=', '=']",0
"['public', 'LogicalPlan', 'buildPlan', '(', 'String', 'query', ')', '{']",0
"['return', 'buildPlan', '(', 'query', ',', 'LogicalPlanBuilder', '.', 'class', '.', 'getClassLoader', '(', ')', ')', ';']",0
"['public', 'LogicalPlan', 'buildPlan', '(', 'String', 'query', ',', 'ClassLoader', 'cldr', ')', '{']",0
"['LogicalPlanBuilder', '.', 'classloader', '=', 'cldr', ';']",0
"['LogicalPlanBuilder', 'builder', '=', 'new', 'LogicalPlanBuilder', '(', 'pigContext', ')', ';', '/', '/']",0
"['LogicalPlan', 'lp', '=', 'builder', '.', 'parse', '(', '""', 'Test', '-', 'Plan', '-', 'Builder', '""', ',']",0
"['aliasOp', ')', ';']",0
"['List', '<', 'LogicalOperator', '>', 'roots', '=', 'lp', '.', 'getRoots', '(', ')', ';']",0
"['if', '(', 'roots', '.', 'size', '(', ')', '>', '0', ')', '{']",0
"['for', '(', 'LogicalOperator', 'op', ':', 'roots', ')', '{']",0
"['if', '(', '!', '(', 'op', 'instanceof', 'LOLoad', ')', '&', '&', '!', '(', 'op', 'instanceof', 'LODefine', ')', ')', '{']",0
"['throw', 'new', 'Exception', '(', '""', 'Cannot', 'have', 'a', 'root', 'that', 'is', 'not', 'the', 'load', 'or', 'define', 'operator', '.', 'Found', '""', '+', 'op', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ')', ';']",0
"['/', '/', 'System', '.', 'err', '.', 'println', '(', '""', 'Query', ':', '""', '+', 'query', ')', ';']",0
"['assertNotNull', '(', 'lp', '!', '=', 'null', ')', ';']",0
"['return', 'lp', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['/', '/', 'log', '.', 'error', '(', 'e', ')', ';']",0
"['/', '/', 'System', '.', 'err', '.', 'println', '(', '""', 'IOException', 'Stack', 'trace', 'for', 'query', ':', '""', '+', 'query', ')', ';']",0
"['/', '/', 'e', '.', 'printStackTrace', '(', ')', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['fail', '(', '""', 'IOException', ':', '""', '+', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['log', '.', 'error', '(', 'e', ')', ';']",0
"['/', '/', 'System', '.', 'err', '.', 'println', '(', '""', 'Exception', 'Stack', 'trace', 'for', 'query', ':', '""', '+', 'query', ')', ';']",0
"['/', '/', 'e', '.', 'printStackTrace', '(', ')', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['fail', '(', 'e', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', '+', '""', ':', '""', '+', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', '+', '""', '-', '-', '""', '+', 'query', ')', ';']",0
"['return', 'null', ';']",0
"['Map', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', 'aliases', '=', 'new', 'HashMap', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', '(', ')', ';']",0
"['Map', '<', 'OperatorKey', ',', 'LogicalOperator', '>', 'logicalOpTable', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['Map', '<', 'String', ',', 'LogicalOperator', '>', 'aliasOp', '=', 'new', 'HashMap', '<', 'String', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['PigContext', 'pigContext', '=', 'new', 'PigContext', '(', 'ExecType', '.', 'LOCAL', ',', 'new', 'Properties', '(', ')', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', ';']",0
"['import', 'java', '.', 'io', '.', 'File', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStreamReader', ';']",0
"['import', 'java', '.', 'io', '.', 'OutputStreamWriter', ';']",0
"['import', 'java', '.', 'io', '.', 'FileOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedReader', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedWriter', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'net', '.', 'InetAddress', ';']",0
"['import', 'java', '.', 'net', '.', 'Socket', ';']",0
"['import', 'java', '.', 'net', '.', 'SocketException', ';']",0
"['import', 'java', '.', 'net', '.', 'SocketImplFactory', ';']",0
"['import', 'java', '.', 'net', '.', 'URI', ';']",0
"['import', 'java', '.', 'net', '.', 'URISyntaxException', ';']",0
"['import', 'java', '.', 'net', '.', 'UnknownHostException', ';']",0
"['import', 'java', '.', 'util', '.', 'Collection', ';']",0
"['import', 'java', '.', 'util', '.', 'Enumeration', ';']",0
"['import', 'java', '.', 'util', '.', 'HashMap', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'java', '.', 'util', '.', 'Properties', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'conf', '.', 'Configuration', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'ipc', '.', 'RPC', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobClient', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobConf', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobTracker', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'FuncSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecJob', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecPhysicalOperator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'util', '.', 'ExecTools', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'datastorage', '.', 'ConfigurationUtil', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'datastorage', '.', 'HDataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'BinStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'FileLocalizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'FileSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LogicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'LogToPhyTranslationVisitor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'NodeIdGenerator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'OperatorKey', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'MapReduceLauncher', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'PhysicalOperator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'plans', '.', 'PhysicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'plans', '.', 'PlanPrinter', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'relationalOperators', '.', 'POStore', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'VisitorException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'shock', '.', 'SSHSocketImplFactory', ';']",0
"['public', 'class', 'HExecutionEngine', 'implements', 'ExecutionEngine', '{']",0
"['private', 'static', 'final', 'String', 'HOD_SERVER', '=', '""', 'hod', '.', 'server', '""', ';']",0
"['public', 'static', 'final', 'String', 'JOB_TRACKER_LOCATION', '=', '""', 'mapred', '.', 'job', '.', 'tracker', '""', ';']",0
"['private', 'static', 'final', 'String', 'FILE_SYSTEM_LOCATION', '=', '""', 'fs', '.', 'default', '.', 'name', '""', ';']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['private', 'static', 'final', 'String', 'LOCAL', '=', '""', 'local', '""', ';']",0
"['private', 'StringBuilder', 'hodParams', '=', 'null', ';']",0
"['protected', 'PigContext', 'pigContext', ';']",0
"['protected', 'DataStorage', 'ds', ';']",0
"['protected', 'JobClient', 'jobClient', ';']",0
"['/', '/', 'key', ':', 'the', 'operator', 'key', 'from', 'the', 'logical', 'plan', 'that', 'originated', 'the', 'physical', 'plan']",0
"['/', '/', 'val', ':', 'the', 'operator', 'key', 'for', 'the', 'root', 'of', 'the', 'phyisical', 'plan']",0
"['protected', 'Map', '<', 'OperatorKey', ',', 'OperatorKey', '>', 'logicalToPhysicalKeys', ';']",0
"['protected', 'Map', '<', 'OperatorKey', ',', 'ExecPhysicalOperator', '>', 'physicalOpTable', ';']",0
"['/', '/', 'map', 'from', 'LOGICAL', 'key', 'to', 'into', 'about', 'the', 'execution']",0
"['protected', 'Map', '<', 'OperatorKey', ',', 'MapRedResult', '>', 'materializedResults', ';']",0
"['public', 'HExecutionEngine', '(', 'PigContext', 'pigContext', ')', '{']",0
"['this', '.', 'pigContext', '=', 'pigContext', ';']",0
"['this', '.', 'logicalToPhysicalKeys', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'OperatorKey', '>', '(', ')', ';']",0
"['this', '.', 'physicalOpTable', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'ExecPhysicalOperator', '>', '(', ')', ';']",0
"['this', '.', 'materializedResults', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'MapRedResult', '>', '(', ')', ';']",0
"['this', '.', 'ds', '=', 'null', ';']",0
"['/', '/', 'to', 'be', 'set', 'in', 'the', 'init', 'method']",0
"['this', '.', 'jobClient', '=', 'null', ';']",0
"['public', 'JobClient', 'getJobClient', '(', ')', '{']",0
"['return', 'this', '.', 'jobClient', ';']",0
"['public', 'Map', '<', 'OperatorKey', ',', 'MapRedResult', '>', 'getMaterializedResults', '(', ')', '{']",0
"['return', 'this', '.', 'materializedResults', ';']",0
"['public', 'Map', '<', 'OperatorKey', ',', 'ExecPhysicalOperator', '>', 'getPhysicalOpTable', '(', ')', '{']",0
"['return', 'this', '.', 'physicalOpTable', ';']",0
"['public', 'DataStorage', 'getDataStorage', '(', ')', '{']",0
"['return', 'this', '.', 'ds', ';']",0
"['public', 'void', 'init', '(', ')', 'throws', 'ExecException', '{']",0
"['init', '(', 'this', '.', 'pigContext', '.', 'getProperties', '(', ')', ')', ';']",0
"['public', 'void', 'init', '(', 'Properties', 'properties', ')', 'throws', 'ExecException', '{']",0
"['/', '/', 'First', 'set', 'the', 'ssh', 'socket', 'factory']",0
"['setSSHFactory', '(', ')', ';']",0
"['String', 'hodServer', '=', 'properties', '.', 'getProperty', '(', 'HOD_SERVER', ')', ';']",0
"['String', 'cluster', '=', 'null', ';']",0
"['String', 'nameNode', '=', 'null', ';']",0
"['Configuration', 'configuration', '=', 'null', ';']",0
"['if', '(', 'hodServer', '!', '=', 'null', '&', '&', 'hodServer', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['String', 'hdfsAndMapred', '[', ']', '=', 'doHod', '(', 'hodServer', ',', 'properties', ')', ';']",0
"['properties', '.', 'setProperty', '(', 'FILE_SYSTEM_LOCATION', ',', 'hdfsAndMapred', '[', '0', ']', ')', ';']",0
"['properties', '.', 'setProperty', '(', 'JOB_TRACKER_LOCATION', ',', 'hdfsAndMapred', '[', '1', ']', ')', ';']",0
"['/', '/', 'We', 'need', 'to', 'build', 'a', 'configuration', 'object', 'first', 'in', 'the', 'manner', 'described', 'below']",0
"['/', '/', 'and', 'then', 'get', 'back', 'a', 'properties', 'object', 'to', 'inspect', 'the', 'JOB_TRACKER_LOCATION']",0
"['/', '/', 'and', 'FILE_SYSTEM_LOCATION', '.', 'The', 'reason', 'to', 'do', 'this', 'is', 'if', 'we', 'looked', 'only', 'at']",0
"['/', '/', 'the', 'existing', 'properties', 'object', ',', 'we', 'may', 'not', 'get', 'the', 'right', 'settings', '.', 'So', 'we', 'want']",0
"['/', '/', 'to', 'read', 'the', 'configurations', 'in', 'the', 'order', 'specified', 'below', 'and', 'only', 'then', 'look']",0
"['/', '/', 'for', 'JOB_TRACKER_LOCATION', 'and', 'FILE_SYSTEM_LOCATION', '.']",0
"['/', '/', 'Hadoop', 'by', 'default', 'specifies', 'two', 'resources', ',', 'loaded', 'in', '-', 'order', 'from', 'the', 'classpath', ':']",0
"['/', '/', '1', '.', 'hadoop', '-', 'default', '.', 'xml', ':', 'Read', '-', 'only', 'defaults', 'for', 'hadoop', '.']",0
"['/', '/', '2', '.', 'hadoop', '-', 'site', '.', 'xml', ':', 'Site', '-', 'specific', 'configuration', 'for', 'a', 'given', 'hadoop', 'installation', '.']",0
"['/', '/', 'Now', 'add', 'the', 'settings', 'from', '""', 'properties', '""', 'object', 'to', 'override', 'any', 'existing', 'properties']",0
"['/', '/', 'All', 'of', 'the', 'above', 'is', 'accomplished', 'in', 'the', 'method', 'call', 'below']",0
"['JobConf', 'jobConf', '=', 'new', 'JobConf', '(', ')', ';']",0
"['jobConf', '.', 'addResource', '(', '""', 'pig', '-', 'cluster', '-', 'hadoop', '-', 'site', '.', 'xml', '""', ')', ';']",0
"['/', '/', 'the', 'method', 'below', 'alters', 'the', 'properties', 'object', 'by', 'overriding', 'the']",0
"['/', '/', 'hadoop', 'properties', 'with', 'the', 'values', 'from', 'properties', 'and', 'recomputing']",0
"['/', '/', 'the', 'properties']",0
"['recomputeProperties', '(', 'jobConf', ',', 'properties', ')', ';']",0
"['configuration', '=', 'ConfigurationUtil', '.', 'toConfiguration', '(', 'properties', ')', ';']",0
"['properties', '=', 'ConfigurationUtil', '.', 'toProperties', '(', 'configuration', ')', ';']",0
"['cluster', '=', 'properties', '.', 'getProperty', '(', 'JOB_TRACKER_LOCATION', ')', ';']",0
"['nameNode', '=', 'properties', '.', 'getProperty', '(', 'FILE_SYSTEM_LOCATION', ')', ';']",0
"['if', '(', 'cluster', '!', '=', 'null', '&', '&', 'cluster', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['if', '(', '!', 'cluster', '.', 'contains', '(', '""', ':', '""', ')', '&', '&', '!', 'cluster', '.', 'equalsIgnoreCase', '(', 'LOCAL', ')', ')', '{']",0
"['cluster', '=', 'cluster', '+', '""', ':', '50020', '""', ';']",0
"['properties', '.', 'setProperty', '(', 'JOB_TRACKER_LOCATION', ',', 'cluster', ')', ';']",0
"['if', '(', 'nameNode', '!', '=', 'null', '&', '&', 'nameNode', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['if', '(', '!', 'nameNode', '.', 'contains', '(', '""', ':', '""', ')', '&', '&', '!', 'nameNode', '.', 'equalsIgnoreCase', '(', 'LOCAL', ')', ')', '{']",0
"['nameNode', '=', 'nameNode', '+', '""', ':', '8020', '""', ';']",0
"['properties', '.', 'setProperty', '(', 'FILE_SYSTEM_LOCATION', ',', 'nameNode', ')', ';']",0
"['log', '.', 'info', '(', '""', 'Connecting', 'to', 'hadoop', 'file', 'system', 'at', ':', '""', '+', '(', 'nameNode', '=', '=', 'null', '?', 'LOCAL', ':', 'nameNode', ')', ')', ';']",0
"['ds', '=', 'new', 'HDataStorage', '(', 'properties', ')', ';']",0
"['/', '/', 'The', 'above', 'HDataStorage', 'constructor', 'sets', 'DEFAULT_REPLICATION_FACTOR_KEY', 'in', 'properties', '.']",0
"['/', '/', 'So', 'we', 'need', 'to', 'reconstruct', 'the', 'configuration', 'object', 'for', 'the', 'non', 'HOD', 'case']",0
"['/', '/', 'In', 'the', 'HOD', 'case', ',', 'this', 'is', 'the', 'first', 'time', 'the', 'configuration', 'object', 'will', 'be', 'created']",0
"['configuration', '=', 'ConfigurationUtil', '.', 'toConfiguration', '(', 'properties', ')', ';']",0
"['if', '(', 'cluster', '!', '=', 'null', '&', '&', '!', 'cluster', '.', 'equalsIgnoreCase', '(', 'LOCAL', ')', ')', '{']",0
"['log', '.', 'info', '(', '""', 'Connecting', 'to', 'map', '-', 'reduce', 'job', 'tracker', 'at', ':', '""', '+', 'properties', '.', 'get', '(', 'JOB_TRACKER_LOCATION', ')', ')', ';']",0
"['/', '/', 'Set', 'job', '-', 'specific', 'configuration', 'knobs']",0
"['jobClient', '=', 'new', 'JobClient', '(', 'new', 'JobConf', '(', 'configuration', ')', ')', ';']",0
"['catch', '(', 'IOException', 'e', ')', '{']",0
"['int', 'errCode', '=', '6009', ';']",0
"['String', 'msg', '=', '""', 'Failed', 'to', 'create', 'job', 'client', ':', '""', '+', 'e', '.', 'getMessage', '(', ')', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e', ')', ';']",0
"['public', 'void', 'close', '(', ')', 'throws', 'ExecException', '{']",0
"['closeHod', '(', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'hod', '.', 'server', '""', ')', ')', ';']",0
"['public', 'Properties', 'getConfiguration', '(', ')', 'throws', 'ExecException', '{']",0
"['return', 'this', '.', 'pigContext', '.', 'getProperties', '(', ')', ';']",0
"['public', 'void', 'updateConfiguration', '(', 'Properties', 'newConfiguration', ')']",0
"['throws', 'ExecException', '{']",0
"['init', '(', 'newConfiguration', ')', ';']",0
"['public', 'Map', '<', 'String', ',', 'Object', '>', 'getStatistics', '(', ')', 'throws', 'ExecException', '{']",0
"['throw', 'new', 'UnsupportedOperationException', '(', ')', ';']",0
"['public', 'PhysicalPlan', 'compile', '(', 'LogicalPlan', 'plan', ',']",0
"['Properties', 'properties', ')', 'throws', 'ExecException', '{']",0
"['if', '(', 'plan', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '2041', ';']",0
"['String', 'msg', '=', '""', 'No', 'Plan', 'to', 'compile', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",0
"['LogToPhyTranslationVisitor', 'translator', '=']",0
"['new', 'LogToPhyTranslationVisitor', '(', 'plan', ')', ';']",0
"['translator', '.', 'setPigContext', '(', 'pigContext', ')', ';']",0
"['translator', '.', 'visit', '(', ')', ';']",0
"['return', 'translator', '.', 'getPhysicalPlan', '(', ')', ';']",0
"['}', 'catch', '(', 'VisitorException', 've', ')', '{']",0
"['int', 'errCode', '=', '2042', ';']",0
"['String', 'msg', '=', '""', 'Internal', 'error', '.', 'Unable', 'to', 'translate', 'logical', 'plan', 'to', 'physical', 'plan', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 've', ')', ';']",0
"['public', 'ExecJob', 'execute', '(', 'PhysicalPlan', 'plan', ',']",0
"['String', 'jobName', ')', 'throws', 'ExecException', '{']",0
"['FileSpec', 'spec', '=', 'ExecTools', '.', 'checkLeafIsStore', '(', 'plan', ',', 'pigContext', ')', ';']",0
"['MapReduceLauncher', 'launcher', '=', 'new', 'MapReduceLauncher', '(', ')', ';']",0
"['boolean', 'success', '=', 'launcher', '.', 'launchPig', '(', 'plan', ',', 'jobName', ',', 'pigContext', ')', ';']",0
"['if', '(', 'success', ')']",0
"['return', 'new', 'HJob', '(', 'ExecJob', '.', 'JOB_STATUS', '.', 'COMPLETED', ',', 'pigContext', ',', 'spec', ')', ';']",0
"['return', 'new', 'HJob', '(', 'ExecJob', '.', 'JOB_STATUS', '.', 'FAILED', ',', 'pigContext', ',', 'null', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['/', '/', 'There', 'are', 'a', 'lot', 'of', 'exceptions', 'thrown', 'by', 'the', 'launcher', '.', 'If', 'this']",0
"['/', '/', 'is', 'an', 'ExecException', ',', 'just', 'let', 'it', 'through', '.', 'Else', 'wrap', 'it', '.']",0
"['if', '(', 'e', 'instanceof', 'ExecException', ')', 'throw', '(', 'ExecException', ')', 'e', ';']",0
"['int', 'errCode', '=', '2043', ';']",0
"['String', 'msg', '=', '""', 'Unexpected', 'error', 'during', 'execution', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e', ')', ';']",0
"['public', 'ExecJob', 'submit', '(', 'PhysicalPlan', 'plan', ',']",0
"['String', 'jobName', ')', 'throws', 'ExecException', '{']",0
"['throw', 'new', 'UnsupportedOperationException', '(', ')', ';']",0
"['public', 'void', 'explain', '(', 'PhysicalPlan', 'plan', ',', 'PrintStream', 'stream', ')', '{']",0
"['PlanPrinter', 'printer', '=', 'new', 'PlanPrinter', '(', 'plan', ',', 'stream', ')', ';']",0
"['printer', '.', 'visit', '(', ')', ';']",0
"['stream', '.', 'println', '(', ')', ';']",0
"['ExecTools', '.', 'checkLeafIsStore', '(', 'plan', ',', 'pigContext', ')', ';']",0
"['MapReduceLauncher', 'launcher', '=', 'new', 'MapReduceLauncher', '(', ')', ';']",0
"['launcher', '.', 'explain', '(', 'plan', ',', 'pigContext', ',', 'stream', ')', ';']",0
"['}', 'catch', '(', 'Exception', 've', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', 've', ')', ';']",0
"['public', 'Collection', '<', 'ExecJob', '>', 'runningJobs', '(', 'Properties', 'properties', ')', 'throws', 'ExecException', '{']",0
"['throw', 'new', 'UnsupportedOperationException', '(', ')', ';']",0
"['public', 'Collection', '<', 'String', '>', 'activeScopes', '(', ')', 'throws', 'ExecException', '{']",0
"['throw', 'new', 'UnsupportedOperationException', '(', ')', ';']",0
"['public', 'void', 'reclaimScope', '(', 'String', 'scope', ')', 'throws', 'ExecException', '{']",0
"['throw', 'new', 'UnsupportedOperationException', '(', ')', ';']",0
"['private', 'void', 'setSSHFactory', '(', ')', '{']",0
"['Properties', 'properties', '=', 'this', '.', 'pigContext', '.', 'getProperties', '(', ')', ';']",0
"['String', 'g', '=', 'properties', '.', 'getProperty', '(', '""', 'ssh', '.', 'gateway', '""', ')', ';']",0
"['if', '(', 'g', '=', '=', 'null', '|', '|', 'g', '.', 'length', '(', ')', '=', '=', '0', ')', 'return', ';']",0
"['Class', 'clazz', '=', 'Class', '.', 'forName', '(', '""', 'org', '.', 'apache', '.', 'pig', '.', 'shock', '.', 'SSHSocketImplFactory', '""', ')', ';']",0
"['SocketImplFactory', 'f', '=', '(', 'SocketImplFactory', ')', 'clazz', '.', 'getMethod', '(', '""', 'getFactory', '""', ',', 'new', 'Class', '[', '0', ']', ')', '.', 'invoke', '(', '0', ',', 'new', 'Object', '[', '0', ']', ')', ';']",0
"['Socket', '.', 'setSocketImplFactory', '(', 'f', ')', ';']",0
"['catch', '(', 'SocketException', 'e', ')', '{', '}']",0
"['catch', '(', 'Exception', 'e', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', 'e', ')', ';']",0
"['/', '/', 'To', 'prevent', 'doing', 'hod', 'if', 'the', 'pig', 'server', 'is', 'constructed', 'multiple', 'times']",0
"['private', 'static', 'String', 'hodMapRed', ';']",0
"['private', 'static', 'String', 'hodHDFS', ';']",0
"['private', 'String', 'hodConfDir', '=', 'null', ';']",0
"['private', 'String', 'remoteHodConfDir', '=', 'null', ';']",0
"['private', 'Process', 'hodProcess', '=', 'null', ';']",0
"['class', 'ShutdownThread', 'extends', 'Thread', '{']",0
"['public', 'synchronized', 'void', 'run', '(', ')', '{']",0
"['closeHod', '(', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'hod', '.', 'server', '""', ')', ')', ';']",0
"['private', 'String', '[', ']', 'doHod', '(', 'String', 'server', ',', 'Properties', 'properties', ')', 'throws', 'ExecException', '{']",0
"['if', '(', 'hodMapRed', '!', '=', 'null', ')', '{']",0
"['return', 'new', 'String', '[', ']', '{', 'hodHDFS', ',', 'hodMapRed', '}', ';']",0
"['/', '/', 'first', ',', 'create', 'temp', 'director', 'to', 'store', 'the', 'configuration']",0
"['hodConfDir', '=', 'createTempDir', '(', 'server', ')', ';']",0
"['/', '/', 'jz', ':', 'fallback', 'to', 'systemproperty', 'cause', 'this', 'not', 'handled', 'in', 'Main']",0
"['hodParams', '=', 'new', 'StringBuilder', '(', 'properties', '.', 'getProperty', '(']",0
"['""', 'hod', '.', 'param', '""', ',', 'System', '.', 'getProperty', '(', '""', 'hod', '.', 'param', '""', ',', '""', '""', ')', ')', ')', ';']",0
"['/', '/', 'get', 'the', 'number', 'of', 'nodes', 'out', 'of', 'the', 'command', 'or', 'use', 'default']",0
"['int', 'nodes', '=', 'getNumNodes', '(', 'hodParams', ')', ';']",0
"['/', '/', 'command', 'format', ':', 'hod', 'allocate', '-', 'd', '<', 'cluster_dir', '>', '-', 'n', '<', 'number_of_nodes', '>', '<', 'other', 'params', '>']",0
"['String', '[', ']', 'fixedCmdArray', '=', 'new', 'String', '[', ']', '{', '""', 'hod', '""', ',', '""', 'allocate', '""', ',', '""', '-', 'd', '""', ',']",0
"['hodConfDir', ',', '""', '-', 'n', '""', ',', 'Integer', '.', 'toString', '(', 'nodes', ')', '}', ';']",0
"['String', '[', ']', 'extraParams', '=', 'hodParams', '.', 'toString', '(', ')', '.', 'split', '(', '""', '""', ')', ';']",0
"['String', '[', ']', 'cmdarray', '=', 'new', 'String', '[', 'fixedCmdArray', '.', 'length', '+', 'extraParams', '.', 'length', ']', ';']",0
"['System', '.', 'arraycopy', '(', 'fixedCmdArray', ',', '0', ',', 'cmdarray', ',', '0', ',', 'fixedCmdArray', '.', 'length', ')', ';']",0
"['System', '.', 'arraycopy', '(', 'extraParams', ',', '0', ',', 'cmdarray', ',', 'fixedCmdArray', '.', 'length', ',', 'extraParams', '.', 'length', ')', ';']",0
"['log', '.', 'info', '(', '""', 'Connecting', 'to', 'HOD', '.', '.', '.', '""', ')', ';']",0
"['log', '.', 'debug', '(', '""', 'sending', 'HOD', 'command', '""', '+', 'cmdToString', '(', 'cmdarray', ')', ')', ';']",0
"['/', '/', 'setup', 'shutdown', 'hook', 'to', 'make', 'sure', 'we', 'tear', 'down', 'hod', 'connection']",0
"['Runtime', '.', 'getRuntime', '(', ')', '.', 'addShutdownHook', '(', 'new', 'ShutdownThread', '(', ')', ')', ';']",0
"['runCommand', '(', 'server', ',', 'cmdarray', ',', 'true', ')', ';']",0
"['/', '/', 'print', 'all', 'the', 'information', 'provided', 'by', 'HOD']",0
"['BufferedReader', 'br', '=', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'hodProcess', '.', 'getErrorStream', '(', ')', ')', ')', ';']",0
"['String', 'msg', ';']",0
"['while', '(', '(', 'msg', '=', 'br', '.', 'readLine', '(', ')', ')', '!', '=', 'null', ')']",0
"['log', '.', 'info', '(', 'msg', ')', ';']",0
"['br', '.', 'close', '(', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{', '}']",0
"['/', '/', 'for', 'remote', 'connection', 'we', 'need', 'to', 'bring', 'the', 'file', 'locally']",0
"['if', '(', '!', 'server', '.', 'equals', '(', 'LOCAL', ')', ')']",0
"['hodConfDir', '=', 'copyHadoopConfLocally', '(', 'server', ')', ';']",0
"['String', 'hdfs', '=', 'null', ';']",0
"['String', 'mapred', '=', 'null', ';']",0
"['String', 'hadoopConf', '=', 'hodConfDir', '+', '""', '/', 'hadoop', '-', 'site', '.', 'xml', '""', ';']",0
"['log', '.', 'info', '(', '""', 'Hadoop', 'configuration', 'file', ':', '""', '+', 'hadoopConf', ')', ';']",0
"['JobConf', 'jobConf', '=', 'new', 'JobConf', '(', 'hadoopConf', ')', ';']",0
"['jobConf', '.', 'addResource', '(', '""', 'pig', '-', 'cluster', '-', 'hadoop', '-', 'site', '.', 'xml', '""', ')', ';']",0
"['/', '/', 'the', 'method', 'below', 'alters', 'the', 'properties', 'object', 'by', 'overriding', 'the']",0
"['/', '/', 'hod', 'properties', 'with', 'the', 'values', 'from', 'properties', 'and', 'recomputing']",0
"['/', '/', 'the', 'properties']",0
"['recomputeProperties', '(', 'jobConf', ',', 'properties', ')', ';']",0
"['hdfs', '=', 'properties', '.', 'getProperty', '(', 'FILE_SYSTEM_LOCATION', ')', ';']",0
"['if', '(', 'hdfs', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '4007', ';']",0
"['String', 'msg', '=', '""', 'Missing', 'fs', '.', 'default', '.', 'name', 'from', 'hadoop', 'configuration', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'USER_ENVIRONMENT', ')', ';']",0
"['log', '.', 'info', '(', '""', 'HDFS', ':', '""', '+', 'hdfs', ')', ';']",0
"['mapred', '=', 'properties', '.', 'getProperty', '(', 'JOB_TRACKER_LOCATION', ')', ';']",0
"['if', '(', 'mapred', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '4007', ';']",0
"['String', 'msg', '=', '""', 'Missing', 'mapred', '.', 'job', '.', 'tracker', 'from', 'hadoop', 'configuration', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'USER_ENVIRONMENT', ')', ';']",0
"['log', '.', 'info', '(', '""', 'JobTracker', ':', '""', '+', 'mapred', ')', ';']",0
"['/', '/', 'this', 'is', 'not', 'longer', 'needed', 'as', 'hadoop', '-', 'site', '.', 'xml', 'given', 'to', 'us', 'by', 'HOD']",0
"['/', '/', 'contains', 'data', 'in', 'the', 'correct', 'format']",0
"['/', '/', 'hdfs', '=', 'fixUpDomain', '(', 'hdfs', ',', 'properties', ')', ';']",0
"['/', '/', 'mapred', '=', 'fixUpDomain', '(', 'mapred', ',', 'properties', ')', ';']",0
"['hodHDFS', '=', 'hdfs', ';']",0
"['hodMapRed', '=', 'mapred', ';']",0
"['return', 'new', 'String', '[', ']', '{', 'hdfs', ',', 'mapred', '}', ';']",0
"['catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '6010', ';']",0
"['String', 'msg', '=', '""', 'Could', 'not', 'connect', 'to', 'HOD', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'REMOTE_ENVIRONMENT', ',', 'e', ')', ';']",0
"['private', 'synchronized', 'void', 'closeHod', '(', 'String', 'server', ')', '{']",0
"['if', '(', 'hodProcess', '=', '=', 'null', ')', '{']",0
"['/', '/', 'just', 'cleanup', 'the', 'dir', 'if', 'it', 'exists', 'and', 'return']",0
"['if', '(', 'hodConfDir', '!', '=', 'null', ')']",0
"['deleteDir', '(', 'server', ',', 'hodConfDir', ')', ';']",0
"['/', '/', 'hod', 'deallocate', 'format', ':', 'hod', 'deallocate', '-', 'd', '<', 'conf', 'dir', '>']",0
"['String', '[', ']', 'cmdarray', '=', 'new', 'String', '[', '4', ']', ';']",0
"['cmdarray', '[', '0', ']', '=', '""', 'hod', '""', ';']",0
"['cmdarray', '[', '1', ']', '=', '""', 'deallocate', '""', ';']",0
"['cmdarray', '[', '2', ']', '=', '""', '-', 'd', '""', ';']",0
"['if', '(', 'remoteHodConfDir', '!', '=', 'null', ')']",0
"['cmdarray', '[', '3', ']', '=', 'remoteHodConfDir', ';']",0
"['cmdarray', '[', '3', ']', '=', 'hodConfDir', ';']",0
"['log', '.', 'info', '(', '""', 'Disconnecting', 'from', 'HOD', '.', '.', '.', '""', ')', ';']",0
"['log', '.', 'debug', '(', '""', 'Disconnect', 'command', ':', '""', '+', 'cmdToString', '(', 'cmdarray', ')', ')', ';']",0
"['runCommand', '(', 'server', ',', 'cmdarray', ',', 'false', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['log', '.', 'warn', '(', '""', 'Failed', 'to', 'disconnect', 'from', 'HOD', ';', 'error', ':', '""', '+', 'e', '.', 'getMessage', '(', ')', ')', ';']",0
"['hodProcess', '.', 'destroy', '(', ')', ';']",0
"['}', 'finally', '{']",0
"['if', '(', 'remoteHodConfDir', '!', '=', 'null', ')', '{']",0
"['deleteDir', '(', 'server', ',', 'remoteHodConfDir', ')', ';']",0
"['if', '(', 'hodConfDir', '!', '=', 'null', ')']",0
"['deleteDir', '(', 'LOCAL', ',', 'hodConfDir', ')', ';']",0
"['deleteDir', '(', 'server', ',', 'hodConfDir', ')', ';']",0
"['hodProcess', '=', 'null', ';']",0
"['private', 'String', 'copyHadoopConfLocally', '(', 'String', 'server', ')', 'throws', 'ExecException', '{']",0
"['String', 'localDir', '=', 'createTempDir', '(', 'LOCAL', ')', ';']",0
"['String', 'remoteFile', '=', 'new', 'String', '(', 'hodConfDir', '+', '""', '/', 'hadoop', '-', 'site', '.', 'xml', '""', ')', ';']",0
"['String', 'localFile', '=', 'new', 'String', '(', 'localDir', '+', '""', '/', 'hadoop', '-', 'site', '.', 'xml', '""', ')', ';']",0
"['remoteHodConfDir', '=', 'hodConfDir', ';']",0
"['String', '[', ']', 'cmdarray', '=', 'new', 'String', '[', '2', ']', ';']",0
"['cmdarray', '[', '0', ']', '=', '""', 'cat', '""', ';']",0
"['cmdarray', '[', '1', ']', '=', 'remoteFile', ';']",0
"['Process', 'p', '=', 'runCommand', '(', 'server', ',', 'cmdarray', ',', 'false', ')', ';']",0
"['BufferedWriter', 'bw', ';']",0
"['bw', '=', 'new', 'BufferedWriter', '(', 'new', 'OutputStreamWriter', '(', 'new', 'FileOutputStream', '(', 'localFile', ')', ')', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '4008', ';']",0
"['String', 'msg', '=', '""', 'Failed', 'to', 'create', 'local', 'hadoop', 'file', '""', '+', 'localFile', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'USER_ENVIRONMENT', ',', 'e', ')', ';']",0
"['BufferedReader', 'br', '=', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'p', '.', 'getInputStream', '(', ')', ')', ')', ';']",0
"['String', 'line', ';']",0
"['while', '(', '(', 'line', '=', 'br', '.', 'readLine', '(', ')', ')', '!', '=', 'null', ')', '{']",0
"['bw', '.', 'write', '(', 'line', ',', '0', ',', 'line', '.', 'length', '(', ')', ')', ';']",0
"['bw', '.', 'newLine', '(', ')', ';']",0
"['br', '.', 'close', '(', ')', ';']",0
"['bw', '.', 'close', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '4009', ';']",0
"['String', 'msg', '=', '""', 'Failed', 'to', 'copy', 'data', 'to', 'local', 'hadoop', 'file', '""', '+', 'localFile', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'USER_ENVIRONMENT', ',', 'e', ')', ';']",0
"['return', 'localDir', ';']",0
"['private', 'String', 'cmdToString', '(', 'String', '[', ']', 'cmdarray', ')', '{']",0
"['StringBuilder', 'cmd', '=', 'new', 'StringBuilder', '(', ')', ';']",0
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'cmdarray', '.', 'length', ';', 'i', '+', '+', ')', '{']",0
"['cmd', '.', 'append', '(', 'cmdarray', '[', 'i', ']', ')', ';']",0
"['cmd', '.', 'append', '(', ""'"", ""'"", ')', ';']",0
"['return', 'cmd', '.', 'toString', '(', ')', ';']",0
"['private', 'Process', 'runCommand', '(', 'String', 'server', ',', 'String', '[', ']', 'cmdarray', ',', 'boolean', 'connect', ')', 'throws', 'ExecException', '{']",0
"['Process', 'p', ';']",0
"['if', '(', 'server', '.', 'equals', '(', 'LOCAL', ')', ')', '{']",0
"['p', '=', 'Runtime', '.', 'getRuntime', '(', ')', '.', 'exec', '(', 'cmdarray', ')', ';']",0
"['SSHSocketImplFactory', 'fac', '=', 'SSHSocketImplFactory', '.', 'getFactory', '(', 'server', ')', ';']",0
"['p', '=', 'fac', '.', 'ssh', '(', 'cmdToString', '(', 'cmdarray', ')', ')', ';']",0
"['if', '(', 'connect', ')']",0
"['hodProcess', '=', 'p', ';']",0
"['/', '/', 'this', 'should', 'return', 'as', 'soon', 'as', 'connection', 'is', 'shutdown']",0
"['int', 'rc', '=', 'p', '.', 'waitFor', '(', ')', ';']",0
"['if', '(', 'rc', '!', '=', '0', ')', '{']",0
"['StringBuilder', 'errMsg', '=', 'new', 'StringBuilder', '(', ')', ';']",0
"['BufferedReader', 'br', '=', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'p', '.', 'getInputStream', '(', ')', ')', ')', ';']",0
"['String', 'line', '=', 'null', ';']",0
"['while', '(', '(', 'line', '=', 'br', '.', 'readLine', '(', ')', ')', '!', '=', 'null', ')', '{']",0
"['errMsg', '.', 'append', '(', 'line', ')', ';']",0
"['br', '.', 'close', '(', ')', ';']",0
"['br', '=', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'p', '.', 'getErrorStream', '(', ')', ')', ')', ';']",0
"['line', '=', 'null', ';']",0
"['while', '(', '(', 'line', '=', 'br', '.', 'readLine', '(', ')', ')', '!', '=', 'null', ')', '{']",0
"['errMsg', '.', 'append', '(', 'line', ')', ';']",0
"['br', '.', 'close', '(', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{', '}']",0
"['int', 'errCode', '=', '6011', ';']",0
"['StringBuilder', 'msg', '=', 'new', 'StringBuilder', '(', '""', 'Failed', 'to', 'run', 'command', '""', ')', ';']",0
"['msg', '.', 'append', '(', 'cmdToString', '(', 'cmdarray', ')', ')', ';']",0
"['msg', '.', 'append', '(', '""', 'on', 'server', '""', ')', ';']",0
"['msg', '.', 'append', '(', 'server', ')', ';']",0
"['msg', '.', 'append', '(', '""', ';', 'return', 'code', ':', '""', ')', ';']",0
"['msg', '.', 'append', '(', 'rc', ')', ';']",0
"['msg', '.', 'append', '(', '""', ';', 'error', ':', '""', ')', ';']",0
"['msg', '.', 'append', '(', 'errMsg', '.', 'toString', '(', ')', ')', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', '.', 'toString', '(', ')', ',', 'errCode', ',', 'PigException', '.', 'REMOTE_ENVIRONMENT', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['if', '(', 'e', 'instanceof', 'ExecException', ')', 'throw', '(', 'ExecException', ')', 'e', ';']",0
"['int', 'errCode', '=', '6012', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'run', 'command', ':', '""', '+', 'cmdToString', '(', 'cmdarray', ')', '+', '""', 'on', 'server', '""', '+', 'server', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'REMOTE_ENVIRONMENT', ',', 'e', ')', ';']",0
"['return', 'p', ';']",0
"['private', 'FileSpec', 'checkLeafIsStore', '(', 'PhysicalPlan', 'plan', ')', 'throws', 'ExecException', '{']",0
"['PhysicalOperator', 'leaf', '=', '(', 'PhysicalOperator', ')', 'plan', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', ';']",0
"['FileSpec', 'spec', '=', 'null', ';']",0
"['if', '(', '!', '(', 'leaf', 'instanceof', 'POStore', ')', ')', '{']",0
"['String', 'scope', '=', 'leaf', '.', 'getOperatorKey', '(', ')', '.', 'getScope', '(', ')', ';']",0
"['POStore', 'str', '=', 'new', 'POStore', '(', 'new', 'OperatorKey', '(', 'scope', ',']",0
"['NodeIdGenerator', '.', 'getGenerator', '(', ')', '.', 'getNextNodeId', '(', 'scope', ')', ')', ')', ';']",0
"['str', '.', 'setPc', '(', 'pigContext', ')', ';']",0
"['spec', '=', 'new', 'FileSpec', '(', 'FileLocalizer', '.', 'getTemporaryPath', '(', 'null', ',']",0
"['pigContext', ')', '.', 'toString', '(', ')', ',']",0
"['new', 'FuncSpec', '(', 'BinStorage', '.', 'class', '.', 'getName', '(', ')', ')', ')', ';']",0
"['str', '.', 'setSFile', '(', 'spec', ')', ';']",0
"['plan', '.', 'addAsLeaf', '(', 'str', ')', ';']",0
"['}', 'else', '{']",0
"['spec', '=', '(', '(', 'POStore', ')', 'leaf', ')', '.', 'getSFile', '(', ')', ';']",0
"['return', 'spec', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['throw', 'new', 'ExecException', '(', 'e', ')', ';']",0
"['private', 'void', 'deleteDir', '(', 'String', 'server', ',', 'String', 'dir', ')', '{']",0
"['if', '(', 'server', '.', 'equals', '(', 'LOCAL', ')', ')', '{']",0
"['File', 'path', '=', 'new', 'File', '(', 'dir', ')', ';']",0
"['deleteLocalDir', '(', 'path', ')', ';']",0
"['/', '/', 'send', 'rm', 'command', 'over', 'ssh']",0
"['String', '[', ']', 'cmdarray', '=', 'new', 'String', '[', '3', ']', ';']",0
"['cmdarray', '[', '0', ']', '=', '""', 'rm', '""', ';']",0
"['cmdarray', '[', '1', ']', '=', '""', '-', 'rf', '""', ';']",0
"['cmdarray', '[', '2', ']', '=', 'dir', ';']",0
"['runCommand', '(', 'server', ',', 'cmdarray', ',', 'false', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['log', '.', 'warn', '(', '""', 'Failed', 'to', 'remove', 'HOD', 'configuration', 'directory', '-', '""', '+', 'dir', ')', ';']",0
"['private', 'void', 'deleteLocalDir', '(', 'File', 'path', ')', '{']",0
"['File', '[', ']', 'files', '=', 'path', '.', 'listFiles', '(', ')', ';']",0
"['int', 'i', ';']",0
"['for', '(', 'i', '=', '0', ';', 'i', '<', 'files', '.', 'length', ';', 'i', '+', '+', ')', '{']",0
"['if', '(', 'files', '[', 'i', ']', '.', 'isHidden', '(', ')', ')']",0
"['if', '(', 'files', '[', 'i', ']', '.', 'isFile', '(', ')', ')']",0
"['files', '[', 'i', ']', '.', 'delete', '(', ')', ';']",0
"['else', 'if', '(', 'files', '[', 'i', ']', '.', 'isDirectory', '(', ')', ')']",0
"['deleteLocalDir', '(', 'files', '[', 'i', ']', ')', ';']",0
"['path', '.', 'delete', '(', ')', ';']",0
"['private', 'String', 'fixUpDomain', '(', 'String', 'hostPort', ',', 'Properties', 'properties', ')', 'throws', 'UnknownHostException', '{']",0
"['URI', 'uri', '=', 'null', ';']",0
"['uri', '=', 'new', 'URI', '(', 'hostPort', ')', ';']",0
"['}', 'catch', '(', 'URISyntaxException', 'use', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'Illegal', 'hostPort', ':', '""', '+', 'hostPort', ')', ';']",0
"['String', 'hostname', '=', 'uri', '.', 'getHost', '(', ')', ';']",0
"['int', 'port', '=', 'uri', '.', 'getPort', '(', ')', ';']",0
"['/', '/', 'Parse', 'manually', 'if', 'hostPort', 'wasn', ""'"", 't', 'non', '-', 'opaque', 'URI']",0
"['/', '/', 'e', '.', 'g', '.', 'hostPort', 'is', '""', 'myhost', ':', 'myport', '""']",0
"['if', '(', 'hostname', '=', '=', 'null', '|', '|', 'port', '=', '=', '-', '1', ')', '{']",0
"['String', 'parts', '[', ']', '=', 'hostPort', '.', 'split', '(', '""', ':', '""', ')', ';']",0
"['hostname', '=', 'parts', '[', '0', ']', ';']",0
"['port', '=', 'Integer', '.', 'valueOf', '(', 'parts', '[', '1', ']', ')', ';']",0
"['if', '(', 'hostname', '.', 'indexOf', '(', ""'"", '.', ""'"", ')', '=', '=', '-', '1', ')', '{']",0
"['/', '/', 'jz', ':', 'fallback', 'to', 'systemproperty', 'cause', 'this', 'not', 'handled', 'in', 'Main']",0
"['String', 'domain', '=', 'properties', '.', 'getProperty', '(', '""', 'cluster', '.', 'domain', '""', ',', 'System', '.', 'getProperty', '(', '""', 'cluster', '.', 'domain', '""', ')', ')', ';']",0
"['if', '(', 'domain', '=', '=', 'null', ')']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'Missing', 'cluster', '.', 'domain', 'property', '!', '""', ')', ';']",0
"['hostname', '=', 'hostname', '+', '""', '.', '""', '+', 'domain', ';']",0
"['InetAddress', '.', 'getByName', '(', 'hostname', ')', ';']",0
"['return', 'hostname', '+', '""', ':', '""', '+', 'Integer', '.', 'toString', '(', 'port', ')', ';']",0
"['/', '/', 'create', 'temp', 'dir', 'to', 'store', 'hod', 'output', ';', 'removed', 'on', 'exit']",0
"['/', '/', 'format', ':', '<', 'tempdir', '>', '/', 'PigHod', '.', '<', 'host', 'name', '>', '.', '<', 'user', 'name', '>', '.', '<', 'nanosecondts', '>']",0
"['private', 'String', 'createTempDir', '(', 'String', 'server', ')', 'throws', 'ExecException', '{']",0
"['StringBuilder', 'tempDirPrefix', '=', 'new', 'StringBuilder', '(', ')', ';']",0
"['if', '(', 'server', '.', 'equals', '(', 'LOCAL', ')', ')']",0
"['tempDirPrefix', '.', 'append', '(', 'System', '.', 'getProperty', '(', '""', 'java', '.', 'io', '.', 'tmpdir', '""', ')', ')', ';']",0
"['/', '/', 'for', 'remote', 'access', 'we', 'assume', '/', 'tmp', 'as', 'temp', 'dir']",0
"['tempDirPrefix', '.', 'append', '(', '""', '/', 'tmp', '""', ')', ';']",0
"['tempDirPrefix', '.', 'append', '(', '""', '/', 'PigHod', '.', '""', ')', ';']",0
"['tempDirPrefix', '.', 'append', '(', 'InetAddress', '.', 'getLocalHost', '(', ')', '.', 'getHostName', '(', ')', ')', ';']",0
"['tempDirPrefix', '.', 'append', '(', '""', '.', '""', ')', ';']",0
"['}', 'catch', '(', 'UnknownHostException', 'e', ')', '{', '}']",0
"['tempDirPrefix', '.', 'append', '(', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'name', '""', ')', ')', ';']",0
"['tempDirPrefix', '.', 'append', '(', '""', '.', '""', ')', ';']",0
"['String', 'path', ';']",0
"['path', '=', 'tempDirPrefix', '.', 'toString', '(', ')', '+', 'System', '.', 'nanoTime', '(', ')', ';']",0
"['}', 'while', '(', '!', 'createDir', '(', 'server', ',', 'path', ')', ')', ';']",0
"['return', 'path', ';']",0
"['private', 'boolean', 'createDir', '(', 'String', 'server', ',', 'String', 'dir', ')', 'throws', 'ExecException', '{']",0
"['if', '(', 'server', '.', 'equals', '(', 'LOCAL', ')', ')', '{']",0
"['/', '/', 'create', 'local', 'directory']",0
"['File', 'tempDir', '=', 'new', 'File', '(', 'dir', ')', ';']",0
"['boolean', 'success', '=', 'tempDir', '.', 'mkdir', '(', ')', ';']",0
"['if', '(', '!', 'success', ')']",0
"['log', '.', 'warn', '(', '""', 'Failed', 'to', 'create', 'HOD', 'configuration', 'directory', '-', '""', '+', 'dir', '+', '""', '.', 'Retrying', '.', '.', '.', '""', ')', ';']",0
"['return', 'success', ';']",0
"['String', '[', ']', 'cmdarray', '=', 'new', 'String', '[', '2', ']', ';']",0
"['cmdarray', '[', '0', ']', '=', '""', 'mkdir', '""', ';']",0
"['cmdarray', '[', '1', ']', '=', 'dir', ';']",0
"['runCommand', '(', 'server', ',', 'cmdarray', ',', 'false', ')', ';']",0
"['catch', '(', 'ExecException', 'e', ')', '{']",0
"['log', '.', 'warn', '(', '""', 'Failed', 'to', 'create', 'HOD', 'configuration', 'directory', '-', '""', '+', 'dir', '+', '""', 'Retrying', '.', '.', '.', '""', ')', ';']",0
"['return', 'false', ';']",0
"['return', 'true', ';']",0
"['/', '/', 'returns', 'number', 'of', 'nodes', 'based', 'on', '-', 'm', 'option', 'in', 'hodParams', 'if', 'present', ';']",0
"['/', '/', 'otherwise', ',', 'default', 'is', 'used', ';', '-', 'm', 'is', 'removed', 'from', 'the', 'params']",0
"['int', 'getNumNodes', '(', 'StringBuilder', 'hodParams', ')', '{']",0
"['String', 'val', '=', 'hodParams', '.', 'toString', '(', ')', ';']",0
"['int', 'startPos', '=', 'val', '.', 'indexOf', '(', '""', '-', 'm', '""', ')', ';']",0
"['if', '(', 'startPos', '=', '=', '-', '1', ')']",0
"['startPos', '=', 'val', '.', 'indexOf', '(', '""', '-', 'm', '\\', 't', '""', ')', ';']",0
"['if', '(', 'startPos', '!', '=', '-', '1', ')', '{']",0
"['int', 'curPos', '=', 'startPos', '+', '3', ';']",0
"['int', 'len', '=', 'val', '.', 'length', '(', ')', ';']",0
"['while', '(', 'curPos', '<', 'len', '&', '&', 'Character', '.', 'isWhitespace', '(', 'val', '.', 'charAt', '(', 'curPos', ')', ')', ')', 'curPos', '+', '+', ';']",0
"['int', 'numStartPos', '=', 'curPos', ';']",0
"['while', '(', 'curPos', '<', 'len', '&', '&', 'Character', '.', 'isDigit', '(', 'val', '.', 'charAt', '(', 'curPos', ')', ')', ')', 'curPos', '+', '+', ';']",0
"['int', 'nodes', '=', 'Integer', '.', 'parseInt', '(', 'val', '.', 'substring', '(', 'numStartPos', ',', 'curPos', ')', ')', ';']",0
"['hodParams', '.', 'delete', '(', 'startPos', ',', 'curPos', ')', ';']",0
"['return', 'nodes', ';']",0
"['}', 'else', '{']",0
"['return', 'Integer', '.', 'getInteger', '(', '""', 'hod', '.', 'nodes', '""', ',', '15', ')', ';']",0
"['/', '*', '*']",0
"['private', 'void', 'recomputeProperties', '(', 'JobConf', 'jobConf', ',', 'Properties', 'properties', ')', '{']",0
"['/', '/', 'We', 'need', 'to', 'load', 'the', 'properties', 'from', 'the', 'hadoop', 'configuration']",1
"['/', '/', 'We', 'want', 'to', 'override', 'these', 'with', 'any', 'existing', 'properties', 'we', 'have', '.']",0
"['if', '(', 'jobConf', '!', '=', 'null', '&', '&', 'properties', '!', '=', 'null', ')', '{']",0
"['Properties', 'hadoopProperties', '=', 'new', 'Properties', '(', ')', ';']",0
"['Iterator', '<', 'Map', '.', 'Entry', '<', 'String', ',', 'String', '>', '>', 'iter', '=', 'jobConf', '.', 'iterator', '(', ')', ';']",1
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",1
"['Map', '.', 'Entry', '<', 'String', ',', 'String', '>', 'entry', '=', 'iter', '.', 'next', '(', ')', ';']",1
"['hadoopProperties', '.', 'put', '(', 'entry', '.', 'getKey', '(', ')', ',', 'entry', '.', 'getValue', '(', ')', ')', ';']",0
"['/', '/', 'override', 'hadoop', 'properties', 'with', 'user', 'defined', 'properties']",0
"['Enumeration', '<', 'Object', '>', 'propertiesIter', '=', 'properties', '.', 'keys', '(', ')', ';']",1
"['while', '(', 'propertiesIter', '.', 'hasMoreElements', '(', ')', ')', '{']",1
"['String', 'key', '=', '(', 'String', ')', 'propertiesIter', '.', 'nextElement', '(', ')', ';']",1
"['String', 'val', '=', 'properties', '.', 'getProperty', '(', 'key', ')', ';']",1
"['hadoopProperties', '.', 'put', '(', 'key', ',', 'val', ')', ';']",0
"['/', '/', 'clear', 'user', 'defined', 'properties', 'and', 're', '-', 'populate']",1
"['properties', '.', 'clear', '(', ')', ';']",1
"['Enumeration', '<', 'Object', '>', 'hodPropertiesIter', '=', 'hadoopProperties', '.', 'keys', '(', ')', ';']",0
"['while', '(', 'hodPropertiesIter', '.', 'hasMoreElements', '(', ')', ')', '{']",1
"['String', 'key', '=', '(', 'String', ')', 'hodPropertiesIter', '.', 'nextElement', '(', ')', ';']",1
"['String', 'val', '=', 'hadoopProperties', '.', 'getProperty', '(', 'key', ')', ';']",0
"['properties', '.', 'put', '(', 'key', ',', 'val', ')', ';']",1
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayInputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'DataInputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'DataOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'OutputStream', ';']",0
"['import', 'java', '.', 'net', '.', 'URL', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ExecType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigWarning', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ReversibleLoadStoreFunc', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataBag', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataReaderWriter', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'BufferedPositionedInputStream', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'FileLocalizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'FrontendException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'schema', '.', 'Schema', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'schema', '.', 'SchemaMergeException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'WrappedIOException', ';']",0
"['public', 'class', 'BinStorage', 'implements', 'ReversibleLoadStoreFunc', '{']",0
"['public', 'static', 'final', 'byte', 'RECORD_1', '=', '0x01', ';']",0
"['public', 'static', 'final', 'byte', 'RECORD_2', '=', '0x02', ';']",0
"['public', 'static', 'final', 'byte', 'RECORD_3', '=', '0x03', ';']",0
"['Iterator', '<', 'Tuple', '>', 'i', '=', 'null', ';']",0
"['protected', 'BufferedPositionedInputStream', 'in', '=', 'null', ';']",0
"['private', 'static', 'final', 'Log', 'mLog', '=', 'LogFactory', '.', 'getLog', '(', 'BinStorage', '.', 'class', ')', ';']",0
"['private', 'DataInputStream', 'inData', '=', 'null', ';']",0
"['protected', 'long', 'end', '=', 'Long', '.', 'MAX_VALUE', ';']",0
"['/', '*', '*']",0
"['public', 'BinStorage', '(', ')', '{']",0
"['public', 'Tuple', 'getNext', '(', ')', 'throws', 'IOException', '{']",0
"['byte', 'b', '=', '0', ';']",0
"['/', '/', 'skip', 'to', 'next', 'record']",0
"['while', '(', 'true', ')', '{']",0
"['if', '(', 'in', '=', '=', 'null', '|', '|', 'in', '.', 'getPosition', '(', ')', '>', '=', 'end', ')', '{']",0
"['return', 'null', ';']",0
"['/', '/', 'check', 'if', 'we', 'saw', 'RECORD_1', 'in', 'our', 'last', 'attempt']",0
"['/', '/', 'this', 'can', 'happen', 'if', 'we', 'have', 'the', 'following']",0
"['/', '/', 'sequence', 'RECORD_1', '-', 'RECORD_1', '-', 'RECORD_2', '-', 'RECORD_3']",0
"['/', '/', 'After', 'reading', 'the', 'second', 'RECORD_1', 'in', 'the', 'above']",0
"['/', '/', 'sequence', ',', 'we', 'should', 'not', 'look', 'for', 'RECORD_1', 'again']",0
"['if', '(', 'b', '!', '=', 'RECORD_1', ')', '{']",0
"['b', '=', '(', 'byte', ')', 'in', '.', 'read', '(', ')', ';']",0
"['if', '(', 'b', '!', '=', 'RECORD_1', '&', '&', 'b', '!', '=', '-', '1', ')', '{']",0
"['if', '(', 'b', '=', '=', '-', '1', ')', 'return', 'null', ';']",0
"['b', '=', '(', 'byte', ')', 'in', '.', 'read', '(', ')', ';']",0
"['if', '(', 'b', '!', '=', 'RECORD_2', '&', '&', 'b', '!', '=', '-', '1', ')', '{']",0
"['if', '(', 'b', '=', '=', '-', '1', ')', 'return', 'null', ';']",0
"['b', '=', '(', 'byte', ')', 'in', '.', 'read', '(', ')', ';']",0
"['if', '(', 'b', '!', '=', 'RECORD_3', '&', '&', 'b', '!', '=', '-', '1', ')', '{']",0
"['if', '(', 'b', '=', '=', '-', '1', ')', 'return', 'null', ';']",0
"['return', '(', 'Tuple', ')', 'DataReaderWriter', '.', 'readDatum', '(', 'inData', ')', ';']",0
"['}', 'catch', '(', 'ExecException', 'ee', ')', '{']",1
"['throw', 'ee', ';']",1
"['public', 'void', 'bindTo', '(', 'String', 'fileName', ',', 'BufferedPositionedInputStream', 'in', ',', 'long', 'offset', ',', 'long', 'end', ')', 'throws', 'IOException', '{']",0
"['this', '.', 'in', '=', 'in', ';']",0
"['inData', '=', 'new', 'DataInputStream', '(', 'in', ')', ';']",0
"['this', '.', 'end', '=', 'end', ';']",0
"['DataOutputStream', 'out', '=', 'null', ';']",0
"['public', 'void', 'bindTo', '(', 'OutputStream', 'os', ')', 'throws', 'IOException', '{']",0
"['this', '.', 'out', '=', 'new', 'DataOutputStream', '(', 'new', 'BufferedOutputStream', '(', 'os', ')', ')', ';']",0
"['public', 'void', 'finish', '(', ')', 'throws', 'IOException', '{']",0
"['out', '.', 'flush', '(', ')', ';']",0
"['public', 'void', 'putNext', '(', 'Tuple', 't', ')', 'throws', 'IOException', '{']",0
"['out', '.', 'write', '(', 'RECORD_1', ')', ';']",0
"['out', '.', 'write', '(', 'RECORD_2', ')', ';']",0
"['out', '.', 'write', '(', 'RECORD_3', ')', ';']",0
"['t', '.', 'write', '(', 'out', ')', ';']",0
"['public', 'DataBag', 'bytesToBag', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'DataReaderWriter', '.', 'bytesToBag', '(', 'dis', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'bag', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'String', 'bytesToCharArray', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'DataReaderWriter', '.', 'bytesToCharArray', '(', 'dis', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'chararray', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Double', 'bytesToDouble', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'new', 'Double', '(', 'dis', '.', 'readDouble', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'double', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Float', 'bytesToFloat', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'new', 'Float', '(', 'dis', '.', 'readFloat', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'float', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Integer', 'bytesToInteger', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'new', 'Integer', '(', 'dis', '.', 'readInt', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'integer', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Long', 'bytesToLong', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'new', 'Long', '(', 'dis', '.', 'readLong', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'long', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Map', '<', 'Object', ',', 'Object', '>', 'bytesToMap', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'DataReaderWriter', '.', 'bytesToMap', '(', 'dis', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'map', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Tuple', 'bytesToTuple', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['DataInputStream', 'dis', '=', 'new', 'DataInputStream', '(', 'new', 'ByteArrayInputStream', '(', 'b', ')', ')', ';']",0
"['return', 'DataReaderWriter', '.', 'bytesToTuple', '(', 'dis', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'convert', 'bytearray', 'to', 'tuple', ',', '""', '+']",0
"['""', 'caught', 'IOException', '<', '""', '+', 'e', '.', 'getMessage', '(', ')', '+', '""', '>', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',']",0
"['mLog', ')', ';']",0
"['return', 'null', ';']",0
"['/', '*', '(', 'non', '-', 'Javadoc', ')']",0
"['public', 'Schema', 'determineSchema', '(', 'String', 'fileName', ',', 'ExecType', 'execType', ',']",0
"['DataStorage', 'storage', ')', 'throws', 'IOException', '{']",0
"['InputStream', 'is', '=', 'FileLocalizer', '.', 'open', '(', 'fileName', ',', 'execType', ',', 'storage', ')', ';']",0
"['bindTo', '(', 'fileName', ',', 'new', 'BufferedPositionedInputStream', '(', 'is', ')', ',', '0', ',', 'Long', '.', 'MAX_VALUE', ')', ';']",0
"['/', '/', 'get', 'the', 'first', 'record', 'from', 'the', 'input', 'file']",0
"['/', '/', 'and', 'figure', 'out', 'the', 'schema', 'from', 'the', 'data', 'in']",0
"['/', '/', 'the', 'first', 'record']",0
"['Tuple', 't', '=', 'getNext', '(', ')', ';']",0
"['is', '.', 'close', '(', ')', ';']",0
"['if', '(', 't', '=', '=', 'null', ')', '{']",0
"['/', '/', 'we', 'couldn', ""'"", 't', 'get', 'a', 'valid', 'record', 'from', 'the', 'input']",0
"['return', 'null', ';']",0
"['int', 'numFields', '=', 't', '.', 'size', '(', ')', ';']",0
"['Schema', 's', '=', 'new', 'Schema', '(', ')', ';']",0
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'numFields', ';', 'i', '+', '+', ')', '{']",0
"['s', '.', 'add', '(', 'DataType', '.', 'determineFieldSchema', '(', 't', '.', 'get', '(', 'i', ')', ')', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '2104', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'determining', 'schema', 'of', 'BinStorage', 'data', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e', ')', ';']",0
"['return', 's', ';']",0
"['public', 'void', 'fieldsToRead', '(', 'Schema', 'schema', ')', '{']",0
"['/', '/', 'TODO', 'Auto', '-', 'generated', 'method', 'stub']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'DataBag', 'bag', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'bag', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'bag', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'String', 's', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 's', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'chararray', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Double', 'd', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'd', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'double', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Float', 'f', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'f', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'float', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Integer', 'i', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'i', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'int', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Long', 'l', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'l', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'long', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Map', '<', 'Object', ',', 'Object', '>', 'm', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 'm', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'map', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Tuple', 't', ')', 'throws', 'IOException', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['DataOutputStream', 'dos', '=', 'new', 'DataOutputStream', '(', 'baos', ')', ';']",0
"['DataReaderWriter', '.', 'writeDatum', '(', 'dos', ',', 't', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'ee', ')', '{']",0
"['int', 'errCode', '=', '2105', ';']",0
"['String', 'msg', '=', '""', 'Error', 'while', 'converting', 'tuple', 'to', 'bytes', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'ee', ')', ';']",0
"['return', 'baos', '.', 'toByteArray', '(', ')', ';']",0
"['public', 'boolean', 'equals', '(', 'Object', 'obj', ')', '{']",0
"['return', 'true', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', ';']",0
"['import', 'java', '.', 'io', '.', 'File', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedReader', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'FileOutputStream', ';']",0
"['import', 'jline', '.', 'ConsoleReader', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', '.', 'GruntParser', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'pigscript', '.', 'parser', '.', '*', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'parser', '.', 'TokenMgrError', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['public', 'class', 'Grunt']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['BufferedReader', 'in', ';']",0
"['PigServer', 'pig', ';']",0
"['GruntParser', 'parser', ';']",0
"['public', 'Grunt', '(', 'BufferedReader', 'in', ',', 'PigContext', 'pigContext', ')', 'throws', 'ExecException']",0
"['this', '.', 'in', '=', 'in', ';']",0
"['this', '.', 'pig', '=', 'new', 'PigServer', '(', 'pigContext', ')', ';']",0
"['if', '(', 'in', '!', '=', 'null', ')']",0
"['parser', '=', 'new', 'GruntParser', '(', 'in', ')', ';']",0
"['parser', '.', 'setParams', '(', 'pig', ')', ';']",0
"['public', 'void', 'setConsoleReader', '(', 'ConsoleReader', 'c', ')']",0
"['parser', '.', 'setConsoleReader', '(', 'c', ')', ';']",0
"['public', 'void', 'run', '(', ')', '{']",0
"['boolean', 'verbose', '=', '""', 'true', '""', '.', 'equalsIgnoreCase', '(', 'pig', '.', 'getPigContext', '(', ')', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'verbose', '""', ')', ')', ';']",0
"['while', '(', 'true', ')', '{']",0
"['parser', '.', 'setInteractive', '(', 'true', ')', ';']",0
"['parser', '.', 'parseStopOnError', '(', ')', ';']",0
"['}', 'catch', '(', 'Throwable', 't', ')', '{']",0
"['LogUtils', '.', 'writeLog', '(', 't', ',', 'pig', '.', 'getPigContext', '(', ')', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'pig', '.', 'logfile', '""', ')', ',', 'log', ',', 'verbose', ')', ';']",0
"['parser', '.', 'ReInit', '(', 'in', ')', ';']",0
"['public', 'void', 'exec', '(', ')', 'throws', 'Throwable', '{']",0
"['boolean', 'verbose', '=', '""', 'true', '""', '.', 'equalsIgnoreCase', '(', 'pig', '.', 'getPigContext', '(', ')', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'verbose', '""', ')', ')', ';']",0
"['parser', '.', 'setInteractive', '(', 'false', ')', ';']",0
"['parser', '.', 'parseStopOnError', '(', ')', ';']",0
"['}', 'catch', '(', 'Throwable', 't', ')', '{']",0
"['LogUtils', '.', 'writeLog', '(', 't', ',', 'pig', '.', 'getPigContext', '(', ')', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'pig', '.', 'logfile', '""', ')', ',', 'log', ',', 'verbose', ')', ';']",0
"['throw', '(', 't', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', ';']",0
"['import', 'java', '.', 'io', '.', '*', ';']",0
"['import', 'java', '.', 'util', '.', '*', ';']",0
"['import', 'java', '.', 'util', '.', 'jar', '.', '*', ';']",0
"['import', 'java', '.', 'text', '.', 'ParseException', ';']",0
"['import', 'jline', '.', 'ConsoleReader', ';']",0
"['import', 'jline', '.', 'ConsoleReaderInputStream', ';']",0
"['import', 'jline', '.', 'History', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'log4j', '.', 'Level', ';']",0
"['import', 'org', '.', 'apache', '.', 'log4j', '.', 'PropertyConfigurator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ExecType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'FileLocalizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LogicalPlanBuilder', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'JarManager', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'PropertiesUtil', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'cmdline', '.', 'CmdLineParser', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', '.', 'Grunt', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', '.', 'PigCompletor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'timer', '.', 'PerformanceTimerFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'parameters', '.', 'ParameterSubstitutionPreprocessor', ';']",0
"['public', 'class', 'Main']",0
"['private', 'final', 'static', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'Main', '.', 'class', ')', ';']",0
"['private', 'static', 'final', 'String', 'LOG4J_CONF', '=', '""', 'log4jconf', '""', ';']",0
"['private', 'static', 'final', 'String', 'BRIEF', '=', '""', 'brief', '""', ';']",0
"['private', 'static', 'final', 'String', 'DEBUG', '=', '""', 'debug', '""', ';']",0
"['private', 'static', 'final', 'String', 'JAR', '=', '""', 'jar', '""', ';']",0
"['private', 'static', 'final', 'String', 'VERBOSE', '=', '""', 'verbose', '""', ';']",0
"['private', 'enum', 'ExecMode', '{', 'STRING', ',', 'FILE', ',', 'SHELL', ',', 'UNKNOWN', '}', ';']",0
"['/', '*', '*']",0
"['public', 'static', 'void', 'main', '(', 'String', 'args', '[', ']', ')']",0
"['int', 'rc', '=', '1', ';']",0
"['Properties', 'properties', '=', 'new', 'Properties', '(', ')', ';']",0
"['PropertiesUtil', '.', 'loadPropertiesFromFile', '(', 'properties', ')', ';']",0
"['boolean', 'verbose', '=', 'false', ';']",0
"['boolean', 'gruntCalled', '=', 'false', ';']",0
"['String', 'logFileName', '=', 'null', ';']",0
"['BufferedReader', 'pin', '=', 'null', ';']",0
"['boolean', 'debug', '=', 'false', ';']",0
"['boolean', 'dryrun', '=', 'false', ';']",0
"['ArrayList', '<', 'String', '>', 'params', '=', 'new', 'ArrayList', '<', 'String', '>', '(', ')', ';']",0
"['ArrayList', '<', 'String', '>', 'paramFiles', '=', 'new', 'ArrayList', '<', 'String', '>', '(', ')', ';']",0
"['CmdLineParser', 'opts', '=', 'new', 'CmdLineParser', '(', 'args', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", '4', ""'"", ',', '""', 'log4jconf', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'b', ""'"", ',', '""', 'brief', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'c', ""'"", ',', '""', 'cluster', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'd', ""'"", ',', '""', 'debug', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'e', ""'"", ',', '""', 'execute', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'f', ""'"", ',', '""', 'file', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'h', ""'"", ',', '""', 'help', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'o', ""'"", ',', '""', 'hod', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'j', ""'"", ',', '""', 'jar', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'v', ""'"", ',', '""', 'verbose', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'x', ""'"", ',', '""', 'exectype', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'i', ""'"", ',', '""', 'version', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'OPTIONAL', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'p', ""'"", ',', '""', 'param', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'OPTIONAL', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'm', ""'"", ',', '""', 'param_file', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'OPTIONAL', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'r', ""'"", ',', '""', 'dryrun', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'l', ""'"", ',', '""', 'logfile', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'REQUIRED', ')', ';']",0
"['opts', '.', 'registerOpt', '(', ""'"", 'w', ""'"", ',', '""', 'warning', '""', ',', 'CmdLineParser', '.', 'ValueExpected', '.', 'NOT_ACCEPTED', ')', ';']",0
"['ExecMode', 'mode', '=', 'ExecMode', '.', 'UNKNOWN', ';']",0
"['String', 'file', '=', 'null', ';']",0
"['ExecType', 'execType', '=', 'ExecType', '.', 'MAPREDUCE', ';']",0
"['String', 'execTypeString', '=', 'properties', '.', 'getProperty', '(', '""', 'exectype', '""', ')', ';']",0
"['if', '(', 'execTypeString', '!', '=', 'null', '&', '&', 'execTypeString', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['execType', '=', 'PigServer', '.', 'parseExecType', '(', 'execTypeString', ')', ';']",0
"['String', 'cluster', '=', '""', 'local', '""', ';']",0
"['String', 'clusterConfigured', '=', 'properties', '.', 'getProperty', '(', '""', 'cluster', '""', ')', ';']",0
"['if', '(', 'clusterConfigured', '!', '=', 'null', '&', '&', 'clusterConfigured', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['cluster', '=', 'clusterConfigured', ';']",0
"['/', '/', 'by', 'default', 'warning', 'aggregation', 'is', 'on']",0
"['properties', '.', 'setProperty', '(', '""', 'aggregate', '.', 'warning', '""', ',', '""', '""', '+', 'true', ')', ';']",0
"['char', 'opt', ';']",0
"['while', '(', '(', 'opt', '=', 'opts', '.', 'getNextOpt', '(', ')', ')', '!', '=', 'CmdLineParser', '.', 'EndOfOpts', ')', '{']",0
"['switch', '(', 'opt', ')', '{']",0
"['case', ""'"", '4', ""'"", ':']",0
"['String', 'log4jconf', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['if', '(', 'log4jconf', '!', '=', 'null', ')', '{']",0
"['properties', '.', 'setProperty', '(', 'LOG4J_CONF', ',', 'log4jconf', ')', ';']",0
"['case', ""'"", 'b', ""'"", ':']",0
"['properties', '.', 'setProperty', '(', 'BRIEF', ',', '""', 'true', '""', ')', ';']",0
"['case', ""'"", 'c', ""'"", ':']",0
"['/', '/', 'Needed', 'away', 'to', 'specify', 'the', 'cluster', 'to', 'run', 'the', 'MR', 'job', 'on']",0
"['/', '/', 'Bug', '831708', '-', 'fixed']",0
"['String', 'clusterParameter', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['if', '(', 'clusterParameter', '!', '=', 'null', '&', '&', 'clusterParameter', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['cluster', '=', 'clusterParameter', ';']",0
"['case', ""'"", 'd', ""'"", ':']",0
"['String', 'logLevel', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['if', '(', 'logLevel', '!', '=', 'null', ')', '{']",0
"['properties', '.', 'setProperty', '(', 'DEBUG', ',', 'logLevel', ')', ';']",0
"['debug', '=', 'true', ';']",0
"['case', ""'"", 'e', ""'"", ':']",0
"['mode', '=', 'ExecMode', '.', 'STRING', ';']",0
"['case', ""'"", 'f', ""'"", ':']",0
"['mode', '=', 'ExecMode', '.', 'FILE', ';']",0
"['file', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['case', ""'"", 'h', ""'"", ':']",0
"['usage', '(', ')', ';']",0
"['case', ""'"", 'j', ""'"", ':']",0
"['String', 'jarsString', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['if', '(', 'jarsString', '!', '=', 'null', ')', '{']",0
"['properties', '.', 'setProperty', '(', 'JAR', ',', 'jarsString', ')', ';']",0
"['case', ""'"", 'l', ""'"", ':']",0
"['/', '/', 'call', 'to', 'method', 'that', 'validates', 'the', 'path', 'to', 'the', 'log', 'file']",0
"['/', '/', 'and', 'sets', 'up', 'the', 'file', 'to', 'store', 'the', 'client', 'side', 'log', 'file']",0
"['String', 'logFileParameter', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['if', '(', 'logFileParameter', '!', '=', 'null', '&', '&', 'logFileParameter', '.', 'length', '(', ')', '>', '0', ')', '{']",0
"['logFileName', '=', 'validateLogFile', '(', 'logFileParameter', ',', 'null', ')', ';']",0
"['}', 'else', '{']",1
"['logFileName', '=', 'validateLogFile', '(', 'logFileName', ',', 'null', ')', ';']",0
"['properties', '.', 'setProperty', '(', '""', 'pig', '.', 'logfile', '""', ',', 'logFileName', ')', ';']",0
"['case', ""'"", 'm', ""'"", ':']",0
"['paramFiles', '.', 'add', '(', 'opts', '.', 'getValStr', '(', ')', ')', ';']",0
"['case', ""'"", 'o', ""'"", ':']",0
"['/', '/', 'TODO', 'sgroschupf', 'using', 'system', 'properties', 'is', 'always', 'a', 'very', 'bad', 'idea']",0
"['String', 'gateway', '=', 'System', '.', 'getProperty', '(', '""', 'ssh', '.', 'gateway', '""', ')', ';']",0
"['if', '(', 'gateway', '=', '=', 'null', '|', '|', 'gateway', '.', 'length', '(', ')', '=', '=', '0', ')', '{']",0
"['properties', '.', 'setProperty', '(', '""', 'hod', '.', 'server', '""', ',', '""', 'local', '""', ')', ';']",0
"['}', 'else', '{']",1
"['properties', '.', 'setProperty', '(', '""', 'hod', '.', 'server', '""', ',', 'System', '.', 'getProperty', '(', '""', 'ssh', '.', 'gateway', '""', ')', ')', ';']",0
"['case', ""'"", 'p', ""'"", ':']",0
"['String', 'val', '=', 'opts', '.', 'getValStr', '(', ')', ';']",0
"['params', '.', 'add', '(', 'opts', '.', 'getValStr', '(', ')', ')', ';']",0
"['case', ""'"", 'r', ""'"", ':']",0
"['/', '/', 'currently', 'only', 'used', 'for', 'parameter', 'substitution']",0
"['/', '/', 'will', 'be', 'extended', 'in', 'the', 'future']",0
"['dryrun', '=', 'true', ';']",0
"['case', ""'"", 'v', ""'"", ':']",0
"['properties', '.', 'setProperty', '(', 'VERBOSE', ',', '""', '""', '+', 'true', ')', ';']",0
"['verbose', '=', 'true', ';']",0
"['case', ""'"", 'w', ""'"", ':']",0
"['properties', '.', 'setProperty', '(', '""', 'aggregate', '.', 'warning', '""', ',', '""', '""', '+', 'false', ')', ';']",0
"['case', ""'"", 'x', ""'"", ':']",0
"['execType', '=', 'PigServer', '.', 'parseExecType', '(', 'opts', '.', 'getValStr', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'ERROR', ':', 'Unrecognized', 'exectype', '.', '""', ',', 'e', ')', ';']",0
"['case', ""'"", 'i', ""'"", ':']",0
"['System', '.', 'out', '.', 'println', '(', 'getVersionString', '(', ')', ')', ';']",0
"['default', ':', '{']",0
"['Character', 'cc', '=', 'new', 'Character', '(', 'opt', ')', ';']",0
"['throw', 'new', 'AssertionError', '(', '""', 'Unhandled', 'option', '""', '+', 'cc', '.', 'toString', '(', ')', ')', ';']",0
"['/', '/', 'configure', 'logging']",0
"['configureLog4J', '(', 'properties', ')', ';']",0
"['/', '/', 'create', 'the', 'context', 'with', 'the', 'parameter']",0
"['PigContext', 'pigContext', '=', 'new', 'PigContext', '(', 'execType', ',', 'properties', ')', ';']",0
"['if', '(', 'logFileName', '=', '=', 'null', ')', '{']",1
"['logFileName', '=', 'validateLogFile', '(', 'null', ',', 'null', ')', ';']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', '""', 'pig', '.', 'logfile', '""', ',', 'logFileName', ')', ';']",0
"['LogicalPlanBuilder', '.', 'classloader', '=', 'pigContext', '.', 'createCl', '(', 'null', ')', ';']",0
"['/', '/', 'construct', 'the', 'parameter', 'substitution', 'preprocessor']",0
"['Grunt', 'grunt', '=', 'null', ';']",0
"['BufferedReader', 'in', ';']",0
"['String', 'substFile', '=', 'null', ';']",0
"['switch', '(', 'mode', ')', '{']",0
"['case', 'FILE', ':']",0
"['/', '/', 'Run', ',', 'using', 'the', 'provided', 'file', 'as', 'a', 'pig', 'file']",0
"['in', '=', 'new', 'BufferedReader', '(', 'new', 'FileReader', '(', 'file', ')', ')', ';']",0
"['/', '/', 'run', 'parameter', 'substitution', 'preprocessor', 'first']",0
"['substFile', '=', 'file', '+', '""', '.', 'substituted', '""', ';']",0
"['pin', '=', 'runParamPreprocessor', '(', 'in', ',', 'params', ',', 'paramFiles', ',', 'substFile', ',', 'debug', '|', '|', 'dryrun', ')', ';']",0
"['if', '(', 'dryrun', ')', '{']",0
"['log', '.', 'info', '(', '""', 'Dry', 'run', 'completed', '.', 'Substituted', 'pig', 'script', 'is', 'at', '""', '+', 'substFile', ')', ';']",0
"['logFileName', '=', 'validateLogFile', '(', 'logFileName', ',', 'file', ')', ';']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', '""', 'pig', '.', 'logfile', '""', ',', 'logFileName', ')', ';']",0
"['/', '/', 'Set', 'job', 'name', 'based', 'on', 'name', 'of', 'the', 'script']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', 'PigContext', '.', 'JOB_NAME', ',']",0
"['""', 'PigLatin', ':', '""', '+', 'new', 'File', '(', 'file', ')', '.', 'getName', '(', ')']",0
"['if', '(', '!', 'debug', ')']",0
"['new', 'File', '(', 'substFile', ')', '.', 'deleteOnExit', '(', ')', ';']",0
"['grunt', '=', 'new', 'Grunt', '(', 'pin', ',', 'pigContext', ')', ';']",0
"['gruntCalled', '=', 'true', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['rc', '=', '0', ';']",0
"['case', 'STRING', ':', '{']",0
"['/', '/', 'Gather', 'up', 'all', 'the', 'remaining', 'arguments', 'into', 'a', 'string', 'and', 'pass', 'them', 'into']",0
"['/', '/', 'grunt', '.']",0
"['StringBuffer', 'sb', '=', 'new', 'StringBuffer', '(', ')', ';']",0
"['String', 'remainders', '[', ']', '=', 'opts', '.', 'getRemainingArgs', '(', ')', ';']",0
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'remainders', '.', 'length', ';', 'i', '+', '+', ')', '{']",0
"['if', '(', 'i', '!', '=', '0', ')', 'sb', '.', 'append', '(', ""'"", ""'"", ')', ';']",0
"['sb', '.', 'append', '(', 'remainders', '[', 'i', ']', ')', ';']",0
"['in', '=', 'new', 'BufferedReader', '(', 'new', 'StringReader', '(', 'sb', '.', 'toString', '(', ')', ')', ')', ';']",0
"['grunt', '=', 'new', 'Grunt', '(', 'in', ',', 'pigContext', ')', ';']",0
"['gruntCalled', '=', 'true', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['rc', '=', '0', ';']",0
"['/', '/', 'If', 'we', ""'"", 're', 'here', ',', 'we', 'don', ""'"", 't', 'know', 'yet', 'what', 'they', 'want', '.', 'They', 'may', 'have', 'just']",0
"['/', '/', 'given', 'us', 'a', 'jar', 'to', 'execute', ',', 'they', 'might', 'have', 'given', 'us', 'a', 'pig', 'script', 'to']",0
"['/', '/', 'execute', ',', 'or', 'they', 'might', 'have', 'given', 'us', 'a', 'dash', '(', 'or', 'nothing', ')', 'which', 'means', 'to']",0
"['/', '/', 'run', 'grunt', 'interactive', '.']",0
"['String', 'remainders', '[', ']', '=', 'opts', '.', 'getRemainingArgs', '(', ')', ';']",0
"['if', '(', 'remainders', '=', '=', 'null', ')', '{']",0
"['/', '/', 'Interactive']",0
"['mode', '=', 'ExecMode', '.', 'SHELL', ';']",0
"['ConsoleReader', 'reader', '=', 'new', 'ConsoleReader', '(', 'System', '.', 'in', ',', 'new', 'OutputStreamWriter', '(', 'System', '.', 'out', ')', ')', ';']",0
"['reader', '.', 'addCompletor', '(', 'new', 'PigCompletor', '(', ')', ')', ';']",0
"['reader', '.', 'setDefaultPrompt', '(', '""', 'grunt', '>', '""', ')', ';']",0
"['final', 'String', 'HISTORYFILE', '=', '""', '.', 'pig_history', '""', ';']",0
"['String', 'historyFile', '=', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'home', '""', ')', '+', 'File', '.', 'separator', '+', 'HISTORYFILE', ';']",0
"['reader', '.', 'setHistory', '(', 'new', 'History', '(', 'new', 'File', '(', 'historyFile', ')', ')', ')', ';']",0
"['ConsoleReaderInputStream', 'inputStream', '=', 'new', 'ConsoleReaderInputStream', '(', 'reader', ')', ';']",0
"['grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'inputStream', ')', ')', ',', 'pigContext', ')', ';']",0
"['grunt', '.', 'setConsoleReader', '(', 'reader', ')', ';']",0
"['gruntCalled', '=', 'true', ';']",0
"['grunt', '.', 'run', '(', ')', ';']",0
"['rc', '=', '0', ';']",0
"['}', 'else', '{']",1
"['/', '/', 'They', 'have', 'a', 'pig', 'script', 'they', 'want', 'us', 'to', 'run', '.']",0
"['if', '(', 'remainders', '.', 'length', '>', '1', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'You', 'can', 'only', 'run', 'one', 'pig', 'script', '""']",0
"['+', '""', 'at', 'a', 'time', 'from', 'the', 'command', 'line', '.', '""', ')', ';']",0
"['mode', '=', 'ExecMode', '.', 'FILE', ';']",0
"['in', '=', 'new', 'BufferedReader', '(', 'new', 'FileReader', '(', 'remainders', '[', '0', ']', ')', ')', ';']",0
"['/', '/', 'run', 'parameter', 'substitution', 'preprocessor', 'first']",0
"['substFile', '=', 'remainders', '[', '0', ']', '+', '""', '.', 'substituted', '""', ';']",0
"['pin', '=', 'runParamPreprocessor', '(', 'in', ',', 'params', ',', 'paramFiles', ',', 'substFile', ',', 'debug', '|', '|', 'dryrun', ')', ';']",0
"['if', '(', 'dryrun', ')', '{']",0
"['log', '.', 'info', '(', '""', 'Dry', 'run', 'completed', '.', 'Substituted', 'pig', 'script', 'is', 'at', '""', '+', 'substFile', ')', ';']",0
"['logFileName', '=', 'validateLogFile', '(', 'logFileName', ',', 'remainders', '[', '0', ']', ')', ';']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', '""', 'pig', '.', 'logfile', '""', ',', 'logFileName', ')', ';']",0
"['if', '(', '!', 'debug', ')']",0
"['new', 'File', '(', 'substFile', ')', '.', 'deleteOnExit', '(', ')', ';']",0
"['/', '/', 'Set', 'job', 'name', 'based', 'on', 'name', 'of', 'the', 'script']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', 'PigContext', '.', 'JOB_NAME', ',']",0
"['""', 'PigLatin', ':', '""', '+', 'new', 'File', '(', 'remainders', '[', '0', ']', ')', '.', 'getName', '(', ')']",0
"['grunt', '=', 'new', 'Grunt', '(', 'pin', ',', 'pigContext', ')', ';']",0
"['gruntCalled', '=', 'true', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['rc', '=', '0', ';']",0
"['/', '/', 'Per', 'Utkarsh', 'and', 'Chris', 'invocation', 'of', 'jar', 'file', 'via', 'pig', 'depricated', '.']",0
"['}', 'catch', '(', 'ParseException', 'e', ')', '{']",0
"['usage', '(', ')', ';']",0
"['rc', '=', '2', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'e', ')', '{']",0
"['usage', '(', ')', ';']",0
"['rc', '=', '2', ';']",0
"['}', 'catch', '(', 'PigException', 'pe', ')', '{']",0
"['if', '(', 'pe', '.', 'retriable', '(', ')', ')', '{']",0
"['rc', '=', '1', ';']",0
"['}', 'else', '{']",1
"['rc', '=', '2', ';']",0
"['if', '(', '!', 'gruntCalled', ')', '{']",0
"['LogUtils', '.', 'writeLog', '(', 'pe', ',', 'logFileName', ',', 'log', ',', 'verbose', ')', ';']",0
"['}', 'catch', '(', 'Throwable', 'e', ')', '{']",0
"['rc', '=', '2', ';']",0
"['if', '(', '!', 'gruntCalled', ')', '{']",0
"['LogUtils', '.', 'writeLog', '(', 'e', ',', 'logFileName', ',', 'log', ',', 'verbose', ')', ';']",0
"['}', 'finally', '{']",0
"['/', '/', 'clear', 'temp', 'files']",0
"['FileLocalizer', '.', 'deleteTempFiles', '(', ')', ';']",0
"['PerformanceTimerFactory', '.', 'getPerfTimerFactory', '(', ')', '.', 'dumpTimers', '(', ')', ';']",0
"['System', '.', 'exit', '(', 'rc', ')', ';']",0
"['/', '/', 'TODO', 'jz', ':', 'log4j', '.', 'properties', 'should', 'be', 'used', 'instead']",0
"['private', 'static', 'void', 'configureLog4J', '(', 'Properties', 'properties', ')', '{']",0
"['/', '/', 'TODO', 'Add', 'a', 'file', 'appender', 'for', 'the', 'logs']",0
"['/', '/', 'TODO', 'Need', 'to', 'create', 'a', 'property', 'in', 'the', 'properties', 'file', 'for', 'it', '.']",0
"['/', '/', 'sgroschupf', ',', '25Feb2008', ':', 'this', 'method', 'will', 'be', 'obsolete', 'with', 'PIG', '-', '115', '.']",0
"['String', 'log4jconf', '=', 'properties', '.', 'getProperty', '(', 'LOG4J_CONF', ')', ';']",0
"['String', 'trueString', '=', '""', 'true', '""', ';']",0
"['boolean', 'brief', '=', 'trueString', '.', 'equalsIgnoreCase', '(', 'properties', '.', 'getProperty', '(', 'BRIEF', ')', ')', ';']",0
"['Level', 'logLevel', '=', 'Level', '.', 'INFO', ';']",0
"['String', 'logLevelString', '=', 'properties', '.', 'getProperty', '(', 'DEBUG', ')', ';']",0
"['if', '(', 'logLevelString', '!', '=', 'null', ')', '{']",0
"['logLevel', '=', 'Level', '.', 'toLevel', '(', 'logLevelString', ',', 'Level', '.', 'INFO', ')', ';']",0
"['if', '(', 'log4jconf', '!', '=', 'null', ')', '{']",0
"['PropertyConfigurator', '.', 'configure', '(', 'log4jconf', ')', ';']",0
"['}', 'else', 'if', '(', '!', 'brief', ')', '{']",0
"['/', '/', 'non', '-', 'brief', 'logging', '-', 'timestamps']",0
"['Properties', 'props', '=', 'new', 'Properties', '(', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'rootLogger', '""', ',', '""', 'INFO', ',', 'PIGCONSOLE', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '""', ',']",0
"['""', 'org', '.', 'apache', '.', 'log4j', '.', 'ConsoleAppender', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'layout', '""', ',']",0
"['""', 'org', '.', 'apache', '.', 'log4j', '.', 'PatternLayout', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'layout', '.', 'ConversionPattern', '""', ',']",0
"['""', '%', 'd', '[', '%', 't', ']', '%', '-', '5p', '%', 'c', '-', '%', 'm', '%', 'n', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'target', '""', ',']",0
"['""', 'System', '.', 'err', '""', ')', ';']",0
"['PropertyConfigurator', '.', 'configure', '(', 'props', ')', ';']",0
"['}', 'else', '{']",1
"['/', '/', 'brief', 'logging', '-', 'no', 'timestamps']",0
"['Properties', 'props', '=', 'new', 'Properties', '(', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'rootLogger', '""', ',', '""', 'INFO', ',', 'PIGCONSOLE', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '""', ',']",0
"['""', 'org', '.', 'apache', '.', 'log4j', '.', 'ConsoleAppender', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'layout', '""', ',']",0
"['""', 'org', '.', 'apache', '.', 'log4j', '.', 'PatternLayout', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'layout', '.', 'ConversionPattern', '""', ',']",0
"['""', '%', 'm', '%', 'n', '""', ')', ';']",0
"['props', '.', 'setProperty', '(', '""', 'log4j', '.', 'appender', '.', 'PIGCONSOLE', '.', 'target', '""', ',']",0
"['""', 'System', '.', 'err', '""', ')', ';']",0
"['PropertyConfigurator', '.', 'configure', '(', 'props', ')', ';']",0
"['/', '/', 'returns', 'the', 'stream', 'of', 'final', 'pig', 'script', 'to', 'be', 'passed', 'to', 'Grunt']",0
"['private', 'static', 'BufferedReader', 'runParamPreprocessor', '(', 'BufferedReader', 'origPigScript', ',', 'ArrayList', '<', 'String', '>', 'params', ',']",0
"['ArrayList', '<', 'String', '>', 'paramFiles', ',', 'String', 'scriptFile', ',', 'boolean', 'createFile', ')']",0
"['throws', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'parameters', '.', 'ParseException', ',', 'IOException', '{']",0
"['ParameterSubstitutionPreprocessor', 'psp', '=', 'new', 'ParameterSubstitutionPreprocessor', '(', '50', ')', ';']",0
"['String', '[', ']', 'type1', '=', 'new', 'String', '[', '1', ']', ';']",0
"['String', '[', ']', 'type2', '=', 'new', 'String', '[', '1', ']', ';']",0
"['if', '(', 'createFile', ')', '{']",0
"['BufferedWriter', 'fw', '=', 'new', 'BufferedWriter', '(', 'new', 'FileWriter', '(', 'scriptFile', ')', ')', ';']",0
"['psp', '.', 'genSubstitutedFile', '(', 'origPigScript', ',', 'fw', ',', 'params', '.', 'size', '(', ')', '>', '0', '?', 'params', '.', 'toArray', '(', 'type1', ')', ':', 'null', ',']",0
"['paramFiles', '.', 'size', '(', ')', '>', '0', '?', 'paramFiles', '.', 'toArray', '(', 'type2', ')', ':', 'null', ')', ';']",0
"['return', 'new', 'BufferedReader', '(', 'new', 'FileReader', '(', 'scriptFile', ')', ')', ';']",0
"['}', 'else', '{']",1
"['StringWriter', 'writer', '=', 'new', 'StringWriter', '(', ')', ';']",0
"['psp', '.', 'genSubstitutedFile', '(', 'origPigScript', ',', 'writer', ',', 'params', '.', 'size', '(', ')', '>', '0', '?', 'params', '.', 'toArray', '(', 'type1', ')', ':', 'null', ',']",0
"['paramFiles', '.', 'size', '(', ')', '>', '0', '?', 'paramFiles', '.', 'toArray', '(', 'type2', ')', ':', 'null', ')', ';']",0
"['return', 'new', 'BufferedReader', '(', 'new', 'StringReader', '(', 'writer', '.', 'toString', '(', ')', ')', ')', ';']",0
"['private', 'static', 'String', 'getVersionString', '(', ')', '{']",0
"['String', 'findContainingJar', '=', 'JarManager', '.', 'findContainingJar', '(', 'Main', '.', 'class', ')', ';']",0
"['StringBuffer', 'buffer', '=', 'new', 'StringBuffer', '(', ')', ';']",0
"['JarFile', 'jar', '=', 'new', 'JarFile', '(', 'findContainingJar', ')', ';']",0
"['final', 'Manifest', 'manifest', '=', 'jar', '.', 'getManifest', '(', ')', ';']",0
"['final', 'Map', '<', 'String', ',', 'Attributes', '>', 'attrs', '=', 'manifest', '.', 'getEntries', '(', ')', ';']",0
"['Attributes', 'attr', '=', 'attrs', '.', 'get', '(', '""', 'org', '/', 'apache', '/', 'pig', '""', ')', ';']",0
"['String', 'version', '=', '(', 'String', ')', 'attr', '.', 'getValue', '(', '""', 'Implementation', '-', 'Version', '""', ')', ';']",0
"['String', 'svnRevision', '=', '(', 'String', ')', 'attr', '.', 'getValue', '(', '""', 'Svn', '-', 'Revision', '""', ')', ';']",0
"['String', 'buildTime', '=', '(', 'String', ')', 'attr', '.', 'getValue', '(', '""', 'Build', '-', 'TimeStamp', '""', ')', ';']",0
"['/', '/', 'we', 'use', 'a', 'version', 'string', 'similar', 'to', 'svn']",0
"['/', '/', 'svn', ',', 'version', '1', '.', '4', '.', '4', '(', 'r25188', ')']",0
"['/', '/', 'compiled', 'Sep', '23', '2007', ',', '22', ':', '32', ':', '34']",0
"['return', '""', 'Apache', 'Pig', 'version', '""', '+', 'version', '+', '""', '(', 'r', '""', '+', 'svnRevision', '+', '""', ')', '\\', 'ncompiled', '""', '+', 'buildTime', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'unable', 'to', 'read', 'pigs', 'manifest', 'file', '""', ',', 'e', ')', ';']",0
"['public', 'static', 'void', 'usage', '(', ')']",0
"['System', '.', 'out', '.', 'println', '(', '""', '\\', 'n', '""', '+', 'getVersionString', '(', ')', '+', '""', '\\', 'n', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'USAGE', ':', 'Pig', '[', 'options', ']', '[', '-', ']', ':', 'Run', 'interactively', 'in', 'grunt', 'shell', '.', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'Pig', '[', 'options', ']', '-', 'e', '[', 'xecute', ']', 'cmd', '[', 'cmd', '.', '.', '.', ']', ':', 'Run', 'cmd', '(', 's', ')', '.', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'Pig', '[', 'options', ']', '[', '-', 'f', '[', 'ile', ']', ']', 'file', ':', 'Run', 'cmds', 'found', 'in', 'file', '.', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'options', 'include', ':', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', '4', ',', '-', 'log4jconf', 'log4j', 'configuration', 'file', ',', 'overrides', 'log', 'conf', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'b', ',', '-', 'brief', 'brief', 'logging', '(', 'no', 'timestamps', ')', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'c', ',', '-', 'cluster', 'clustername', ',', 'kryptonite', 'is', 'default', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'd', ',', '-', 'debug', 'debug', 'level', ',', 'INFO', 'is', 'default', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'h', ',', '-', 'help', 'display', 'this', 'message', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'j', ',', '-', 'jar', 'jarfile', 'load', 'jarfile', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'o', ',', '-', 'hod', 'read', 'hod', 'server', 'from', 'system', 'property', 'ssh', '.', 'gateway', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'v', ',', '-', 'verbose', 'print', 'all', 'error', 'messages', 'to', 'screen', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'x', ',', '-', 'exectype', 'local', '|', 'mapreduce', ',', 'mapreduce', 'is', 'default', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'i', ',', '-', 'version', 'display', 'version', 'information', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'l', ',', '-', 'logfile', 'path', 'to', 'client', 'side', 'log', 'file', ';', 'current', 'working', 'directory', 'is', 'default', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '-', 'w', ',', '-', 'warning', 'turn', 'warning', 'on', ';', 'also', 'turns', 'warning', 'aggregation', 'off', '""', ')', ';']",0
"['private', 'static', 'String', 'validateLogFile', '(', 'String', 'logFileName', ',', 'String', 'scriptName', ')', '{']",0
"['String', 'strippedDownScriptName', '=', 'null', ';']",0
"['if', '(', 'scriptName', '!', '=', 'null', ')', '{']",0
"['File', 'scriptFile', '=', 'new', 'File', '(', 'scriptName', ')', ';']",0
"['if', '(', '!', 'scriptFile', '.', 'isDirectory', '(', ')', ')', '{']",0
"['String', 'scriptFileAbsPath', ';']",0
"['scriptFileAbsPath', '=', 'scriptFile', '.', 'getCanonicalPath', '(', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Could', 'not', 'compute', 'canonical', 'path', 'to', 'the', 'script', 'file', '""', '+', 'ioe', '.', 'getMessage', '(', ')', ')', ';']",0
"['strippedDownScriptName', '=', 'getFileFromCanonicalPath', '(', 'scriptFileAbsPath', ')', ';']",0
"['String', 'defaultLogFileName', '=', '(', 'strippedDownScriptName', '=', '=', 'null', '?', '""', 'pig_', '""', ':', 'strippedDownScriptName', ')', '+', 'new', 'Date', '(', ')', '.', 'getTime', '(', ')', '+', '""', '.', 'log', '""', ';']",0
"['File', 'logFile', ';']",0
"['if', '(', 'logFileName', '!', '=', 'null', ')', '{']",0
"['logFile', '=', 'new', 'File', '(', 'logFileName', ')', ';']",0
"['/', '/', 'Check', 'if', 'the', 'file', 'name', 'is', 'a', 'directory']",0
"['/', '/', 'append', 'the', 'default', 'file', 'name', 'to', 'the', 'file']",0
"['if', '(', 'logFile', '.', 'isDirectory', '(', ')', ')', '{']",0
"['if', '(', 'logFile', '.', 'canWrite', '(', ')', ')', '{']",0
"['logFileName', '=', 'logFile', '.', 'getCanonicalPath', '(', ')', '+', 'File', '.', 'separator', '+', 'defaultLogFileName', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Could', 'not', 'compute', 'canonical', 'path', 'to', 'the', 'log', 'file', '""', '+', 'ioe', '.', 'getMessage', '(', ')', ')', ';']",0
"['return', 'logFileName', ';']",0
"['}', 'else', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Need', 'write', 'permission', 'in', 'the', 'directory', ':', '""', '+', 'logFileName', '+', '""', 'to', 'create', 'log', 'file', '.', '""', ')', ';']",0
"['}', 'else', '{']",1
"['/', '/', 'we', 'have', 'a', 'relative', 'path', 'or', 'an', 'absolute', 'path', 'to', 'the', 'log', 'file']",0
"['/', '/', 'check', 'if', 'we', 'can', 'write', 'to', 'the', 'directory', 'where', 'this', 'file', 'is', '/', 'will', 'be', 'stored']",0
"['if', '(', 'logFile', '.', 'exists', '(', ')', ')', '{']",0
"['if', '(', 'logFile', '.', 'canWrite', '(', ')', ')', '{']",0
"['logFileName', '=', 'new', 'File', '(', 'logFileName', ')', '.', 'getCanonicalPath', '(', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Could', 'not', 'compute', 'canonical', 'path', 'to', 'the', 'log', 'file', '""', '+', 'ioe', '.', 'getMessage', '(', ')', ')', ';']",0
"['return', 'logFileName', ';']",0
"['}', 'else', '{']",1
"['/', '/', 'do', 'not', 'have', 'write', 'permissions', 'for', 'the', 'log', 'file']",0
"['/', '/', 'bail', 'out', 'with', 'an', 'error', 'message']",0
"['throw', 'new', 'AssertionError', '(', '""', 'Cannot', 'write', 'to', 'file', ':', '""', '+', 'logFileName', '+', '""', '.', 'Need', 'write', 'permission', '.', '""', ')', ';']",0
"['}', 'else', '{']",1
"['logFile', '=', 'logFile', '.', 'getParentFile', '(', ')', ';']",0
"['if', '(', 'logFile', '!', '=', 'null', ')', '{']",0
"['/', '/', 'if', 'the', 'directory', 'is', 'writable', 'we', 'are', 'good', 'to', 'go']",0
"['if', '(', 'logFile', '.', 'canWrite', '(', ')', ')', '{']",0
"['logFileName', '=', 'new', 'File', '(', 'logFileName', ')', '.', 'getCanonicalPath', '(', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Could', 'not', 'compute', 'canonical', 'path', 'to', 'the', 'log', 'file', '""', '+', 'ioe', '.', 'getMessage', '(', ')', ')', ';']",0
"['return', 'logFileName', ';']",0
"['}', 'else', '{']",1
"['throw', 'new', 'AssertionError', '(', '""', 'Need', 'write', 'permission', 'in', 'the', 'directory', ':', '""', '+', 'logFile', '+', '""', 'to', 'create', 'log', 'file', '.', '""', ')', ';']",0
"['}', '/', '/', 'end', 'if', 'logFile', '!', '=', 'null', 'else', 'is', 'the', 'default', 'in', 'fall', 'through']",0
"['}', '/', '/', 'end', 'else', 'part', 'of', 'logFile', '.', 'exists', '(', ')']",0
"['}', '/', '/', 'end', 'else', 'part', 'of', 'logFile', '.', 'isDirectory', '(', ')']",0
"['}', '/', '/', 'end', 'if', 'logFileName', '!', '=', 'null']",0
"['/', '/', 'file', 'name', 'is', 'null', 'or', 'its', 'in', 'the', 'current', 'working', 'directory']",0
"['/', '/', 'revert', 'to', 'the', 'current', 'working', 'directory']",0
"['String', 'currDir', '=', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'dir', '""', ')', ';']",0
"['logFile', '=', 'new', 'File', '(', 'currDir', ')', ';']",0
"['logFileName', '=', 'currDir', '+', 'File', '.', 'separator', '+', '(', 'logFileName', '=', '=', 'null', '?', 'defaultLogFileName', ':', 'logFileName', ')', ';']",0
"['if', '(', 'logFile', '.', 'canWrite', '(', ')', ')', '{']",0
"['return', 'logFileName', ';']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'Cannot', 'write', 'to', 'log', 'file', ':', '""', '+', 'logFileName', ')', ';']",0
"['private', 'static', 'String', 'getFileFromCanonicalPath', '(', 'String', 'canonicalPath', ')', '{']",0
"['return', 'canonicalPath', '.', 'substring', '(', 'canonicalPath', '.', 'lastIndexOf', '(', 'File', '.', 'separator', ')', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'data', ';']",0
"['import', 'java', '.', 'io', '.', 'DataInput', ';']",0
"['import', 'java', '.', 'io', '.', 'DataOutput', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'util', '.', 'HashMap', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['/', '*', '*']",0
"['public', 'class', 'DataReaderWriter', '{']",0
"['private', 'static', 'TupleFactory', 'mTupleFactory', '=', 'TupleFactory', '.', 'getInstance', '(', ')', ';']",0
"['private', 'static', 'BagFactory', 'mBagFactory', '=', 'BagFactory', '.', 'getInstance', '(', ')', ';']",0
"['static', 'final', 'int', 'UNSIGNED_SHORT_MAX', '=', '65535', ';']",0
"['static', 'final', 'String', 'UTF8', '=', '""', 'UTF', '-', '8', '""', ';']",0
"['public', 'static', 'Tuple', 'bytesToTuple', '(', 'DataInput', 'in', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'Don', ""'"", 't', 'use', 'Tuple', '.', 'readFields', ',', 'because', 'it', 'requires', 'you', 'to']",1
"['/', '/', 'create', 'a', 'tuple', 'with', 'no', 'size', 'and', 'then', 'append', 'fields', '.']",1
"['/', '/', 'That', ""'"", 's', 'less', 'efficient', 'than', 'allocating', 'the', 'tuple', 'size', 'up']",1
"['/', '/', 'front', 'and', 'then', 'filling', 'in', 'the', 'spaces', '.']",1
"['/', '/', 'Read', 'the', 'size', '.']",1
"['int', 'sz', '=', 'in', '.', 'readInt', '(', ')', ';']",1
"['/', '/', 'if', 'sz', '=', '=', '0', ',', 'we', 'construct', 'an', '""', 'empty', '""', 'tuple', '-']",1
"['/', '/', 'presumably', 'the', 'writer', 'wrote', 'an', 'empty', 'tuple', '!']",1
"['if', '(', 'sz', '<', '0', ')', '{']",1
"['throw', 'new', 'IOException', '(', '""', 'Invalid', 'size', '""', '+', 'sz', '+', '""', 'for', 'a', 'tuple', '""', ')', ';']",0
"['Tuple', 't', '=', 'mTupleFactory', '.', 'newTuple', '(', 'sz', ')', ';']",1
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'sz', ';', 'i', '+', '+', ')', '{']",1
"['t', '.', 'set', '(', 'i', ',', 'readDatum', '(', 'in', ')', ')', ';']",1
"['return', 't', ';']",1
"['public', 'static', 'DataBag', 'bytesToBag', '(', 'DataInput', 'in', ')', 'throws', 'IOException', '{']",0
"['DataBag', 'bag', '=', 'mBagFactory', '.', 'newDefaultBag', '(', ')', ';']",1
"['bag', '.', 'readFields', '(', 'in', ')', ';']",1
"['return', 'bag', ';']",1
"['public', 'static', 'Map', '<', 'Object', ',', 'Object', '>', 'bytesToMap', '(', 'DataInput', 'in', ')', 'throws', 'IOException', '{']",0
"['int', 'size', '=', 'in', '.', 'readInt', '(', ')', ';']",1
"['Map', '<', 'Object', ',', 'Object', '>', 'm', '=', 'new', 'HashMap', '<', 'Object', ',', 'Object', '>', '(', 'size', ')', ';']",1
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'size', ';', 'i', '+', '+', ')', '{']",1
"['Object', 'key', '=', 'readDatum', '(', 'in', ')', ';']",1
"['m', '.', 'put', '(', 'key', ',', 'readDatum', '(', 'in', ')', ')', ';']",1
"['return', 'm', ';']",1
"['public', 'static', 'String', 'bytesToCharArray', '(', 'DataInput', 'in', ')', 'throws', 'IOException', '{']",0
"['int', 'size', '=', 'in', '.', 'readUnsignedShort', '(', ')', ';']",1
"['byte', '[', ']', 'ba', '=', 'new', 'byte', '[', 'size', ']', ';']",1
"['in', '.', 'readFully', '(', 'ba', ')', ';']",1
"['return', 'new', 'String', '(', 'ba', ',', 'DataReaderWriter', '.', 'UTF8', ')', ';']",1
"['public', 'static', 'String', 'bytesToBigCharArray', '(', 'DataInput', 'in', ')', 'throws', 'IOException', '{']",0
"['int', 'size', '=', 'in', '.', 'readInt', '(', ')', ';']",1
"['byte', '[', ']', 'ba', '=', 'new', 'byte', '[', 'size', ']', ';']",1
"['in', '.', 'readFully', '(', 'ba', ')', ';']",1
"['return', 'new', 'String', '(', 'ba', ',', 'DataReaderWriter', '.', 'UTF8', ')', ';']",1
"['public', 'static', 'Object', 'readDatum', '(', 'DataInput', 'in', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Read', 'the', 'data', 'type']",0
"['byte', 'b', '=', 'in', '.', 'readByte', '(', ')', ';']",0
"['switch', '(', 'b', ')', '{']",0
"['case', 'DataType', '.', 'TUPLE', ':']",0
"['return', 'bytesToTuple', '(', 'in', ')', ';']",0
"['case', 'DataType', '.', 'BAG', ':']",0
"['return', 'bytesToBag', '(', 'in', ')', ';']",0
"['case', 'DataType', '.', 'MAP', ':']",0
"['return', 'bytesToMap', '(', 'in', ')', ';']",0
"['case', 'DataType', '.', 'INTEGER', ':']",0
"['return', 'new', 'Integer', '(', 'in', '.', 'readInt', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'LONG', ':']",0
"['return', 'new', 'Long', '(', 'in', '.', 'readLong', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'FLOAT', ':']",0
"['return', 'new', 'Float', '(', 'in', '.', 'readFloat', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'DOUBLE', ':']",0
"['return', 'new', 'Double', '(', 'in', '.', 'readDouble', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'BOOLEAN', ':']",0
"['return', 'new', 'Boolean', '(', 'in', '.', 'readBoolean', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'BYTE', ':']",0
"['return', 'new', 'Byte', '(', 'in', '.', 'readByte', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'BYTEARRAY', ':', '{']",0
"['int', 'size', '=', 'in', '.', 'readInt', '(', ')', ';']",1
"['byte', '[', ']', 'ba', '=', 'new', 'byte', '[', 'size', ']', ';']",1
"['in', '.', 'readFully', '(', 'ba', ')', ';']",1
"['return', 'new', 'DataByteArray', '(', 'ba', ')', ';']",0
"['case', 'DataType', '.', 'BIGCHARARRAY', ':']",0
"['return', 'bytesToBigCharArray', '(', 'in', ')', ';']",0
"['case', 'DataType', '.', 'CHARARRAY', ':']",0
"['return', 'bytesToCharArray', '(', 'in', ')', ';']",0
"['case', 'DataType', '.', 'NULL', ':']",0
"['return', 'null', ';']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'Unexpected', 'data', 'type', '""', '+', 'b', '+']",0
"['""', 'found', 'in', 'stream', '.', '""', ')', ';']",0
"['public', 'static', 'void', 'writeDatum', '(']",0
"['DataOutput', 'out', ',']",0
"['Object', 'val', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'Read', 'the', 'data', 'type']",0
"['byte', 'type', '=', 'DataType', '.', 'findType', '(', 'val', ')', ';']",0
"['switch', '(', 'type', ')', '{']",0
"['case', 'DataType', '.', 'TUPLE', ':']",0
"['/', '/', 'Because', 'tuples', 'are', 'written', 'directly', 'by', 'hadoop', ',', 'the']",0
"['/', '/', 'tuple', ""'"", 's', 'write', 'method', 'needs', 'to', 'write', 'the', 'indicator', 'byte', '.']",0
"['/', '/', 'So', 'don', ""'"", 't', 'write', 'the', 'indicator', 'byte', 'here', 'as', 'it', 'is', 'for']",0
"['/', '/', 'everyone', 'else', '.']",0
"['(', '(', 'Tuple', ')', 'val', ')', '.', 'write', '(', 'out', ')', ';']",0
"['case', 'DataType', '.', 'BAG', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'BAG', ')', ';']",0
"['(', '(', 'DataBag', ')', 'val', ')', '.', 'write', '(', 'out', ')', ';']",0
"['case', 'DataType', '.', 'MAP', ':', '{']",1
"['out', '.', 'writeByte', '(', 'DataType', '.', 'MAP', ')', ';']",0
"['Map', '<', 'Object', ',', 'Object', '>', 'm', '=', '(', 'Map', '<', 'Object', ',', 'Object', '>', ')', 'val', ';']",0
"['out', '.', 'writeInt', '(', 'm', '.', 'size', '(', ')', ')', ';']",0
"['Iterator', '<', 'Map', '.', 'Entry', '<', 'Object', ',', 'Object', '>', '>', 'i', '=']",0
"['m', '.', 'entrySet', '(', ')', '.', 'iterator', '(', ')', ';']",0
"['while', '(', 'i', '.', 'hasNext', '(', ')', ')', '{']",0
"['Map', '.', 'Entry', '<', 'Object', ',', 'Object', '>', 'entry', '=', 'i', '.', 'next', '(', ')', ';']",0
"['writeDatum', '(', 'out', ',', 'entry', '.', 'getKey', '(', ')', ')', ';']",0
"['writeDatum', '(', 'out', ',', 'entry', '.', 'getValue', '(', ')', ')', ';']",0
"['case', 'DataType', '.', 'INTEGER', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'INTEGER', ')', ';']",0
"['out', '.', 'writeInt', '(', '(', 'Integer', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'LONG', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'LONG', ')', ';']",0
"['out', '.', 'writeLong', '(', '(', 'Long', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'FLOAT', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'FLOAT', ')', ';']",0
"['out', '.', 'writeFloat', '(', '(', 'Float', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'DOUBLE', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'DOUBLE', ')', ';']",0
"['out', '.', 'writeDouble', '(', '(', 'Double', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'BOOLEAN', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'BOOLEAN', ')', ';']",0
"['out', '.', 'writeBoolean', '(', '(', 'Boolean', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'BYTE', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'BYTE', ')', ';']",0
"['out', '.', 'writeByte', '(', '(', 'Byte', ')', 'val', ')', ';']",0
"['case', 'DataType', '.', 'BYTEARRAY', ':', '{']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'BYTEARRAY', ')', ';']",0
"['DataByteArray', 'bytes', '=', '(', 'DataByteArray', ')', 'val', ';']",0
"['out', '.', 'writeInt', '(', 'bytes', '.', 'size', '(', ')', ')', ';']",0
"['out', '.', 'write', '(', 'bytes', '.', 'mData', ')', ';']",0
"['case', 'DataType', '.', 'CHARARRAY', ':', '{']",1
"['String', 's', '=', '(', 'String', ')', 'val', ';']",0
"['byte', '[', ']', 'utfBytes', '=', 's', '.', 'getBytes', '(', 'DataReaderWriter', '.', 'UTF8', ')', ';']",0
"['int', 'length', '=', 'utfBytes', '.', 'length', ';']",0
"['if', '(', 'length', '<', 'DataReaderWriter', '.', 'UNSIGNED_SHORT_MAX', ')', '{']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'CHARARRAY', ')', ';']",0
"['out', '.', 'writeShort', '(', 'length', ')', ';']",0
"['out', '.', 'write', '(', 'utfBytes', ')', ';']",0
"['}', 'else', '{']",1
"['out', '.', 'writeByte', '(', 'DataType', '.', 'BIGCHARARRAY', ')', ';']",0
"['out', '.', 'writeInt', '(', 'length', ')', ';']",0
"['out', '.', 'write', '(', 'utfBytes', ')', ';']",0
"['case', 'DataType', '.', 'NULL', ':']",0
"['out', '.', 'writeByte', '(', 'DataType', '.', 'NULL', ')', ';']",0
"['throw', 'new', 'RuntimeException', '(', '""', 'Unexpected', 'data', 'type', '""', '+', 'type', '+']",0
"['""', 'found', 'in', 'stream', '.', '""', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'util', '.', 'HashMap', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'List', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'conf', '.', 'Configuration', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'Counters', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobClient', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobID', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'RunningJob', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'jobcontrol', '.', 'Job', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'jobcontrol', '.', 'JobControl', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigWarning', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'datastorage', '.', 'ConfigurationUtil', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'HExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'MRCompiler', '.', 'LastInputStreamingOptimizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'plans', '.', 'MROperPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'plans', '.', 'MRPrinter', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'plans', '.', 'MRStreamHandler', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'plans', '.', 'POPackageAnnotator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'plans', '.', 'PhysicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'relationalOperators', '.', 'POJoinPackage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'CompilationMessageCollector', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'PlanException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'VisitorException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'CompilationMessageCollector', '.', 'Message', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'CompilationMessageCollector', '.', 'MessageType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'ConfigurationValidator', ';']",0
"['/', '*', '*']",0
"['public', 'class', 'MapReduceLauncher', 'extends', 'Launcher', '{']",0
"['private', 'static', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'MapReduceLauncher', '.', 'class', ')', ';']",0
"['/', '/', 'used', 'to', 'track', 'the', 'exception', 'thrown', 'by', 'the', 'job', 'control', 'which', 'is', 'run', 'in', 'a', 'separate', 'thread']",0
"['private', 'Exception', 'jobControlException', '=', 'null', ';']",0
"['private', 'boolean', 'aggregateWarning', '=', 'false', ';']",0
"['public', 'boolean', 'launchPig', '(', 'PhysicalPlan', 'php', ',']",0
"['String', 'grpName', ',']",0
"['PigContext', 'pc', ')', 'throws', 'PlanException', ',']",0
"['long', 'sleepTime', '=', '5000', ';']",0
"['aggregateWarning', '=', '""', 'true', '""', '.', 'equalsIgnoreCase', '(', 'pc', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'aggregate', '.', 'warning', '""', ')', ')', ';']",0
"['MROperPlan', 'mrp', '=', 'compile', '(', 'php', ',', 'pc', ')', ';']",0
"['ExecutionEngine', 'exe', '=', 'pc', '.', 'getExecutionEngine', '(', ')', ';']",0
"['ConfigurationValidator', '.', 'validatePigProperties', '(', 'exe', '.', 'getConfiguration', '(', ')', ')', ';']",0
"['Configuration', 'conf', '=', 'ConfigurationUtil', '.', 'toConfiguration', '(', 'exe', '.', 'getConfiguration', '(', ')', ')', ';']",0
"['JobClient', 'jobClient', '=', '(', '(', 'HExecutionEngine', ')', 'exe', ')', '.', 'getJobClient', '(', ')', ';']",0
"['JobControlCompiler', 'jcc', '=', 'new', 'JobControlCompiler', '(', ')', ';']",0
"['JobControl', 'jc', '=', 'jcc', '.', 'compile', '(', 'mrp', ',', 'grpName', ',', 'conf', ',', 'pc', ')', ';']",0
"['int', 'numMRJobs', '=', 'jc', '.', 'getWaitingJobs', '(', ')', '.', 'size', '(', ')', ';']",0
"['/', '/', 'create', 'the', 'exception', 'handler', 'for', 'the', 'job', 'control', 'thread']",0
"['/', '/', 'and', 'register', 'the', 'handler', 'with', 'the', 'job', 'control', 'thread']",0
"['JobControlThreadExceptionHandler', 'jctExceptionHandler', '=', 'new', 'JobControlThreadExceptionHandler', '(', ')', ';']",0
"['Thread', 'jcThread', '=', 'new', 'Thread', '(', 'jc', ')', ';']",0
"['jcThread', '.', 'setUncaughtExceptionHandler', '(', 'jctExceptionHandler', ')', ';']",0
"['jcThread', '.', 'start', '(', ')', ';']",0
"['double', 'lastProg', '=', '-', '1', ';']",0
"['int', 'perCom', '=', '0', ';']",0
"['while', '(', '!', 'jc', '.', 'allFinished', '(', ')', ')', '{']",0
"['Thread', '.', 'sleep', '(', 'sleepTime', ')', ';']",0
"['}', 'catch', '(', 'InterruptedException', 'e', ')', '{', '}']",0
"['double', 'prog', '=', 'calculateProgress', '(', 'jc', ',', 'jobClient', ')', '/', 'numMRJobs', ';']",0
"['if', '(', 'prog', '>', '=', '(', 'lastProg', '+', '0', '.', '01', ')', ')', '{']",0
"['perCom', '=', '(', 'int', ')', '(', 'prog', '*', '100', ')', ';']",0
"['if', '(', 'perCom', '!', '=', '100', ')']",0
"['log', '.', 'info', '(', 'perCom', '+', '""', '%', 'complete', '""', ')', ';']",0
"['lastProg', '=', 'prog', ';']",0
"['/', '/', 'check', 'for', 'the', 'jobControlException', 'first']",0
"['/', '/', 'if', 'the', 'job', 'controller', 'fails', 'before', 'launching', 'the', 'jobs', 'then', 'there', 'are']",0
"['/', '/', 'no', 'jobs', 'to', 'check', 'for', 'failure']",0
"['if', '(', 'jobControlException', '!', '=', 'null', ')', '{']",0
"['if', '(', 'jobControlException', 'instanceof', 'PigException', ')', '{']",0
"['throw', 'jobControlException', ';']",0
"['}', 'else', '{']",0
"['int', 'errCode', '=', '2117', ';']",0
"['String', 'msg', '=', '""', 'Unexpected', 'error', 'when', 'launching', 'map', 'reduce', 'job', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'jobControlException', ')', ';']",0
"['/', '/', 'Look', 'to', 'see', 'if', 'any', 'jobs', 'failed', '.', 'If', 'so', ',', 'we', 'need', 'to', 'report', 'that', '.']",0
"['List', '<', 'Job', '>', 'failedJobs', '=', 'jc', '.', 'getFailedJobs', '(', ')', ';']",0
"['if', '(', 'failedJobs', '!', '=', 'null', '&', '&', 'failedJobs', '.', 'size', '(', ')', '>', '0', ')', '{']",0
"['log', '.', 'error', '(', '""', 'Map', 'reduce', 'job', 'failed', '""', ')', ';']",0
"['for', '(', 'Job', 'fj', ':', 'failedJobs', ')', '{']",0
"['getStats', '(', 'fj', ',', 'jobClient', ',', 'true', ',', 'pc', ')', ';']",0
"['jc', '.', 'stop', '(', ')', ';']",0
"['return', 'false', ';']",0
"['Map', '<', 'Enum', ',', 'Long', '>', 'warningAggMap', '=', 'new', 'HashMap', '<', 'Enum', ',', 'Long', '>', '(', ')', ';']",0
"['List', '<', 'Job', '>', 'succJobs', '=', 'jc', '.', 'getSuccessfulJobs', '(', ')', ';']",0
"['if', '(', 'succJobs', '!', '=', 'null', ')']",0
"['for', '(', 'Job', 'job', ':', 'succJobs', ')', '{']",0
"['getStats', '(', 'job', ',', 'jobClient', ',', 'false', ',', 'pc', ')', ';']",0
"['if', '(', 'aggregateWarning', ')', '{']",0
"['computeWarningAggregate', '(', 'job', ',', 'jobClient', ',', 'warningAggMap', ')', ';']",0
"['jc', '.', 'stop', '(', ')', ';']",0
"['if', '(', 'aggregateWarning', ')', '{']",0
"['CompilationMessageCollector', '.', 'logAggregate', '(', 'warningAggMap', ',', 'MessageType', '.', 'Warning', ',', 'log', ')', ';']",0
"['log', '.', 'info', '(', '""', '100', '%', 'complete', '""', ')', ';']",0
"['log', '.', 'info', '(', '""', 'Success', '!', '""', ')', ';']",0
"['return', 'true', ';']",0
"['public', 'void', 'explain', '(']",0
"['PhysicalPlan', 'php', ',']",0
"['PigContext', 'pc', ',']",0
"['PrintStream', 'ps', ')', 'throws', 'PlanException', ',', 'VisitorException', ',']",0
"['log', '.', 'trace', '(', '""', 'Entering', 'MapReduceLauncher', '.', 'explain', '""', ')', ';']",0
"['MROperPlan', 'mrp', '=', 'compile', '(', 'php', ',', 'pc', ')', ';']",0
"['MRPrinter', 'printer', '=', 'new', 'MRPrinter', '(', 'ps', ',', 'mrp', ')', ';']",0
"['printer', '.', 'visit', '(', ')', ';']",0
"['private', 'MROperPlan', 'compile', '(']",0
"['PhysicalPlan', 'php', ',']",0
"['PigContext', 'pc', ')', 'throws', 'PlanException', ',', 'IOException', ',', 'VisitorException', '{']",0
"['MRCompiler', 'comp', '=', 'new', 'MRCompiler', '(', 'php', ',', 'pc', ')', ';']",0
"['comp', '.', 'randomizeFileLocalizer', '(', ')', ';']",0
"['comp', '.', 'compile', '(', ')', ';']",0
"['MROperPlan', 'plan', '=', 'comp', '.', 'getMRPlan', '(', ')', ';']",0
"['/', '/', 'display', 'the', 'warning', 'message', '(', 's', ')', 'from', 'the', 'MRCompiler']",0
"['comp', '.', 'getMessageCollector', '(', ')', '.', 'logMessages', '(', 'MessageType', '.', 'Warning', ',', 'aggregateWarning', ',', 'log', ')', ';']",0
"['String', 'lastInputChunkSize', '=']",0
"['pc', '.', 'getProperties', '(', ')', '.', 'getProperty', '(']",0
"['""', 'last', '.', 'input', '.', 'chunksize', '""', ',', 'POJoinPackage', '.', 'DEFAULT_CHUNK_SIZE', ')', ';']",0
"['String', 'prop', '=', 'System', '.', 'getProperty', '(', '""', 'pig', '.', 'exec', '.', 'nocombiner', '""', ')', ';']",0
"['if', '(', '!', '(', '""', 'true', '""', '.', 'equals', '(', 'prop', ')', ')', ')', '{']",0
"['CombinerOptimizer', 'co', '=', 'new', 'CombinerOptimizer', '(', 'plan', ',', 'lastInputChunkSize', ')', ';']",0
"['co', '.', 'visit', '(', ')', ';']",0
"['/', '/', 'display', 'the', 'warning', 'message', '(', 's', ')', 'from', 'the', 'CombinerOptimizer']",0
"['co', '.', 'getMessageCollector', '(', ')', '.', 'logMessages', '(', 'MessageType', '.', 'Warning', ',', 'aggregateWarning', ',', 'log', ')', ';']",0
"['/', '/', 'optimize', 'key', '-', 'value', 'handling', 'in', 'package']",0
"['POPackageAnnotator', 'pkgAnnotator', '=', 'new', 'POPackageAnnotator', '(', 'plan', ')', ';']",0
"['pkgAnnotator', '.', 'visit', '(', ')', ';']",0
"['/', '/', 'check', 'whether', 'stream', 'operator', 'is', 'present']",0
"['MRStreamHandler', 'checker', '=', 'new', 'MRStreamHandler', '(', 'plan', ')', ';']",0
"['checker', '.', 'visit', '(', ')', ';']",0
"['/', '/', 'optimize', 'joins']",0
"['LastInputStreamingOptimizer', 'liso', '=']",0
"['new', 'MRCompiler', '.', 'LastInputStreamingOptimizer', '(', 'plan', ',', 'lastInputChunkSize', ')', ';']",0
"['liso', '.', 'visit', '(', ')', ';']",0
"['/', '/', 'figure', 'out', 'the', 'type', 'of', 'the', 'key', 'for', 'the', 'map', 'plan']",0
"['/', '/', 'this', 'is', 'needed', 'when', 'the', 'key', 'is', 'null', 'to', 'create']",0
"['/', '/', 'an', 'appropriate', 'NullableXXXWritable', 'object']",0
"['KeyTypeDiscoveryVisitor', 'kdv', '=', 'new', 'KeyTypeDiscoveryVisitor', '(', 'plan', ')', ';']",0
"['kdv', '.', 'visit', '(', ')', ';']",0
"['return', 'plan', ';']",0
"['/', '*', '*']",0
"['class', 'JobControlThreadExceptionHandler', 'implements', 'Thread', '.', 'UncaughtExceptionHandler', '{']",0
"['public', 'void', 'uncaughtException', '(', 'Thread', 'thread', ',', 'Throwable', 'throwable', ')', '{']",0
"['ByteArrayOutputStream', 'baos', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",0
"['PrintStream', 'ps', '=', 'new', 'PrintStream', '(', 'baos', ')', ';']",0
"['throwable', '.', 'printStackTrace', '(', 'ps', ')', ';']",0
"['String', 'exceptionString', '=', 'baos', '.', 'toString', '(', ')', ';']",0
"['jobControlException', '=', 'getExceptionFromString', '(', 'exceptionString', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['String', 'errMsg', '=', '""', 'Could', 'not', 'resolve', 'error', 'that', 'occured', 'when', 'launching', 'map', 'reduce', 'job', '.', '""', ';']",0
"['jobControlException', '=', 'new', 'RuntimeException', '(', 'errMsg', ',', 'e', ')', ';']",0
"['void', 'computeWarningAggregate', '(', 'Job', 'job', ',', 'JobClient', 'jobClient', ',', 'Map', '<', 'Enum', ',', 'Long', '>', 'aggMap', ')', '{']",0
"['JobID', 'mapRedJobID', '=', 'job', '.', 'getAssignedJobID', '(', ')', ';']",0
"['RunningJob', 'runningJob', '=', 'null', ';']",0
"['runningJob', '=', 'jobClient', '.', 'getJob', '(', 'mapRedJobID', ')', ';']",0
"['if', '(', 'runningJob', '!', '=', 'null', ')', '{']",0
"['Counters', 'counters', '=', 'runningJob', '.', 'getCounters', '(', ')', ';']",0
"['for', '(', 'Enum', 'e', ':', 'PigWarning', '.', 'values', '(', ')', ')', '{']",1
"['Long', 'currentCount', '=', 'aggMap', '.', 'get', '(', 'e', ')', ';']",1
"['currentCount', '=', '(', 'currentCount', '=', '=', 'null', '?', '0', ':', 'currentCount', ')', ';']",1
"['currentCount', '+', '=', 'counters', '.', 'getCounter', '(', 'e', ')', ';']",1
"['aggMap', '.', 'put', '(', 'e', ',', 'currentCount', ')', ';']",1
"['}', 'catch', '(', 'IOException', 'ioe', ')', '{']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'retrieve', 'job', 'to', 'compute', 'warning', 'aggregation', '.', '""', ';']",0
"['log', '.', 'warn', '(', 'msg', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'test', ';']",0
"['import', 'java', '.', 'io', '.', 'File', ';']",0
"['import', 'java', '.', 'io', '.', 'FileOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'util', '.', 'ArrayList', ';']",0
"['import', 'java', '.', 'util', '.', 'Arrays', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'List', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'EvalFunc', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ExecType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'FuncSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataByteArray', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'FrontendException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'schema', '.', 'Schema', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'VisitorException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'org', '.', 'junit', '.', 'After', ';']",0
"['import', 'org', '.', 'junit', '.', 'Before', ';']",0
"['import', 'org', '.', 'junit', '.', 'Test', ';']",0
"['import', 'com', '.', 'sun', '.', 'org', '.', 'apache', '.', 'bcel', '.', 'internal', '.', 'ExceptionConstants', ';']",0
"['import', 'com', '.', 'sun', '.', 'org', '.', 'apache', '.', 'xerces', '.', 'internal', '.', 'impl', '.', 'xpath', '.', 'regex', '.', 'ParseException', ';']",0
"['import', 'junit', '.', 'framework', '.', 'TestCase', ';']",0
"['public', 'class', 'TestBestFitCast', 'extends', 'TestCase', '{']",0
"['private', 'PigServer', 'pigServer', ';']",0
"['private', 'MiniCluster', 'cluster', '=', 'MiniCluster', '.', 'buildCluster', '(', ')', ';']",0
"['private', 'File', 'tmpFile', ',', 'tmpFile2', ';']",0
"['int', 'LOOP_SIZE', '=', '20', ';']",0
"['public', 'TestBestFitCast', '(', ')', 'throws', 'ExecException', ',', 'IOException', '{']",0
"['pigServer', '=', 'new', 'PigServer', '(', 'ExecType', '.', 'MAPREDUCE', ',', 'cluster', '.', 'getProperties', '(', ')', ')', ';']",0
"['/', '/', 'pigServer', '=', 'new', 'PigServer', '(', 'ExecType', '.', 'LOCAL', ')', ';']",0
"['tmpFile', '=', 'File', '.', 'createTempFile', '(', '""', 'test', '""', ',', '""', 'txt', '""', ')', ';']",0
"['PrintStream', 'ps', '=', 'new', 'PrintStream', '(', 'new', 'FileOutputStream', '(', 'tmpFile', ')', ')', ';']",0
"['long', 'l', '=', '0', ';']",0
"['for', '(', 'int', 'i', '=', '1', ';', 'i', '<', '=', 'LOOP_SIZE', ';', 'i', '+', '+', ')', '{']",0
"['ps', '.', 'println', '(', 'l', '+', '""', '\\', 't', '""', '+', 'i', ')', ';']",0
"['ps', '.', 'close', '(', ')', ';']",0
"['tmpFile2', '=', 'File', '.', 'createTempFile', '(', '""', 'test2', '""', ',', '""', 'txt', '""', ')', ';']",0
"['ps', '=', 'new', 'PrintStream', '(', 'new', 'FileOutputStream', '(', 'tmpFile2', ')', ')', ';']",0
"['l', '=', '0', ';']",0
"['for', '(', 'int', 'i', '=', '1', ';', 'i', '<', '=', 'LOOP_SIZE', ';', 'i', '+', '+', ')', '{']",0
"['ps', '.', 'println', '(', 'l', '+', '""', '\\', 't', '""', '+', 'i', '+', '""', '\\', 't', '""', '+', 'i', ')', ';']",0
"['ps', '.', 'close', '(', ')', ';']",0
"['public', 'void', 'setUp', '(', ')', 'throws', 'Exception', '{']",0
"['public', 'void', 'tearDown', '(', ')', 'throws', 'Exception', '{']",0
"['public', 'static', 'class', 'UDF1', 'extends', 'EvalFunc', '<', 'Tuple', '>', '{']",0
"['/', '*', '*']",0
"['public', 'Tuple', 'exec', '(', 'Tuple', 'input', ')', 'throws', 'IOException', '{']",0
"['return', 'input', ';']",0
"['/', '*', '(', 'non', '-', 'Javadoc', ')']",0
"['public', 'List', '<', 'FuncSpec', '>', 'getArgToFuncMapping', '(', ')', 'throws', 'FrontendException', '{']",0
"['List', '<', 'FuncSpec', '>', 'funcList', '=', 'new', 'ArrayList', '<', 'FuncSpec', '>', '(', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ',', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'LONG', ')', ',', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'DOUBLE', ')', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'INTEGER', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'DOUBLE', ')', ')', ')', ')', ';']",0
"['/', '*', 'funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'DoubleMax', '.', 'class', '.', 'getName', '(', ')', ',', 'Schema', '.', 'generateNestedSchema', '(', 'DataType', '.', 'BAG', ',', 'DataType', '.', 'DOUBLE', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'FloatMax', '.', 'class', '.', 'getName', '(', ')', ',', 'Schema', '.', 'generateNestedSchema', '(', 'DataType', '.', 'BAG', ',', 'DataType', '.', 'FLOAT', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'IntMax', '.', 'class', '.', 'getName', '(', ')', ',', 'Schema', '.', 'generateNestedSchema', '(', 'DataType', '.', 'BAG', ',', 'DataType', '.', 'INTEGER', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'LongMax', '.', 'class', '.', 'getName', '(', ')', ',', 'Schema', '.', 'generateNestedSchema', '(', 'DataType', '.', 'BAG', ',', 'DataType', '.', 'LONG', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'StringMax', '.', 'class', '.', 'getName', '(', ')', ',', 'Schema', '.', 'generateNestedSchema', '(', 'DataType', '.', 'BAG', ',', 'DataType', '.', 'CHARARRAY', ')', ')', ')', ';', '*', '/']",0
"['return', 'funcList', ';']",0
"['public', 'static', 'class', 'UDF2', 'extends', 'EvalFunc', '<', 'String', '>', '{']",0
"['/', '*', '*']",0
"['public', 'String', 'exec', '(', 'Tuple', 'input', ')', 'throws', 'IOException', '{']",0
"['String', 'str', '=', '(', 'String', ')', 'input', '.', 'get', '(', '0', ')', ';']",0
"['return', 'str', '.', 'toUpperCase', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['return', 'null', ';']",0
"['/', '*', '(', 'non', '-', 'Javadoc', ')']",0
"['public', 'List', '<', 'FuncSpec', '>', 'getArgToFuncMapping', '(', ')', 'throws', 'FrontendException', '{']",0
"['List', '<', 'FuncSpec', '>', 'funcList', '=', 'new', 'ArrayList', '<', 'FuncSpec', '>', '(', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',', 'new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'CHARARRAY', ')', ')', ')', ')', ';']",0
"['return', 'funcList', ';']",0
"['/', '*', '*']",0
"['public', 'static', 'class', 'UDF3', 'extends', 'EvalFunc', '<', 'Tuple', '>', '{']",0
"['/', '*', '*']",0
"['public', 'Tuple', 'exec', '(', 'Tuple', 'input', ')', 'throws', 'IOException', '{']",0
"['return', 'input', ';']",0
"['/', '*', '(', 'non', '-', 'Javadoc', ')']",0
"['public', 'List', '<', 'FuncSpec', '>', 'getArgToFuncMapping', '(', ')', 'throws', 'FrontendException', '{']",0
"['List', '<', 'FuncSpec', '>', 'funcList', '=', 'new', 'ArrayList', '<', 'FuncSpec', '>', '(', ')', ';']",0
"['/', '/', 'the', 'following', 'schema', 'should', 'match', 'when', 'the', 'input', 'is']",0
"['/', '/', 'just', 'a', '{', 'bytearray', '}', '-', 'exact', 'match']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'BYTEARRAY', ')', ')', ')', ')', ';']",0
"['/', '/', 'the', 'following', 'schema', 'should', 'match', 'when', 'the', 'input', 'is']",0
"['/', '/', 'just', 'a', '{', 'int', '}', '-', 'exact', 'match']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'INTEGER', ')', ')', ')', ')', ';']",0
"['/', '/', 'The', 'following', 'two', 'schemas', 'will', 'cause', 'conflict', 'when', 'input', 'schema']",0
"['/', '/', 'is', '{', 'float', ',', 'bytearray', '}', 'since', 'bytearray', 'can', 'be', 'casted', 'either', 'to', 'long']",0
"['/', '/', 'or', 'double', '.', 'However', 'when', 'input', 'schema', 'is', '{', 'bytearray', ',', 'int', '}', ',', 'it', 'should', 'work']",0
"['/', '/', 'since', 'bytearray', 'should', 'get', 'casted', 'to', 'float', 'and', 'int', 'to', 'long', '.', 'Likewise', 'if']",0
"['/', '/', 'input', 'schema', 'is', '{', 'bytearray', ',', 'long', '}', 'or', '{', 'bytearray', ',', 'double', '}', 'it', 'should', 'work']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'DOUBLE', ')', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'LONG', ')', ')', ')', ')', ')', ';']",0
"['/', '/', 'The', 'following', 'two', 'schemas', 'will', 'cause', 'conflict', 'when', 'input', 'schema', 'is']",0
"['/', '/', '{', 'bytearray', ',', 'int', ',', 'int', '}', 'since', 'the', 'two', 'ints', 'could', 'be', 'casted', 'to', 'long', ',', 'double']",0
"['/', '/', 'or', 'double', ',', 'long', '.', 'Likewise', 'input', 'schema', 'of', 'either', '{', 'bytearray', ',', 'long', ',', 'long', '}']",0
"['/', '/', 'or', '{', 'bytearray', ',', 'double', ',', 'double', '}', 'would', 'cause', 'conflict', '.', 'Input', 'schema', 'of']",0
"['/', '/', '{', 'bytearray', ',', 'long', ',', 'double', '}', 'or', '{', 'bytearray', ',', 'double', ',', 'long', '}', 'should', 'not', 'cause']",0
"['/', '/', 'conflict', 'since', 'only', 'the', 'bytearray', 'needs', 'to', 'be', 'casted', 'to', 'float', '.', 'Input', 'schema']",0
"['/', '/', 'of', '{', 'float', ',', 'bytearray', ',', 'long', '}', 'or', '{', 'float', ',', 'long', ',', 'bytearray', '}', 'should', 'also']",0
"['/', '/', 'work', 'since', 'only', 'the', 'bytearray', 'needs', 'to', 'be', 'casted', '.', 'Input', 'schema', 'of']",0
"['/', '/', '{', 'float', ',', 'bytearray', ',', 'int', '}', 'will', 'cause', 'conflict', 'since', 'we', 'could', 'cast', 'int', 'to']",0
"['/', '/', 'long', 'or', 'double', 'and', 'bytearray', 'to', 'long', 'or', 'double', '.', 'Input', 'schema', 'of']",0
"['/', '/', '{', 'bytearray', ',', 'long', ',', 'int', '}', 'should', 'work', 'and', 'should', 'match', 'the', 'first', 'schema', 'below', 'for']",0
"['/', '/', 'matching', 'wherein', 'the', 'bytearray', 'is', 'cast', 'to', 'float', 'and', 'the', 'int', 'to', 'double', '.']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'DOUBLE', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'LONG', ')', ')', ')', ')', ')', ';']",0
"['funcList', '.', 'add', '(', 'new', 'FuncSpec', '(', 'this', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ',']",0
"['new', 'Schema', '(', 'Arrays', '.', 'asList', '(', 'new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'FLOAT', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'LONG', ')', ',']",0
"['new', 'Schema', '.', 'FieldSchema', '(', 'null', ',', 'DataType', '.', 'DOUBLE', ')', ')', ')', ')', ')', ';']",0
"['return', 'funcList', ';']",0
"['public', 'void', 'testByteArrayCast1', '(', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'Passing', '(', 'float', ',', 'bytearray', ')']",0
"['/', '/', 'Ambiguous', 'matches', ':', '(', 'float', ',', 'long', ')', ',', '(', 'float', ',', 'double', ')']",0
"['boolean', 'exceptionCaused', '=', 'false', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'float', ',', 'y', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['exceptionCaused', '=', 'true', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Multiple', 'matching', 'functions', '""', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', '{', 'float', ',', 'double', '}', ',', '{', 'float', ',', 'long', '}', '""', ')', ')', ';']",0
"['assertTrue', '(', 'exceptionCaused', ')', ';']",0
"['public', 'void', 'testByteArrayCast2', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ')', ',', '(', 'float', ',', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'long', ')', 'since', 'in', 'both', 'cases', 'bytearray', 'is', 'cast', 'to', 'float', 'and', 'the']",0
"['/', '/', 'cost', 'of', 'casting', 'int', 'to', 'long', '<', 'int', 'to', 'double']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast3', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'long', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ')', ',', '(', 'float', ',', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'long', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'long', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast4', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'double', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ')', ',', '(', 'float', ',', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'double', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast5', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'int', ',', 'int', ')']",0
"['/', '/', 'Ambiguous', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'bytearray', 'can', 'be', 'casted', 'to', 'float', 'but', 'the', 'two', 'ints', 'cannot', 'be', 'unambiguously']",0
"['/', '/', 'casted']",0
"['boolean', 'exceptionCaused', '=', 'false', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['exceptionCaused', '=', 'true', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Multiple', 'matching', 'functions', '""', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', '(', '{', 'float', ',', 'double', ',', 'long', '}', ',', '{', 'float', ',', 'long', ',', 'double', '}', ')', '""', ')', ')', ';']",0
"['assertTrue', '(', 'exceptionCaused', ')', ';']",0
"['public', 'void', 'testByteArrayCast6', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'long', ',', 'long', ')']",0
"['/', '/', 'Ambiguous', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'bytearray', 'can', 'be', 'casted', 'to', 'float', 'but', 'the', 'two', 'longs', 'cannot', 'be']",0
"['/', '/', 'unambiguously', 'casted']",0
"['boolean', 'exceptionCaused', '=', 'false', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'long', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['exceptionCaused', '=', 'true', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Multiple', 'matching', 'functions', '""', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', '(', '{', 'float', ',', 'double', ',', 'long', '}', ',', '{', 'float', ',', 'long', ',', 'double', '}', ')', '""', ')', ')', ';']",0
"['assertTrue', '(', 'exceptionCaused', ')', ';']",0
"['public', 'void', 'testByteArrayCast7', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'double', ',', 'double', ')']",0
"['/', '/', 'Ambiguous', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'bytearray', 'can', 'be', 'casted', 'to', 'float', 'but', 'the', 'two', 'doubles', 'cannot', 'be']",0
"['/', '/', 'casted', 'with', 'a', 'permissible', 'cast']",0
"['boolean', 'exceptionCaused', '=', 'false', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['exceptionCaused', '=', 'true', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Could', 'not', 'infer', 'the', 'matching', 'function', '""', ')', ')', ';']",0
"['assertTrue', '(', 'exceptionCaused', ')', ';']",0
"['public', 'void', 'testByteArrayCast8', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'long', ',', 'double', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'long', ',', 'double', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'long', ',', 'z', ':', 'double', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'z', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast9', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'double', ',', 'long', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'double', ',', 'z', ':', 'long', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'z', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast10', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'float', ',', 'long', ',', 'bytearray', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'long', ',', 'double', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'float', ',', 'y', ':', 'long', ',', 'z', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'z', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast11', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'float', ',', 'bytearray', ',', 'long', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'double', ',', 'long', ')', 'since', 'that', 'is', 'the', 'only', 'exact', 'match', 'without', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'float', ',', 'y', ',', 'z', ':', 'long', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'z', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast12', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'float', ',', 'bytearray', ',', 'int', ')']",0
"['/', '/', 'Ambiguous', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'will', 'cause', 'conflict', 'since', 'we', 'could', 'cast', 'int', 'to']",0
"['/', '/', 'long', 'or', 'double', 'and', 'bytearray', 'to', 'long', 'or', 'double', '.']",0
"['boolean', 'exceptionCaused', '=', 'false', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'float', ',', 'y', ',', 'z', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['exceptionCaused', '=', 'true', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Multiple', 'matching', 'functions', '""', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', '(', '{', 'float', ',', 'double', ',', 'long', '}', ',', '{', 'float', ',', 'long', ',', 'double', '}', '""', ')', ')', ';']",0
"['assertTrue', '(', 'exceptionCaused', ')', ';']",0
"['public', 'void', 'testByteArrayCast13', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ',', 'long', ',', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'long', ',', 'double', ')', ',', '(', 'float', ',', 'double', ',', 'long', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'long', ',', 'double', ')', 'since', 'for', 'the', 'bytearray', 'there', 'is', 'a']",0
"['/', '/', 'single', 'unambiguous', 'cast', 'to', 'float', '.', 'For', 'the', 'other', 'two', 'args', ',', 'it', 'is']",0
"['/', '/', 'less', '""', 'costlier', '""', 'to', 'cast', 'the', 'last', 'int', 'to', 'double', 'than', 'cast', 'the', 'long']",0
"['/', '/', 'to', 'double', 'and', 'int', 'to', 'long']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile2', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'long', ',', 'z', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ',', 'z', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', '(', 'Float', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', ',', '0', '.', '0f', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', '(', 'Long', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', ',', 'new', 'Long', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', '(', 'Double', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '2', ')', ',', 'new', 'Double', '(', 'cnt', '+', '1', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast14', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bag', '{', '(', 'bytearray', ')', '}', ')']",0
"['/', '/', 'Possible', 'matches', ':', 'bag', '{', '(', 'bytearray', ')', '}', ',', 'bag', '{', '(', 'int', ')', '}', ',', 'bag', '{', '(', 'long', ')', '}', ',', 'bag', '{', '(', 'float', ')', '}', ',', 'bag', '{', '(', 'double', ')', '}']",0
"['/', '/', 'Chooses', 'bag', '{', '(', 'bytearray', ')', '}', 'because', 'it', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'group', 'A', 'all', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'C', '=', 'FOREACH', 'B', 'generate', 'SUM', '(', 'A', '.', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'C', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', 't', '.', 'get', '(', '0', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', 'new', 'Double', '(', '210', ')', ',', '(', 'Double', ')', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['public', 'void', 'testByteArrayCast15', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bytearray', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'bytearray', ')', ',', '(', 'int', ')']",0
"['/', '/', 'Chooses', '(', 'bytearray', ')', 'because', 'that', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'DataByteArray', ')', ';']",0
"['byte', '[', ']', 'expected', '=', 'Integer', '.', 'toString', '(', 'cnt', '+', '1', ')', '.', 'getBytes', '(', ')', ';']",0
"['byte', '[', ']', 'actual', '=', '(', '(', 'DataByteArray', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', ')', ';']",0
"['assertEquals', '(', 'expected', '.', 'length', ',', 'actual', '.', 'length', ')', ';']",0
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'expected', '.', 'length', ';', 'i', '+', '+', ')', '{']",0
"['assertEquals', '(', 'expected', '[', 'i', ']', ',', 'actual', '[', 'i', ']', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testByteArrayCast16', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'bytearray', ')', ',', '(', 'int', ')']",0
"['/', '/', 'Chooses', '(', 'int', ')', 'because', 'that', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', '""', '+', 'UDF3', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Integer', ')', ';']",0
"['assertEquals', '(', 'new', 'Integer', '(', 'cnt', '+', '1', ')', ',', '(', 'Integer', ')', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '0', ')', ')', '.', 'get', '(', '0', ')', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', 'LOOP_SIZE', ',', 'cnt', ')', ';']",0
"['public', 'void', 'testIntSum', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bag', '{', '(', 'int', ')', '}', ')']",0
"['/', '/', 'Possible', 'matches', ':', 'bag', '{', '(', 'bytearray', ')', '}', ',', 'bag', '{', '(', 'int', ')', '}', ',', 'bag', '{', '(', 'long', ')', '}', ',', 'bag', '{', '(', 'float', ')', '}', ',', 'bag', '{', '(', 'double', ')', '}']",0
"['/', '/', 'Chooses', 'bag', '{', '(', 'int', ')', '}', 'since', 'it', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'group', 'A', 'all', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'C', '=', 'FOREACH', 'B', 'generate', 'SUM', '(', 'A', '.', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'C', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', 't', '.', 'get', '(', '0', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', 'new', 'Long', '(', '210', ')', ',', '(', 'Long', ')', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['public', 'void', 'testLongSum', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bag', '{', '(', 'long', ')', '}', ')']",0
"['/', '/', 'Possible', 'matches', ':', 'bag', '{', '(', 'bytearray', ')', '}', ',', 'bag', '{', '(', 'int', ')', '}', ',', 'bag', '{', '(', 'long', ')', '}', ',', 'bag', '{', '(', 'float', ')', '}', ',', 'bag', '{', '(', 'double', ')', '}']",0
"['/', '/', 'Chooses', 'bag', '{', '(', 'long', ')', '}', 'since', 'it', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'long', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'group', 'A', 'all', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'C', '=', 'FOREACH', 'B', 'generate', 'SUM', '(', 'A', '.', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'C', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', 't', '.', 'get', '(', '0', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', 'new', 'Long', '(', '210', ')', ',', '(', 'Long', ')', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['public', 'void', 'testFloatSum', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bag', '{', '(', 'float', ')', '}', ')']",0
"['/', '/', 'Possible', 'matches', ':', 'bag', '{', '(', 'bytearray', ')', '}', ',', 'bag', '{', '(', 'int', ')', '}', ',', 'bag', '{', '(', 'long', ')', '}', ',', 'bag', '{', '(', 'float', ')', '}', ',', 'bag', '{', '(', 'double', ')', '}']",0
"['/', '/', 'Chooses', 'bag', '{', '(', 'float', ')', '}', 'since', 'it', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'float', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'group', 'A', 'all', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'C', '=', 'FOREACH', 'B', 'generate', 'SUM', '(', 'A', '.', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'C', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', 't', '.', 'get', '(', '0', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', 'new', 'Double', '(', '210', ')', ',', '(', 'Double', ')', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['public', 'void', 'testDoubleSum', '(', ')', 'throws', 'IOException', ',', 'ExecException', '{']",0
"['/', '/', 'Passing', '(', 'bag', '{', '(', 'double', ')', '}', ')']",0
"['/', '/', 'Possible', 'matches', ':', 'bag', '{', '(', 'bytearray', ')', '}', ',', 'bag', '{', '(', 'int', ')', '}', ',', 'bag', '{', '(', 'long', ')', '}', ',', 'bag', '{', '(', 'float', ')', '}', ',', 'bag', '{', '(', 'double', ')', '}']",0
"['/', '/', 'Chooses', 'bag', '{', '(', 'double', ')', '}', 'since', 'it', 'is', 'an', 'exact', 'match']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ',', 'y', ':', 'double', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'group', 'A', 'all', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'C', '=', 'FOREACH', 'B', 'generate', 'SUM', '(', 'A', '.', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'C', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertTrue', '(', 't', '.', 'get', '(', '0', ')', 'instanceof', 'Double', ')', ';']",0
"['assertEquals', '(', 'new', 'Double', '(', '210', ')', ',', '(', 'Double', ')', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['public', 'void', 'test1', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'Passing', '(', 'long', ',', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'float', ')', ',', '(', 'long', ',', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'long', ',', 'double', ')', 'as', 'it', 'has', 'only', 'one', 'cast', 'compared', 'to', 'two', 'for', '(', 'float', ',', 'float', ')']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'long', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF1', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ',', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertEquals', '(', 'true', ',', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Long', ')', ';']",0
"['assertEquals', '(', 'true', ',', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Double', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', '20', ',', 'cnt', ')', ';']",0
"['public', 'void', 'test2', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'Passing', '(', 'int', ',', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'float', ')', ',', '(', 'long', ',', 'double', ')']",0
"['/', '/', 'Throws', 'Exception', 'as', 'ambiguous', 'definitions', 'found']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'long', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF1', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'y', ',', 'y', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertEquals', '(', 'true', ',', 'msg', '.', 'contains', '(', '""', 'as', 'multiple', 'or', 'none', 'of', 'them', 'fit', '""', ')', ')', ';']",0
"['public', 'void', 'test3', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'Passing', '(', 'int', ',', 'int', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'float', ')', ',', '(', 'long', ',', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'float', ',', 'float', ')', 'as', 'both', 'options', 'lead', 'to', 'same', 'score', 'and', '(', 'float', ',', 'float', ')', 'occurs', 'first', '.']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'long', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF1', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '(', 'float', ')', 'y', ',', '(', 'float', ')', 'y', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertEquals', '(', 'true', ',', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['assertEquals', '(', 'true', ',', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '1', ')', 'instanceof', 'Float', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', '20', ',', 'cnt', ')', ';']",0
"['public', 'void', 'test4', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'Passing', '(', 'long', ')']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ')', ',', '(', 'integer', ')', ',', '(', 'double', ')']",0
"['/', '/', 'Chooses', '(', 'float', ')', 'as', 'it', 'leads', 'to', 'a', 'better', 'score', 'that', 'to', '(', 'double', ')']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", 'as', '(', 'x', ':', 'long', ',', 'y', ':', 'int', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', 'x', ',', '""', '+', 'UDF1', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', 'x', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['int', 'cnt', '=', '0', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertEquals', '(', 'true', ',', '(', '(', 'Tuple', ')', 't', '.', 'get', '(', '1', ')', ')', '.', 'get', '(', '0', ')', 'instanceof', 'Float', ')', ';']",0
"['+', '+', 'cnt', ';']",0
"['assertEquals', '(', '20', ',', 'cnt', ')', ';']",0
"['public', 'void', 'test5', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'Passing', 'bytearrays']",0
"['/', '/', 'Possible', 'matches', ':', '(', 'float', ',', 'float', ')', ',', '(', 'long', ',', 'double', ')']",0
"['/', '/', 'Throws', 'exception', 'since', 'more', 'than', 'one', 'funcSpec', 'and', 'inp', 'is', 'bytearray']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'tmpFile', '.', 'toString', '(', ')', ')', '+', '""', ""'"", ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'generate', '$', '0', ',', '""', '+', 'UDF1', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '1', ',', '$', '1', ')', ';', '""', ')', ';']",0
"['pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertEquals', '(', 'true', ',', 'msg', '.', 'contains', '(', '""', 'Multiple', 'matching', 'functions', '""', ')', ')', ';']",0
"['public', 'void', 'test6', '(', ')', 'throws', 'Exception', '{']",0
"['/', '/', 'test', 'UDF', 'with', 'single', 'mapping', 'function']",0
"['/', '/', 'where', 'bytearray', 'is', 'passed', 'in', 'as', 'input', 'parameter']",0
"['File', 'input', '=', 'Util', '.', 'createInputFile', '(', '""', 'tmp', '""', ',', '""', '""', ',', 'new', 'String', '[', ']', '{', '""', 'abc', '""', '}', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'A', '=', 'LOAD', ""'"", '""', '+', 'Util', '.', 'generateURI', '(', 'input', '.', 'toString', '(', ')', ')', '+', '""', ""'"", ';', '""', ')', ';']",0
"['pigServer', '.', 'registerQuery', '(', '""', 'B', '=', 'FOREACH', 'A', 'GENERATE', '""', '+', 'UDF2', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', '$', '0', ')', ';', '""', ')', ';']",0
"['Iterator', '<', 'Tuple', '>', 'iter', '=', 'pigServer', '.', 'openIterator', '(', '""', 'B', '""', ')', ';']",0
"['if', '(', '!', 'iter', '.', 'hasNext', '(', ')', ')', 'fail', '(', '""', 'No', 'Output', 'received', '""', ')', ';']",0
"['Tuple', 't', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['assertEquals', '(', '""', 'ABC', '""', ',', 't', '.', 'get', '(', '0', ')', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', ';']",0
"['import', 'java', '.', 'io', '.', 'File', ';']",0
"['import', 'java', '.', 'io', '.', 'FileNotFoundException', ';']",0
"['import', 'java', '.', 'io', '.', 'FileReader', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'net', '.', 'URL', ';']",0
"['import', 'java', '.', 'util', '.', 'ArrayList', ';']",0
"['import', 'java', '.', 'util', '.', 'Collection', ';']",0
"['import', 'java', '.', 'util', '.', 'Date', ';']",0
"['import', 'java', '.', 'util', '.', 'Enumeration', ';']",0
"['import', 'java', '.', 'util', '.', 'HashMap', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'List', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'java', '.', 'util', '.', 'Properties', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'ContainerDescriptor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'ElementDescriptor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecJob', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecJob', '.', 'JOB_STATUS', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'BinStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'PigStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataBag', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'io', '.', 'FileLocalizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'FrontendException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LogicalOperator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LogicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LogicalPlanBuilder', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LOPrinter', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'PlanSetter', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'optimizer', '.', 'LogicalOptimizer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'parser', '.', 'ParseException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'parser', '.', 'QueryParser', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'schema', '.', 'Schema', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'validators', '.', 'LogicalPlanValidationExecutor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'plans', '.', 'PhysicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'CompilationMessageCollector', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'OperatorKey', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'CompilationMessageCollector', '.', 'MessageType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'streaming', '.', 'StreamingCommand', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'PropertiesUtil', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LODefine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'logicalLayer', '.', 'LOStore', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'pen', '.', 'ExampleGenerator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', '.', 'GruntParser', ';']",0
"['/', '*', '*']",0
"['public', 'class', 'PigServer', '{']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['public', 'static', 'ExecType', 'parseExecType', '(', 'String', 'str', ')', 'throws', 'IOException', '{']",0
"['String', 'normStr', '=', 'str', '.', 'toLowerCase', '(', ')', ';']",0
"['if', '(', 'normStr', '.', 'equals', '(', '""', 'local', '""', ')', ')', 'return', 'ExecType', '.', 'LOCAL', ';']",0
"['if', '(', 'normStr', '.', 'equals', '(', '""', 'mapreduce', '""', ')', ')', 'return', 'ExecType', '.', 'MAPREDUCE', ';']",0
"['if', '(', 'normStr', '.', 'equals', '(', '""', 'mapred', '""', ')', ')', 'return', 'ExecType', '.', 'MAPREDUCE', ';']",0
"['if', '(', 'normStr', '.', 'equals', '(', '""', 'pig', '""', ')', ')', 'return', 'ExecType', '.', 'PIG', ';']",0
"['if', '(', 'normStr', '.', 'equals', '(', '""', 'pigbody', '""', ')', ')', 'return', 'ExecType', '.', 'PIG', ';']",0
"['int', 'errCode', '=', '2040', ';']",0
"['String', 'msg', '=', '""', 'Unknown', 'exec', 'type', ':', '""', '+', 'str', ';']",0
"['throw', 'new', 'PigException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",0
"['Map', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', 'aliases', '=', 'new', 'HashMap', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', '(', ')', ';']",0
"['Map', '<', 'OperatorKey', ',', 'LogicalOperator', '>', 'opTable', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['Map', '<', 'String', ',', 'LogicalOperator', '>', 'aliasOp', '=', 'new', 'HashMap', '<', 'String', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['PigContext', 'pigContext', ';']",0
"['private', 'String', 'scope', '=', 'constructScope', '(', ')', ';']",0
"['private', 'ArrayList', '<', 'String', '>', 'cachedScript', '=', 'new', 'ArrayList', '<', 'String', '>', '(', ')', ';']",0
"['private', 'boolean', 'aggregateWarning', '=', 'true', ';']",0
"['private', 'String', 'constructScope', '(', ')', '{']",0
"['/', '/', 'scope', 'servers', 'for', 'now', 'as', 'a', 'session', 'id']",0
"['/', '/', 'scope', '=', 'user_id', '+', '""', '-', '""', '+', 'time_stamp', ';']",0
"['String', 'user', '=', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'name', '""', ',', '""', 'DEFAULT_USER_ID', '""', ')', ';']",0
"['String', 'date', '=', '(', 'new', 'Date', '(', ')', ')', '.', 'toString', '(', ')', ';']",0
"['return', 'user', '+', '""', '-', '""', '+', 'date', ';']",0
"['public', 'PigServer', '(', 'String', 'execTypeString', ')', 'throws', 'ExecException', ',', 'IOException', '{']",0
"['this', '(', 'parseExecType', '(', 'execTypeString', ')', ')', ';']",0
"['public', 'PigServer', '(', 'ExecType', 'execType', ')', 'throws', 'ExecException', '{']",0
"['this', '(', 'execType', ',', 'PropertiesUtil', '.', 'loadPropertiesFromFile', '(', ')', ')', ';']",0
"['public', 'PigServer', '(', 'ExecType', 'execType', ',', 'Properties', 'properties', ')', 'throws', 'ExecException', '{']",0
"['this', '(', 'new', 'PigContext', '(', 'execType', ',', 'properties', ')', ',', 'true', ')', ';']",0
"['public', 'PigServer', '(', 'PigContext', 'context', ')', 'throws', 'ExecException', '{']",0
"['this', '(', 'context', ',', 'true', ')', ';']",0
"['public', 'PigServer', '(', 'PigContext', 'context', ',', 'boolean', 'connect', ')', 'throws', 'ExecException', '{']",0
"['this', '.', 'pigContext', '=', 'context', ';']",0
"['if', '(', 'this', '.', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', 'PigContext', '.', 'JOB_NAME', ')', '=', '=', 'null', ')', '{']",0
"['setJobName', '(', '""', 'DefaultJobName', '""', ')', ';']",0
"['aggregateWarning', '=', '""', 'true', '""', '.', 'equalsIgnoreCase', '(', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'aggregate', '.', 'warning', '""', ')', ')', ';']",0
"['if', '(', 'connect', ')', '{']",0
"['pigContext', '.', 'connect', '(', ')', ';']",0
"['public', 'PigContext', 'getPigContext', '(', ')', '{']",0
"['return', 'pigContext', ';']",0
"['public', 'void', 'debugOn', '(', ')', '{']",0
"['pigContext', '.', 'debug', '=', 'true', ';']",0
"['public', 'void', 'debugOff', '(', ')', '{']",0
"['pigContext', '.', 'debug', '=', 'false', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'addPathToSkip', '(', 'String', 'path', ')', '{']",0
"['pigContext', '.', 'addPathToSkip', '(', 'path', ')', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'registerFunction', '(', 'String', 'function', ',', 'String', 'functionSpec', ')', '{']",0
"['registerFunction', '(', 'function', ',', 'new', 'FuncSpec', '(', 'functionSpec', ')', ')', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'registerFunction', '(', 'String', 'function', ',', 'FuncSpec', 'funcSpec', ')', '{']",0
"['pigContext', '.', 'registerFunction', '(', 'function', ',', 'funcSpec', ')', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'registerStreamingCommand', '(', 'String', 'commandAlias', ',', 'StreamingCommand', 'command', ')', '{']",0
"['pigContext', '.', 'registerStreamCmd', '(', 'commandAlias', ',', 'command', ')', ';']",0
"['private', 'URL', 'locateJarFromResources', '(', 'String', 'jarName', ')', 'throws', 'IOException', '{']",0
"['Enumeration', '<', 'URL', '>', 'urls', '=', 'ClassLoader', '.', 'getSystemResources', '(', 'jarName', ')', ';']",0
"['URL', 'resourceLocation', '=', 'null', ';']",0
"['if', '(', 'urls', '.', 'hasMoreElements', '(', ')', ')', '{']",0
"['resourceLocation', '=', 'urls', '.', 'nextElement', '(', ')', ';']",0
"['if', '(', 'pigContext', '.', 'debug', '&', '&', 'urls', '.', 'hasMoreElements', '(', ')', ')', '{']",0
"['String', 'logMessage', '=', '""', 'Found', 'multiple', 'resources', 'that', 'match', '""']",0
"['+', 'jarName', '+', '""', ':', '""', '+', 'resourceLocation', ';']",0
"['while', '(', 'urls', '.', 'hasMoreElements', '(', ')', ')', '{']",0
"['logMessage', '+', '=', '(', 'logMessage', '+', 'urls', '.', 'nextElement', '(', ')', '+', '""', ';', '""', ')', ';']",0
"['log', '.', 'debug', '(', 'logMessage', ')', ';']",0
"['return', 'resourceLocation', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'registerJar', '(', 'String', 'name', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'first', 'try', 'to', 'locate', 'jar', 'via', 'system', 'resources']",0
"['/', '/', 'if', 'this', 'fails', ',', 'try', 'by', 'using', '""', 'name', '""', 'as', 'File', '(', 'this', 'preserves']",0
"['/', '/', 'compatibility', 'with', 'case', 'when', 'user', 'passes', 'absolute', 'path', 'or', 'path']",0
"['/', '/', 'relative', 'to', 'current', 'working', 'directory', '.', ')']",0
"['if', '(', 'name', '!', '=', 'null', ')', '{']",0
"['URL', 'resource', '=', 'locateJarFromResources', '(', 'name', ')', ';']",0
"['if', '(', 'resource', '=', '=', 'null', ')', '{']",0
"['File', 'f', '=', 'new', 'File', '(', 'name', ')', ';']",0
"['if', '(', '!', 'f', '.', 'canRead', '(', ')', ')', '{']",0
"['int', 'errCode', '=', '4002', ';']",0
"['String', 'msg', '=', '""', 'Can', ""'"", 't', 'read', 'jar', 'file', ':', '""', '+', 'name', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'USER_ENVIRONMENT', ')', ';']",0
"['resource', '=', 'f', '.', 'toURI', '(', ')', '.', 'toURL', '(', ')', ';']",0
"['pigContext', '.', 'addJar', '(', 'resource', ')', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'registerQuery', '(', 'String', 'query', ',', 'int', 'startLine', ')', 'throws', 'IOException', '{']",0
"['LogicalPlan', 'lp', '=', 'parseQuery', '(', 'query', ',', 'startLine', ',', 'aliases', ',', 'opTable', ',', 'aliasOp', ')', ';']",0
"['/', '/', 'store', 'away', 'the', 'query', 'for', 'use', 'in', 'cloning', 'later']",0
"['cachedScript', '.', 'add', '(', 'query', ')', ';']",0
"['if', '(', 'lp', '.', 'getLeaves', '(', ')', '.', 'size', '(', ')', '=', '=', '1', ')']",0
"['LogicalOperator', 'op', '=', 'lp', '.', 'getSingleLeafPlanOutputOp', '(', ')', ';']",0
"['/', '/', 'No', 'need', 'to', 'do', 'anything', 'about', 'DEFINE']",0
"['if', '(', 'op', 'instanceof', 'LODefine', ')', '{']",0
"['/', '/', 'Check', 'if', 'we', 'just', 'processed', 'a', 'LOStore', 'i', '.', 'e', '.', 'STORE']",0
"['if', '(', 'op', 'instanceof', 'LOStore', ')', '{']",0
"['execute', '(', 'null', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '1002', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'store', 'alias', '""', '+', 'op', '.', 'getOperatorKey', '(', ')', '.', 'getId', '(', ')', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'e', ')', ';']",0
"['private', 'LogicalPlan', 'parseQuery', '(', 'String', 'query', ',', 'int', 'startLine', ',', 'Map', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', 'aliasesMap', ',']",0
"['Map', '<', 'OperatorKey', ',', 'LogicalOperator', '>', 'opTableMap', ',', 'Map', '<', 'String', ',', 'LogicalOperator', '>', 'aliasOpMap', ')', 'throws', 'IOException', '{']",0
"['if', '(', 'query', '!', '=', 'null', ')', '{']",0
"['query', '=', 'query', '.', 'trim', '(', ')', ';']",0
"['if', '(', 'query', '.', 'length', '(', ')', '=', '=', '0', ')', 'return', 'null', ';']",0
"['}', 'else', '{']",1
"['return', 'null', ';']",0
"['return', 'new', 'LogicalPlanBuilder', '(', 'pigContext', ')', '.', 'parse', '(', 'scope', ',', 'query', ',']",0
"['aliasesMap', ',', 'opTableMap', ',', 'aliasOpMap', ',', 'startLine', ')', ';']",0
"['}', 'catch', '(', 'ParseException', 'e', ')', '{']",0
"['/', '/', 'throw', '(', 'IOException', ')', 'new', 'IOException', '(', 'e', '.', 'getMessage', '(', ')', ')', '.', 'initCause', '(', 'e', ')', ';']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['int', 'errCode', '=', '1000', ';']",0
"['String', 'msg', '=', '""', 'Error', 'during', 'parsing', '.', '""', '+', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'false', ',', 'null', ',', 'e', ')', ';']",0
"['public', 'LogicalPlan', 'clonePlan', '(', 'String', 'alias', ')', 'throws', 'IOException', '{']",0
"['/', '/', 'There', 'are', 'two', 'choices', 'on', 'how', 'we', 'clone', 'the', 'logical', 'plan']",0
"['/', '/', '1', '-', 'we', 'really', 'clone', 'each', 'operator', 'and', 'connect', 'up', 'the', 'cloned', 'operators']",0
"['/', '/', '2', '-', 'we', 'cache', 'away', 'the', 'script', 'till', 'the', 'point', 'we', 'need', 'to', 'clone']",0
"['/', '/', 'and', 'then', 'simply', 're', '-', 'parse', 'the', 'script', '.']",0
"['/', '/', 'The', 'latter', 'approach', 'is', 'used', 'here']",0
"['/', '/', 'FIXME', ':', 'There', 'is', 'one', 'open', 'issue', 'with', 'this', 'now', ':']",0
"['/', '/', 'Consider', 'the', 'following', 'script', ':']",0
"['/', '/', 'A', '=', 'load', ""'"", 'file', ':', '/', 'somefile', ""'"", ';']",0
"['/', '/', 'B', '=', 'filter', 'A', 'by', '$', '0', '>', '10', ';']",0
"['/', '/', 'store', 'B', 'into', ""'"", 'bla', ""'"", ';']",0
"['/', '/', 'rm', ""'"", 'file', ':', '/', 'somefile', ""'"", ';']",0
"['/', '/', 'A', '=', 'load', ""'"", 'file', ':', '/', 'someotherfile', ""'""]",0
"['/', '/', 'when', 'we', 'try', 'to', 'clone', '-', 'we', 'try', 'to', 'reparse']",0
"['/', '/', 'from', 'the', 'beginning', 'and', 'currently', 'the', 'parser']",0
"['/', '/', 'checks', 'for', 'file', 'existence', 'of', 'files', 'in', 'the', 'load']",0
"['/', '/', 'in', 'the', 'case', 'where', 'the', 'file', 'is', 'a', 'local', 'one', '-', 'i', '.', 'e', '.', 'with', 'file', ':', 'prefix']",0
"['/', '/', 'This', 'will', 'be', 'a', 'known', 'issue', 'now', 'and', 'we', 'will', 'need', 'to', 'revisit', 'later']",0
"['/', '/', 'parse', 'each', 'line', 'of', 'the', 'cached', 'script', 'and', 'the']",0
"['/', '/', 'final', 'logical', 'plan', 'is', 'the', 'clone', 'that', 'we', 'want']",0
"['LogicalPlan', 'lp', '=', 'null', ';']",0
"['int', 'lineNumber', '=', '1', ';']",0
"['/', '/', 'create', 'data', 'structures', 'needed', 'for', 'parsing']",0
"['Map', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', 'cloneAliases', '=', 'new', 'HashMap', '<', 'LogicalOperator', ',', 'LogicalPlan', '>', '(', ')', ';']",0
"['Map', '<', 'OperatorKey', ',', 'LogicalOperator', '>', 'cloneOpTable', '=', 'new', 'HashMap', '<', 'OperatorKey', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['Map', '<', 'String', ',', 'LogicalOperator', '>', 'cloneAliasOp', '=', 'new', 'HashMap', '<', 'String', ',', 'LogicalOperator', '>', '(', ')', ';']",0
"['for', '(', 'Iterator', '<', 'String', '>', 'it', '=', 'cachedScript', '.', 'iterator', '(', ')', ';', 'it', '.', 'hasNext', '(', ')', ';', 'lineNumber', '+', '+', ')', '{']",0
"['lp', '=', 'parseQuery', '(', 'it', '.', 'next', '(', ')', ',', 'lineNumber', ',', 'cloneAliases', ',', 'cloneOpTable', ',', 'cloneAliasOp', ')', ';']",0
"['if', '(', 'alias', '=', '=', 'null', ')', '{']",0
"['/', '/', 'a', 'store', 'prompted', 'the', 'execution', '-', 'so', 'return']",0
"['/', '/', 'the', 'entire', 'logical', 'plan']",0
"['return', 'lp', ';']",0
"['}', 'else', '{']",1
"['/', '/', 'return', 'the', 'logical', 'plan', 'corresponding', 'to', 'the']",0
"['/', '/', 'alias', 'supplied']",0
"['LogicalOperator', 'op', '=', 'cloneAliasOp', '.', 'get', '(', 'alias', ')', ';']",0
"['if', '(', 'op', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '1003', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'find', 'an', 'operator', 'for', 'alias', '""', '+', 'alias', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ')', ';']",0
"['return', 'cloneAliases', '.', 'get', '(', 'op', ')', ';']",0
"['public', 'void', 'registerQuery', '(', 'String', 'query', ')', 'throws', 'IOException', '{']",0
"['registerQuery', '(', 'query', ',', '1', ')', ';']",0
"['public', 'void', 'registerScript', '(', 'String', 'fileName', ')', 'throws', 'IOException', '{']",0
"['GruntParser', 'grunt', '=', 'new', 'GruntParser', '(', 'new', 'FileReader', '(', 'new', 'File', '(', 'fileName', ')', ')', ')', ';']",0
"['grunt', '.', 'setInteractive', '(', 'false', ')', ';']",0
"['grunt', '.', 'setParams', '(', 'this', ')', ';']",0
"['grunt', '.', 'parseStopOnError', '(', ')', ';']",0
"['}', 'catch', '(', 'FileNotFoundException', 'e', ')', '{']",0
"['/', '/', 'TODO', 'Auto', '-', 'generated', 'catch', 'block']",0
"['e', '.', 'printStackTrace', '(', ')', ';']",0
"['throw', 'new', 'IOException', '(', 'e', '.', 'getCause', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'pigscript', '.', 'parser', '.', 'ParseException', 'e', ')', '{']",0
"['/', '/', 'TODO', 'Auto', '-', 'generated', 'catch', 'block']",0
"['e', '.', 'printStackTrace', '(', ')', ';']",0
"['throw', 'new', 'IOException', '(', 'e', '.', 'getCause', '(', ')', ')', ';']",0
"['public', 'void', 'printAliases', '(', ')', 'throws', 'FrontendException', '{']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'aliases', ':', '""', '+', 'aliasOp', '.', 'keySet', '(', ')', ')', ';']",0
"['public', 'Schema', 'dumpSchema', '(', 'String', 'alias', ')', 'throws', 'IOException', '{']",0
"['LogicalPlan', 'lp', '=', 'getPlanFromAlias', '(', 'alias', ',', '""', 'describe', '""', ')', ';']",0
"['lp', '=', 'compileLp', '(', 'alias', ',', 'false', ')', ';']",0
"['Schema', 'schema', '=', 'lp', '.', 'getLeaves', '(', ')', '.', 'get', '(', '0', ')', '.', 'getSchema', '(', ')', ';']",0
"['if', '(', 'schema', '!', '=', 'null', ')', 'System', '.', 'out', '.', 'println', '(', 'alias', '+', '""', ':', '""', '+', 'schema', '.', 'toString', '(', ')', ')', ';']",0
"['else', 'System', '.', 'out', '.', 'println', '(', '""', 'Schema', 'for', '""', '+', 'alias', '+', '""', 'unknown', '.', '""', ')', ';']",0
"['return', 'schema', ';']",0
"['}', 'catch', '(', 'FrontendException', 'fee', ')', '{']",0
"['int', 'errCode', '=', '1001', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'describe', 'schema', 'for', 'alias', '""', '+', 'alias', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'false', ',', 'null', ',', 'fee', ')', ';']",0
"['public', 'void', 'setJobName', '(', 'String', 'name', ')', '{']",0
"['pigContext', '.', 'getProperties', '(', ')', '.', 'setProperty', '(', 'PigContext', '.', 'JOB_NAME', ',', 'PigContext', '.', 'JOB_NAME_PREFIX', '+', '""', ':', '""', '+', 'name', ')', ';']",0
"['/', '*', '*']",0
"['public', 'Iterator', '<', 'Tuple', '>', 'openIterator', '(', 'String', 'id', ')', 'throws', 'IOException', '{']",0
"['LogicalOperator', 'op', '=', 'aliasOp', '.', 'get', '(', 'id', ')', ';']",0
"['if', '(', 'null', '=', '=', 'op', ')', '{']",0
"['int', 'errCode', '=', '1003', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'find', 'an', 'operator', 'for', 'alias', '""', '+', 'id', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ')', ';']",0
"['/', '/', 'ExecJob', 'job', '=', 'execute', '(', 'getPlanFromAlias', '(', 'id', ',', 'op', '.', 'getClass', '(', ')', '.', 'getName', '(', ')', ')', ')', ';']",0
"['ExecJob', 'job', '=', 'store', '(', 'id', ',', 'FileLocalizer', '.', 'getTemporaryPath', '(', 'null', ',', 'pigContext', ')', '.', 'toString', '(', ')', ',', 'BinStorage', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', '""', ')', ';']",0
"['/', '/', 'invocation', 'of', '""', 'execute', '""', 'is', 'synchronous', '!']",0
"['if', '(', 'job', '.', 'getStatus', '(', ')', '=', '=', 'JOB_STATUS', '.', 'COMPLETED', ')', '{']",0
"['return', 'job', '.', 'getResults', '(', ')', ';']",0
"['}', 'else', '{']",1
"['throw', 'new', 'IOException', '(', '""', 'Job', 'terminated', 'with', 'anomalous', 'status', '""']",0
"['+', 'job', '.', 'getStatus', '(', ')', '.', 'toString', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '1066', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'open', 'iterator', 'for', 'alias', '""', '+', 'id', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'e', ')', ';']",0
"['/', '*', '*']",0
"['public', 'ExecJob', 'store', '(', 'String', 'id', ',', 'String', 'filename', ')', 'throws', 'IOException', '{']",0
"['return', 'store', '(', 'id', ',', 'filename', ',', 'PigStorage', '.', 'class', '.', 'getName', '(', ')', '+', '""', '(', ')', '""', ')', ';', '/', '/', 'SFPig', 'is', 'the', 'default', 'store', 'function']",0
"['/', '*', '*']",0
"['public', 'ExecJob', 'store', '(']",0
"['String', 'id', ',']",0
"['String', 'filename', ',']",0
"['String', 'func', ')', 'throws', 'IOException', '{']",0
"['if', '(', '!', 'aliasOp', '.', 'containsKey', '(', 'id', ')', ')']",0
"['throw', 'new', 'IOException', '(', '""', 'Invalid', 'alias', ':', '""', '+', 'id', ')', ';']",0
"['LogicalPlan', 'readFrom', '=', 'getPlanFromAlias', '(', 'id', ',', '""', 'store', '""', ')', ';']",0
"['return', 'store', '(', 'id', ',', 'readFrom', ',', 'filename', ',', 'func', ')', ';']",0
"['}', 'catch', '(', 'FrontendException', 'fe', ')', '{']",0
"['int', 'errCode', '=', '1002', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'store', 'alias', '""', '+', 'id', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'fe', ')', ';']",0
"['public', 'ExecJob', 'store', '(']",0
"['String', 'id', ',']",0
"['LogicalPlan', 'readFrom', ',']",0
"['String', 'filename', ',']",0
"['String', 'func', ')', 'throws', 'IOException', '{']",0
"['LogicalPlan', 'lp', '=', 'compileLp', '(', 'id', ')', ';']",0
"['/', '/', 'MRCompiler', 'needs', 'a', 'store', 'to', 'be', 'the', 'leaf', '-', 'hence']",0
"['/', '/', 'add', 'a', 'store', 'to', 'the', 'plan', 'to', 'explain']",0
"['/', '/', 'figure', 'out', 'the', 'leaf', 'to', 'which', 'the', 'store', 'needs', 'to', 'be', 'added']",0
"['List', '<', 'LogicalOperator', '>', 'leaves', '=', 'lp', '.', 'getLeaves', '(', ')', ';']",0
"['LogicalOperator', 'leaf', '=', 'null', ';']",0
"['if', '(', 'leaves', '.', 'size', '(', ')', '=', '=', '1', ')', '{']",0
"['leaf', '=', 'leaves', '.', 'get', '(', '0', ')', ';']",0
"['}', 'else', '{']",1
"['for', '(', 'Iterator', '<', 'LogicalOperator', '>', 'it', '=', 'leaves', '.', 'iterator', '(', ')', ';', 'it', '.', 'hasNext', '(', ')', ';', ')', '{']",0
"['LogicalOperator', 'leafOp', '=', 'it', '.', 'next', '(', ')', ';']",0
"['if', '(', 'leafOp', '.', 'getAlias', '(', ')', '.', 'equals', '(', 'id', ')', ')']",0
"['leaf', '=', 'leafOp', ';']",0
"['LogicalPlan', 'storePlan', '=', 'QueryParser', '.', 'generateStorePlan', '(', 'scope', ',', 'lp', ',', 'filename', ',', 'func', ',', 'leaf', ')', ';']",0
"['return', 'executeCompiledLogicalPlan', '(', 'storePlan', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '1002', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'store', 'alias', '""', '+', 'id', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'e', ')', ';']",0
"['/', '*', '*']",0
"['public', 'void', 'explain', '(', 'String', 'alias', ',']",0
"['PrintStream', 'stream', ')', 'throws', 'IOException', '{']",0
"['LogicalPlan', 'lp', '=', 'compileLp', '(', 'alias', ')', ';']",0
"['/', '/', 'MRCompiler', 'needs', 'a', 'store', 'to', 'be', 'the', 'leaf', '-', 'hence']",0
"['/', '/', 'add', 'a', 'store', 'to', 'the', 'plan', 'to', 'explain']",0
"['/', '/', 'figure', 'out', 'the', 'leaf', 'to', 'which', 'the', 'store', 'needs', 'to', 'be', 'added']",0
"['List', '<', 'LogicalOperator', '>', 'leaves', '=', 'lp', '.', 'getLeaves', '(', ')', ';']",0
"['LogicalOperator', 'leaf', '=', 'null', ';']",0
"['if', '(', 'leaves', '.', 'size', '(', ')', '=', '=', '1', ')', '{']",0
"['leaf', '=', 'leaves', '.', 'get', '(', '0', ')', ';']",0
"['}', 'else', '{']",1
"['for', '(', 'Iterator', '<', 'LogicalOperator', '>', 'it', '=', 'leaves', '.', 'iterator', '(', ')', ';', 'it', '.', 'hasNext', '(', ')', ';', ')', '{']",0
"['LogicalOperator', 'leafOp', '=', 'it', '.', 'next', '(', ')', ';']",0
"['if', '(', 'leafOp', '.', 'getAlias', '(', ')', '.', 'equals', '(', 'alias', ')', ')']",0
"['leaf', '=', 'leafOp', ';']",0
"['LogicalPlan', 'storePlan', '=', 'QueryParser', '.', 'generateStorePlan', '(']",0
"['scope', ',', 'lp', ',', '""', 'fakefile', '""', ',', 'PigStorage', '.', 'class', '.', 'getName', '(', ')', ',', 'leaf', ')', ';']",0
"['stream', '.', 'println', '(', '""', 'Logical', 'Plan', ':', '""', ')', ';']",0
"['LOPrinter', 'lv', '=', 'new', 'LOPrinter', '(', 'stream', ',', 'storePlan', ')', ';']",0
"['lv', '.', 'visit', '(', ')', ';']",0
"['PhysicalPlan', 'pp', '=', 'compilePp', '(', 'storePlan', ')', ';']",0
"['stream', '.', 'println', '(', '""', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '""', ')', ';']",0
"['stream', '.', 'println', '(', '""', 'Physical', 'Plan', ':', '""', ')', ';']",0
"['stream', '.', 'println', '(', '""', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '""', ')', ';']",0
"['pigContext', '.', 'getExecutionEngine', '(', ')', '.', 'explain', '(', 'pp', ',', 'stream', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['int', 'errCode', '=', '1067', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'explain', 'alias', '""', '+', 'alias', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'e', ')', ';']",0
"['/', '*', '*']",0
"['public', 'long', 'capacity', '(', ')', 'throws', 'IOException', '{']",0
"['if', '(', 'pigContext', '.', 'getExecType', '(', ')', '=', '=', 'ExecType', '.', 'LOCAL', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'capacity', 'only', 'supported', 'for', 'non', '-', 'local', 'execution', '""', ')', ';']",0
"['DataStorage', 'dds', '=', 'pigContext', '.', 'getDfs', '(', ')', ';']",0
"['Map', '<', 'String', ',', 'Object', '>', 'stats', '=', 'dds', '.', 'getStatistics', '(', ')', ';']",0
"['String', 'rawCapacityStr', '=', '(', 'String', ')', 'stats', '.', 'get', '(', 'DataStorage', '.', 'RAW_CAPACITY_KEY', ')', ';']",0
"['String', 'rawUsedStr', '=', '(', 'String', ')', 'stats', '.', 'get', '(', 'DataStorage', '.', 'RAW_USED_KEY', ')', ';']",0
"['if', '(', '(', 'rawCapacityStr', '=', '=', 'null', ')', '|', '|', '(', 'rawUsedStr', '=', '=', 'null', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'Failed', 'to', 'retrieve', 'capacity', 'stats', '""', ')', ';']",0
"['long', 'rawCapacityBytes', '=', 'new', 'Long', '(', 'rawCapacityStr', ')', '.', 'longValue', '(', ')', ';']",0
"['long', 'rawUsedBytes', '=', 'new', 'Long', '(', 'rawUsedStr', ')', '.', 'longValue', '(', ')', ';']",0
"['return', 'rawCapacityBytes', '-', 'rawUsedBytes', ';']",0
"['/', '*', '*']",0
"['public', 'long', 'fileSize', '(', 'String', 'filename', ')', 'throws', 'IOException', '{']",0
"['DataStorage', 'dfs', '=', 'pigContext', '.', 'getDfs', '(', ')', ';']",0
"['ElementDescriptor', 'elem', '=', 'dfs', '.', 'asElement', '(', 'filename', ')', ';']",0
"['Map', '<', 'String', ',', 'Object', '>', 'stats', '=', 'elem', '.', 'getStatistics', '(', ')', ';']",0
"['long', 'length', '=', '(', 'Long', ')', 'stats', '.', 'get', '(', 'ElementDescriptor', '.', 'LENGTH_KEY', ')', ';']",0
"['int', 'replication', '=', '(', 'Short', ')', 'stats']",0
"['.', 'get', '(', 'ElementDescriptor', '.', 'BLOCK_REPLICATION_KEY', ')', ';']",0
"['return', 'length', '*', 'replication', ';']",0
"['public', 'boolean', 'existsFile', '(', 'String', 'filename', ')', 'throws', 'IOException', '{']",0
"['ElementDescriptor', 'elem', '=', 'pigContext', '.', 'getDfs', '(', ')', '.', 'asElement', '(', 'filename', ')', ';']",0
"['return', 'elem', '.', 'exists', '(', ')', ';']",0
"['public', 'boolean', 'deleteFile', '(', 'String', 'filename', ')', 'throws', 'IOException', '{']",0
"['ElementDescriptor', 'elem', '=', 'pigContext', '.', 'getDfs', '(', ')', '.', 'asElement', '(', 'filename', ')', ';']",0
"['elem', '.', 'delete', '(', ')', ';']",0
"['return', 'true', ';']",0
"['public', 'boolean', 'renameFile', '(', 'String', 'source', ',', 'String', 'target', ')', 'throws', 'IOException', '{']",0
"['pigContext', '.', 'rename', '(', 'source', ',', 'target', ')', ';']",0
"['return', 'true', ';']",0
"['public', 'boolean', 'mkdirs', '(', 'String', 'dirs', ')', 'throws', 'IOException', '{']",0
"['ContainerDescriptor', 'container', '=', 'pigContext', '.', 'getDfs', '(', ')', '.', 'asContainer', '(', 'dirs', ')', ';']",0
"['container', '.', 'create', '(', ')', ';']",0
"['return', 'true', ';']",0
"['public', 'String', '[', ']', 'listPaths', '(', 'String', 'dir', ')', 'throws', 'IOException', '{']",0
"['Collection', '<', 'String', '>', 'allPaths', '=', 'new', 'ArrayList', '<', 'String', '>', '(', ')', ';']",0
"['ContainerDescriptor', 'container', '=', 'pigContext', '.', 'getDfs', '(', ')', '.', 'asContainer', '(', 'dir', ')', ';']",0
"['Iterator', '<', 'ElementDescriptor', '>', 'iter', '=', 'container', '.', 'iterator', '(', ')', ';']",0
"['while', '(', 'iter', '.', 'hasNext', '(', ')', ')', '{']",0
"['ElementDescriptor', 'elem', '=', 'iter', '.', 'next', '(', ')', ';']",0
"['allPaths', '.', 'add', '(', 'elem', '.', 'toString', '(', ')', ')', ';']",0
"['return', '(', 'String', '[', ']', ')', '(', 'allPaths', '.', 'toArray', '(', ')', ')', ';']",0
"['public', 'long', 'totalHadoopTimeSpent', '(', ')', '{']",0
"['/', '/', 'TODO', 'FIX', 'Need', 'to', 'uncomment', 'this', 'with', 'the', 'right', 'logic']",0
"['/', '/', 'return', 'MapReduceLauncher', '.', 'totalHadoopTimeSpent', ';']",0
"['return', '0L', ';']",0
"['public', 'Map', '<', 'String', ',', 'LogicalPlan', '>', 'getAliases', '(', ')', '{']",0
"['Map', '<', 'String', ',', 'LogicalPlan', '>', 'aliasPlans', '=', 'new', 'HashMap', '<', 'String', ',', 'LogicalPlan', '>', '(', ')', ';']",0
"['for', '(', 'LogicalOperator', 'op', ':', 'this', '.', 'aliases', '.', 'keySet', '(', ')', ')', '{']",0
"['String', 'alias', '=', 'op', '.', 'getAlias', '(', ')', ';']",0
"['if', '(', 'null', '!', '=', 'alias', ')', '{']",0
"['aliasPlans', '.', 'put', '(', 'alias', ',', 'this', '.', 'aliases', '.', 'get', '(', 'op', ')', ')', ';']",0
"['return', 'aliasPlans', ';']",0
"['public', 'void', 'shutdown', '(', ')', '{']",0
"['/', '/', 'clean', '-', 'up', 'activities']",0
"['/', '/', 'TODO', ':', 'reclaim', 'scope', 'to', 'free', 'up', 'resources', '.', 'Currently']",0
"['/', '/', 'this', 'is', 'not', 'implemented', 'and', 'throws', 'an', 'exception']",0
"['/', '/', 'hence', ',', 'for', 'now', ',', 'we', 'won', ""'"", 't', 'call', 'it', '.']",0
"['/', '/', 'pigContext', '.', 'getExecutionEngine', '(', ')', '.', 'reclaimScope', '(', 'this', '.', 'scope', ')', ';']",0
"['public', 'Map', '<', 'LogicalOperator', ',', 'DataBag', '>', 'getExamples', '(', 'String', 'alias', ')', '{']",0
"['/', '/', 'LogicalPlan', 'plan', '=', 'aliases', '.', 'get', '(', 'aliasOp', '.', 'get', '(', 'alias', ')', ')', ';']",0
"['LogicalPlan', 'plan', '=', 'null', ';']",0
"['plan', '=', 'clonePlan', '(', 'alias', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['/', '/', 'Since', 'the', 'original', 'script', 'is', 'parsed', 'anyway', ',', 'there', 'should', 'not', 'be', 'an']",0
"['/', '/', 'error', 'in', 'this', 'parsing', '.', 'The', 'only', 'reason', 'there', 'can', 'be', 'an', 'error', 'is', 'when']",0
"['/', '/', 'the', 'files', 'being', 'loaded', 'in', 'load', 'don', ""'"", 't', 'exist', 'anymore', '.']",0
"['e', '.', 'printStackTrace', '(', ')', ';']",0
"['ExampleGenerator', 'exgen', '=', 'new', 'ExampleGenerator', '(', 'plan', ',', 'pigContext', ')', ';']",0
"['return', 'exgen', '.', 'getExamples', '(', ')', ';']",0
"['private', 'ExecJob', 'execute', '(', 'String', 'alias', ')', 'throws', 'FrontendException', ',', 'ExecException', '{']",0
"['ExecJob', 'job', '=', 'null', ';']",0
"['/', '/', 'lp', '.', 'explain', '(', 'System', '.', 'out', ',', 'System', '.', 'err', ')', ';']",0
"['LogicalPlan', 'typeCheckedLp', '=', 'compileLp', '(', 'alias', ')', ';']",0
"['return', 'executeCompiledLogicalPlan', '(', 'typeCheckedLp', ')', ';']",0
"['/', '/', 'typeCheckedLp', '.', 'explain', '(', 'System', '.', 'out', ',', 'System', '.', 'err', ')', ';']",0
"['private', 'ExecJob', 'executeCompiledLogicalPlan', '(', 'LogicalPlan', 'compiledLp', ')', 'throws', 'ExecException', '{']",0
"['PhysicalPlan', 'pp', '=', 'compilePp', '(', 'compiledLp', ')', ';']",0
"['/', '/', 'execute', 'using', 'appropriate', 'engine']",0
"['FileLocalizer', '.', 'clearDeleteOnFail', '(', ')', ';']",0
"['ExecJob', 'execJob', '=', 'pigContext', '.', 'getExecutionEngine', '(', ')', '.', 'execute', '(', 'pp', ',', '""', 'execute', '""', ')', ';']",0
"['if', '(', 'execJob', '.', 'getStatus', '(', ')', '=', '=', 'ExecJob', '.', 'JOB_STATUS', '.', 'FAILED', ')']",0
"['FileLocalizer', '.', 'triggerDeleteOnFail', '(', ')', ';']",0
"['return', 'execJob', ';']",0
"['private', 'LogicalPlan', 'compileLp', '(']",0
"['String', 'alias', ')', 'throws', 'FrontendException', '{']",0
"['return', 'compileLp', '(', 'alias', ',', 'true', ')', ';']",0
"['private', 'LogicalPlan', 'compileLp', '(']",0
"['String', 'alias', ',']",0
"['boolean', 'optimize', ')', 'throws', 'FrontendException', '{']",0
"['/', '/', 'create', 'a', 'clone', 'of', 'the', 'logical', 'plan', 'and', 'give', 'it']",0
"['/', '/', 'to', 'the', 'operations', 'below']",0
"['LogicalPlan', 'lpClone', ';']",0
"['lpClone', '=', 'clonePlan', '(', 'alias', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['int', 'errCode', '=', '2001', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'clone', 'plan', 'before', 'compiling', '""', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e', ')', ';']",0
"['/', '/', 'Set', 'the', 'logical', 'plan', 'values', 'correctly', 'in', 'all', 'the', 'operators']",0
"['PlanSetter', 'ps', '=', 'new', 'PlanSetter', '(', 'lpClone', ')', ';']",0
"['ps', '.', 'visit', '(', ')', ';']",0
"['/', '/', '(', 'new', 'SplitIntroducer', '(', 'lp', ')', ')', '.', 'introduceImplSplits', '(', ')', ';']",0
"['/', '/', 'run', 'through', 'validator']",0
"['CompilationMessageCollector', 'collector', '=', 'new', 'CompilationMessageCollector', '(', ')', ';']",0
"['FrontendException', 'caught', '=', 'null', ';']",0
"['LogicalPlanValidationExecutor', 'validator', '=']",0
"['new', 'LogicalPlanValidationExecutor', '(', 'lpClone', ',', 'pigContext', ')', ';']",0
"['validator', '.', 'validate', '(', 'lpClone', ',', 'collector', ')', ';']",0
"['}', 'catch', '(', 'FrontendException', 'fe', ')', '{']",0
"['/', '/', 'Need', 'to', 'go', 'through', 'and', 'see', 'what', 'the', 'collector', 'has', 'in', 'it', '.', 'But']",0
"['/', '/', 'remember', 'what', 'we', ""'"", 've', 'caught', 'so', 'we', 'can', 'wrap', 'it', 'into', 'what', 'we']",0
"['/', '/', 'throw', '.']",0
"['caught', '=', 'fe', ';']",0
"['if', '(', 'aggregateWarning', ')', '{']",0
"['CompilationMessageCollector', '.', 'logMessages', '(', 'collector', ',', 'MessageType', '.', 'Warning', ',', 'aggregateWarning', ',', 'log', ')', ';']",0
"['}', 'else', '{']",1
"['for', '(', 'Enum', 'type', ':', 'MessageType', '.', 'values', '(', ')', ')', '{']",0
"['CompilationMessageCollector', '.', 'logAllMessages', '(', 'collector', ',', 'log', ')', ';']",0
"['if', '(', 'caught', '!', '=', 'null', ')', '{']",0
"['throw', 'caught', ';']",0
"['/', '/', 'optimize']",0
"['if', '(', 'optimize', ')', '{']",0
"['/', '/', 'LogicalOptimizer', 'optimizer', '=', 'new', 'LogicalOptimizer', '(', 'lpClone', ')', ';']",0
"['LogicalOptimizer', 'optimizer', '=', 'new', 'LogicalOptimizer', '(', 'lpClone', ',', 'pigContext', '.', 'getExecType', '(', ')', ')', ';']",0
"['optimizer', '.', 'optimize', '(', ')', ';']",0
"['return', 'lpClone', ';']",0
"['private', 'PhysicalPlan', 'compilePp', '(', 'LogicalPlan', 'lp', ')', 'throws', 'ExecException', '{']",0
"['/', '/', 'translate', 'lp', 'to', 'physical', 'plan']",0
"['PhysicalPlan', 'pp', '=', 'pigContext', '.', 'getExecutionEngine', '(', ')', '.', 'compile', '(', 'lp', ',', 'null', ')', ';']",0
"['/', '/', 'TODO', 'optimize']",0
"['return', 'pp', ';']",0
"['private', 'LogicalPlan', 'getPlanFromAlias', '(']",0
"['String', 'alias', ',']",0
"['String', 'operation', ')', 'throws', 'FrontendException', '{']",0
"['LogicalOperator', 'lo', '=', 'aliasOp', '.', 'get', '(', 'alias', ')', ';']",0
"['if', '(', 'lo', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '1004', ';']",0
"['String', 'msg', '=', '""', 'No', 'alias', '""', '+', 'alias', '+', '""', 'to', '""', '+', 'operation', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'false', ',', 'null', ')', ';']",0
"['LogicalPlan', 'lp', '=', 'aliases', '.', 'get', '(', 'lo', ')', ';']",0
"['if', '(', 'lp', '=', '=', 'null', ')', '{']",0
"['int', 'errCode', '=', '1005', ';']",0
"['String', 'msg', '=', '""', 'No', 'plan', 'for', '""', '+', 'alias', '+', '""', 'to', '""', '+', 'operation', ';']",0
"['throw', 'new', 'FrontendException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'INPUT', ',', 'false', ',', 'null', ')', ';']",0
"['return', 'lp', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', ';']",0
"['import', 'java', '.', 'io', '.', 'File', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'Reader', ';']",0
"['import', 'java', '.', 'io', '.', 'FileReader', ';']",0
"['import', 'java', '.', 'io', '.', 'FileInputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'OutputStreamWriter', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedReader', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedWriter', ';']",0
"['import', 'java', '.', 'io', '.', 'FileWriter', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStreamReader', ';']",0
"['import', 'java', '.', 'io', '.', 'FileNotFoundException', ';']",0
"['import', 'java', '.', 'io', '.', 'StringReader', ';']",0
"['import', 'java', '.', 'io', '.', 'StringWriter', ';']",0
"['import', 'java', '.', 'util', '.', 'Iterator', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'java', '.', 'util', '.', 'ArrayList', ';']",0
"['import', 'java', '.', 'util', '.', 'Properties', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayOutputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayInputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'jline', '.', 'ConsoleReader', ';']",0
"['import', 'jline', '.', 'ConsoleReaderInputStream', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobClient', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'RunningJob', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobID', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'FuncSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'ContainerDescriptor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorage', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'DataStorageException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'datastorage', '.', 'ElementDescriptor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'HExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'WrappedIOException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'pigscript', '.', 'parser', '.', 'ParseException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'pigscript', '.', 'parser', '.', 'PigScriptParser', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'pigscript', '.', 'parser', '.', 'PigScriptParserTokenManager', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'parameters', '.', 'ParameterSubstitutionPreprocessor', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['public', 'class', 'GruntParser', 'extends', 'PigScriptParser', '{']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['public', 'GruntParser', '(', 'Reader', 'stream', ')', '{']",0
"['super', '(', 'stream', ')', ';']",0
"['init', '(', ')', ';']",0
"['public', 'GruntParser', '(', 'InputStream', 'stream', ',', 'String', 'encoding', ')', '{']",0
"['super', '(', 'stream', ',', 'encoding', ')', ';']",0
"['init', '(', ')', ';']",0
"['public', 'GruntParser', '(', 'InputStream', 'stream', ')', '{']",0
"['super', '(', 'stream', ')', ';']",0
"['init', '(', ')', ';']",0
"['public', 'GruntParser', '(', 'PigScriptParserTokenManager', 'tm', ')', '{']",0
"['super', '(', 'tm', ')', ';']",0
"['init', '(', ')', ';']",0
"['private', 'void', 'init', '(', ')', '{']",0
"['/', '/', 'nothing', ',', 'for', 'now', '.']",0
"['public', 'void', 'parseStopOnError', '(', ')', 'throws', 'IOException', ',', 'ParseException']",0
"['prompt', '(', ')', ';']",0
"['mDone', '=', 'false', ';']",0
"['while', '(', '!', 'mDone', ')', '{']",0
"['parse', '(', ')', ';']",0
"['public', 'void', 'parseContOnError', '(', ')']",0
"['prompt', '(', ')', ';']",0
"['mDone', '=', 'false', ';']",0
"['while', '(', '!', 'mDone', ')', '{']",0
"['parse', '(', ')', ';']",0
"['catch', '(', 'Exception', 'e', ')']",0
"['Exception', 'pe', '=', 'LogUtils', '.', 'getPermissionException', '(', 'e', ')', ';']",0
"['if', '(', 'pe', '!', '=', 'null', ')']",0
"['log', '.', 'error', '(', '""', 'You', 'don', ""'"", 't', 'have', 'permission', 'to', 'perform', 'the', 'operation', '.', 'Error', 'from', 'the', 'server', ':', '""', '+', 'pe', '.', 'getMessage', '(', ')', ')', ';']",1
"['ByteArrayOutputStream', 'bs', '=', 'new', 'ByteArrayOutputStream', '(', ')', ';']",1
"['e', '.', 'printStackTrace', '(', 'new', 'PrintStream', '(', 'bs', ')', ')', ';']",0
"['log', '.', 'error', '(', 'bs', '.', 'toString', '(', ')', ')', ';']",1
"['/', '/', 'log', '.', 'error', '(', 'e', '.', 'getMessage', '(', ')', ')', ';']",0
"['/', '/', 'log', '.', 'error', '(', 'e', ')', ';']",0
"['}', 'catch', '(', 'Error', 'e', ')', '{']",0
"['log', '.', 'error', '(', 'e', ')', ';']",0
"['public', 'void', 'setParams', '(', 'PigServer', 'pigServer', ')']",0
"['mPigServer', '=', 'pigServer', ';']",0
"['mDfs', '=', 'mPigServer', '.', 'getPigContext', '(', ')', '.', 'getDfs', '(', ')', ';']",0
"['mLfs', '=', 'mPigServer', '.', 'getPigContext', '(', ')', '.', 'getLfs', '(', ')', ';']",0
"['mConf', '=', 'mPigServer', '.', 'getPigContext', '(', ')', '.', 'getProperties', '(', ')', ';']",0
"['/', '/', 'TODO', ':', 'this', 'violates', 'the', 'abstraction', 'layer', 'decoupling', 'between']",0
"['/', '/', 'front', 'end', 'and', 'back', 'end', 'and', 'needs', 'to', 'be', 'changed', '.']",0
"['/', '/', 'Right', 'now', 'I', 'am', 'not', 'clear', 'on', 'how', 'the', 'Job', 'Id', 'comes', 'from', 'to', 'tell']",0
"['/', '/', 'the', 'back', 'end', 'to', 'kill', 'a', 'given', 'job', '(', 'mJobClient', 'is', 'used', 'only', 'in']",0
"['/', '/', 'processKill', ')']",0
"['ExecutionEngine', 'execEngine', '=', 'mPigServer', '.', 'getPigContext', '(', ')', '.', 'getExecutionEngine', '(', ')', ';']",0
"['if', '(', 'execEngine', 'instanceof', 'HExecutionEngine', ')', '{']",0
"['mJobClient', '=', '(', '(', 'HExecutionEngine', ')', 'execEngine', ')', '.', 'getJobClient', '(', ')', ';']",0
"['mJobClient', '=', 'null', ';']",0
"['public', 'void', 'prompt', '(', ')']",0
"['if', '(', 'mInteractive', ')']",0
"['/', '*', 'System', '.', 'err', '.', 'print', '(', '""', 'grunt', '>', '""', ')', ';']",0
"['System', '.', 'err', '.', 'flush', '(', ')', ';', '*', '/']",0
"['mConsoleReader', '.', 'setDefaultPrompt', '(', '""', 'grunt', '>', '""', ')', ';']",0
"['protected', 'void', 'quit', '(', ')']",0
"['mDone', '=', 'true', ';']",0
"['protected', 'void', 'processDescribe', '(', 'String', 'alias', ')', 'throws', 'IOException', '{']",0
"['if', '(', 'alias', '=', '=', 'null', ')', '{']",0
"['alias', '=', 'mPigServer', '.', 'getPigContext', '(', ')', '.', 'getLastAlias', '(', ')', ';']",0
"['mPigServer', '.', 'dumpSchema', '(', 'alias', ')', ';']",0
"['protected', 'void', 'printAliases', '(', ')', 'throws', 'IOException', '{']",0
"['mPigServer', '.', 'printAliases', '(', ')', ';']",0
"['protected', 'void', 'processExplain', '(', 'String', 'alias', ')', 'throws', 'IOException', '{']",0
"['mPigServer', '.', 'explain', '(', 'alias', ',', 'System', '.', 'out', ')', ';']",0
"['protected', 'void', 'processRegister', '(', 'String', 'jar', ')', 'throws', 'IOException', '{']",0
"['mPigServer', '.', 'registerJar', '(', 'jar', ')', ';']",0
"['private', 'String', 'runPreprocessor', '(', 'String', 'script', ',', 'ArrayList', '<', 'String', '>', 'params', ',']",0
"['ArrayList', '<', 'String', '>', 'files', ')']",0
"['throws', 'IOException', ',', 'ParseException', '{']",0
"['ParameterSubstitutionPreprocessor', 'psp', '=', 'new', 'ParameterSubstitutionPreprocessor', '(', '50', ')', ';']",0
"['StringWriter', 'writer', '=', 'new', 'StringWriter', '(', ')', ';']",0
"['psp', '.', 'genSubstitutedFile', '(', 'new', 'BufferedReader', '(', 'new', 'FileReader', '(', 'script', ')', ')', ',']",0
"['params', '.', 'size', '(', ')', '>', '0', '?', 'params', '.', 'toArray', '(', 'new', 'String', '[', '0', ']', ')', ':', 'null', ',']",0
"['files', '.', 'size', '(', ')', '>', '0', '?', 'files', '.', 'toArray', '(', 'new', 'String', '[', '0', ']', ')', ':', 'null', ')', ';']",0
"['}', 'catch', '(', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'parameters', '.', 'ParseException', 'pex', ')', '{']",0
"['throw', 'new', 'ParseException', '(', 'pex', '.', 'getMessage', '(', ')', ')', ';']",0
"['return', 'writer', '.', 'toString', '(', ')', ';']",0
"['protected', 'void', 'processScript', '(', 'String', 'script', ',', 'boolean', 'batch', ',']",0
"['ArrayList', '<', 'String', '>', 'params', ',', 'ArrayList', '<', 'String', '>', 'files', ')']",0
"['throws', 'IOException', ',', 'ParseException', '{']",0
"['Reader', 'inputReader', ';']",0
"['ConsoleReader', 'reader', ';']",0
"['boolean', 'interactive', ';']",0
"['String', 'cmds', '=', 'runPreprocessor', '(', 'script', ',', 'params', ',', 'files', ')', ';']",0
"['if', '(', 'mInteractive', '&', '&', '!', 'batch', ')', '{', '/', '/', 'Write', 'prompt', 'and', 'echo', 'commands']",0
"['reader', '=', 'new', 'ConsoleReader', '(', 'new', 'ByteArrayInputStream', '(', 'cmds', '.', 'getBytes', '(', ')', ')', ',']",0
"['new', 'OutputStreamWriter', '(', 'System', '.', 'out', ')', ')', ';']",0
"['reader', '.', 'setHistory', '(', 'mConsoleReader', '.', 'getHistory', '(', ')', ')', ';']",0
"['InputStream', 'in', '=', 'new', 'ConsoleReaderInputStream', '(', 'reader', ')', ';']",0
"['inputReader', '=', 'new', 'BufferedReader', '(', 'new', 'InputStreamReader', '(', 'in', ')', ')', ';']",0
"['interactive', '=', 'true', ';']",0
"['}', 'else', '{', '/', '/', 'Quietly', 'parse', 'the', 'statements']",0
"['inputReader', '=', 'new', 'StringReader', '(', 'cmds', ')', ';']",0
"['reader', '=', 'null', ';']",0
"['interactive', '=', 'false', ';']",0
"['}', 'catch', '(', 'FileNotFoundException', 'fnfe', ')', '{']",0
"['throw', 'new', 'ParseException', '(', '""', 'File', 'not', 'found', ':', '""', '+', 'script', ')', ';']",0
"['}', 'catch', '(', 'SecurityException', 'se', ')', '{']",0
"['throw', 'new', 'ParseException', '(', '""', 'Cannot', 'access', 'file', ':', '""', '+', 'script', ')', ';']",0
"['/', '/', 'In', 'batch', 'mode', ':', 'Use', 'a', 'new', 'server', 'to', 'avoid', 'side', '-', 'effects', '(', 'handles', ',', 'etc', ')']",0
"['PigServer', 'pigServer', '=', 'batch', '?']",0
"['new', 'PigServer', '(', 'mPigServer', '.', 'getPigContext', '(', ')', ',', 'false', ')', ':', 'mPigServer', ';']",0
"['GruntParser', 'parser', '=', 'new', 'GruntParser', '(', 'inputReader', ')', ';']",0
"['parser', '.', 'setParams', '(', 'pigServer', ')', ';']",0
"['parser', '.', 'setConsoleReader', '(', 'reader', ')', ';']",0
"['parser', '.', 'setInteractive', '(', 'interactive', ')', ';']",0
"['parser', '.', 'parseStopOnError', '(', ')', ';']",0
"['if', '(', 'interactive', ')', '{']",0
"['System', '.', 'out', '.', 'println', '(', '""', '""', ')', ';']",0
"['protected', 'void', 'processSet', '(', 'String', 'key', ',', 'String', 'value', ')', 'throws', 'IOException', ',', 'ParseException', '{']",0
"['if', '(', 'key', '.', 'equals', '(', '""', 'debug', '""', ')', ')']",0
"['if', '(', 'value', '.', 'equals', '(', '""', 'on', '""', ')', '|', '|', 'value', '.', 'equals', '(', '""', ""'"", 'on', ""'"", '""', ')', ')']",0
"['mPigServer', '.', 'debugOn', '(', ')', ';']",0
"['else', 'if', '(', 'value', '.', 'equals', '(', '""', 'off', '""', ')', '|', '|', 'value', '.', 'equals', '(', '""', ""'"", 'off', ""'"", '""', ')', ')']",0
"['mPigServer', '.', 'debugOff', '(', ')', ';']",0
"['throw', 'new', 'ParseException', '(', '""', 'Invalid', 'value', '""', '+', 'value', '+', '""', 'provided', 'for', '""', '+', 'key', ')', ';']",0
"['else', 'if', '(', 'key', '.', 'equals', '(', '""', 'job', '.', 'name', '""', ')', ')']",0
"['/', '/', 'mPigServer', '.', 'setJobName', '(', 'unquote', '(', 'value', ')', ')', ';']",0
"['mPigServer', '.', 'setJobName', '(', 'value', ')', ';']",0
"['else', 'if', '(', 'key', '.', 'equals', '(', '""', 'stream', '.', 'skippath', '""', ')', ')', '{']",0
"['/', '/', 'Validate']",0
"['File', 'file', '=', 'new', 'File', '(', 'value', ')', ';']",0
"['if', '(', '!', 'file', '.', 'exists', '(', ')', '|', '|', 'file', '.', 'isDirectory', '(', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'Invalid', 'value', 'for', 'stream', '.', 'skippath', ':', '""', '+']",0
"['value', ')', ';']",0
"['mPigServer', '.', 'addPathToSkip', '(', 'value', ')', ';']",0
"['/', '/', 'other', 'key', '-', 'value', 'pairs', 'can', 'go', 'there']",0
"['/', '/', 'for', 'now', 'just', 'throw', 'exception', 'since', 'we', 'don', ""'"", 't', 'support']",0
"['/', '/', 'anything', 'else']",0
"['throw', 'new', 'ParseException', '(', '""', 'Unrecognized', 'set', 'key', ':', '""', '+', 'key', ')', ';']",0
"['protected', 'void', 'processCat', '(', 'String', 'path', ')', 'throws', 'IOException']",0
"['byte', 'buffer', '[', ']', '=', 'new', 'byte', '[', '65536', ']', ';']",0
"['ElementDescriptor', 'dfsPath', '=', 'mDfs', '.', 'asElement', '(', 'path', ')', ';']",0
"['int', 'rc', ';']",0
"['if', '(', '!', 'dfsPath', '.', 'exists', '(', ')', ')']",0
"['throw', 'new', 'IOException', '(', '""', 'Directory', '""', '+', 'path', '+', '""', 'does', 'not', 'exist', '.', '""', ')', ';']",0
"['if', '(', 'mDfs', '.', 'isContainer', '(', 'path', ')', ')', '{']",0
"['ContainerDescriptor', 'dfsDir', '=', '(', 'ContainerDescriptor', ')', 'dfsPath', ';']",0
"['Iterator', '<', 'ElementDescriptor', '>', 'paths', '=', 'dfsDir', '.', 'iterator', '(', ')', ';']",0
"['while', '(', 'paths', '.', 'hasNext', '(', ')', ')', '{']",0
"['ElementDescriptor', 'curElem', '=', 'paths', '.', 'next', '(', ')', ';']",0
"['if', '(', 'mDfs', '.', 'isContainer', '(', 'curElem', '.', 'toString', '(', ')', ')', ')', '{']",0
"['InputStream', 'is', '=', 'curElem', '.', 'open', '(', ')', ';']",0
"['while', '(', '(', 'rc', '=', 'is', '.', 'read', '(', 'buffer', ')', ')', '>', '0', ')', '{']",0
"['System', '.', 'out', '.', 'write', '(', 'buffer', ',', '0', ',', 'rc', ')', ';']",0
"['is', '.', 'close', '(', ')', ';']",0
"['InputStream', 'is', '=', 'dfsPath', '.', 'open', '(', ')', ';']",0
"['while', '(', '(', 'rc', '=', 'is', '.', 'read', '(', 'buffer', ')', ')', '>', '0', ')', '{']",0
"['System', '.', 'out', '.', 'write', '(', 'buffer', ',', '0', ',', 'rc', ')', ';']",0
"['is', '.', 'close', '(', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'Cat', ':', '""', '+', 'path', ',', 'e', ')', ';']",0
"['protected', 'void', 'processCD', '(', 'String', 'path', ')', 'throws', 'IOException']",0
"['ContainerDescriptor', 'container', ';']",0
"['if', '(', 'path', '=', '=', 'null', ')', '{']",0
"['container', '=', 'mDfs', '.', 'asContainer', '(', '""', '/', 'user', '/', '""', '+', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'name', '""', ')', ')', ';']",0
"['mDfs', '.', 'setActiveContainer', '(', 'container', ')', ';']",0
"['container', '=', 'mDfs', '.', 'asContainer', '(', 'path', ')', ';']",0
"['if', '(', '!', 'container', '.', 'exists', '(', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'Directory', '""', '+', 'path', '+', '""', 'does', 'not', 'exist', '.', '""', ')', ';']",0
"['if', '(', '!', 'mDfs', '.', 'isContainer', '(', 'path', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', 'path', '+', '""', 'is', 'not', 'a', 'directory', '.', '""', ')', ';']",0
"['mDfs', '.', 'setActiveContainer', '(', 'container', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'change', 'working', 'directory', 'to', '""', '+']",0
"['(', '(', 'path', '=', '=', 'null', ')', '?', '(', '""', '/', 'user', '/', '""', '+', 'System', '.', 'getProperty', '(', '""', 'user', '.', 'name', '""', ')', ')']",0
"[':', '(', 'path', ')', ')', ',', 'e', ')', ';']",0
"['protected', 'void', 'processDump', '(', 'String', 'alias', ')', 'throws', 'IOException']",0
"['Iterator', 'result', '=', 'mPigServer', '.', 'openIterator', '(', 'alias', ')', ';']",0
"['while', '(', 'result', '.', 'hasNext', '(', ')', ')']",0
"['Tuple', 't', '=', '(', 'Tuple', ')', 'result', '.', 'next', '(', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', 't', ')', ';']",0
"['protected', 'void', 'processIllustrate', '(', 'String', 'alias', ')', 'throws', 'IOException']",0
"['mPigServer', '.', 'getExamples', '(', 'alias', ')', ';']",0
"['protected', 'void', 'processKill', '(', 'String', 'jobid', ')', 'throws', 'IOException']",0
"['if', '(', 'mJobClient', '!', '=', 'null', ')', '{']",0
"['JobID', 'id', '=', 'JobID', '.', 'forName', '(', 'jobid', ')', ';']",0
"['RunningJob', 'job', '=', 'mJobClient', '.', 'getJob', '(', 'id', ')', ';']",0
"['if', '(', 'job', '=', '=', 'null', ')']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'Job', 'with', 'id', '""', '+', 'jobid', '+', '""', 'is', 'not', 'active', '""', ')', ';']",0
"['job', '.', 'killJob', '(', ')', ';']",0
"['log', '.', 'error', '(', '""', 'kill', 'submited', '.', '""', ')', ';']",0
"['protected', 'void', 'processLS', '(', 'String', 'path', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'pathDescriptor', ';']",0
"['if', '(', 'path', '=', '=', 'null', ')', '{']",0
"['pathDescriptor', '=', 'mDfs', '.', 'getActiveContainer', '(', ')', ';']",0
"['pathDescriptor', '=', 'mDfs', '.', 'asElement', '(', 'path', ')', ';']",0
"['if', '(', '!', 'pathDescriptor', '.', 'exists', '(', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'File', 'or', 'directory', '""', '+', 'path', '+', '""', 'does', 'not', 'exist', '.', '""', ')', ';']",0
"['if', '(', 'mDfs', '.', 'isContainer', '(', 'pathDescriptor', '.', 'toString', '(', ')', ')', ')', '{']",0
"['ContainerDescriptor', 'container', '=', '(', 'ContainerDescriptor', ')', 'pathDescriptor', ';']",0
"['Iterator', '<', 'ElementDescriptor', '>', 'elems', '=', 'container', '.', 'iterator', '(', ')', ';']",0
"['while', '(', 'elems', '.', 'hasNext', '(', ')', ')', '{']",0
"['ElementDescriptor', 'curElem', '=', 'elems', '.', 'next', '(', ')', ';']",0
"['if', '(', 'mDfs', '.', 'isContainer', '(', 'curElem', '.', 'toString', '(', ')', ')', ')', '{']",0
"['System', '.', 'out', '.', 'println', '(', 'curElem', '.', 'toString', '(', ')', '+', '""', '\\', 't', '<', 'dir', '>', '""', ')', ';']",0
"['}', 'else', '{']",1
"['printLengthAndReplication', '(', 'curElem', ')', ';']",0
"['}', 'else', '{']",1
"['printLengthAndReplication', '(', 'pathDescriptor', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'LS', 'on', '""', '+', 'path', ',', 'e', ')', ';']",0
"['private', 'void', 'printLengthAndReplication', '(', 'ElementDescriptor', 'elem', ')']",0
"['throws', 'IOException', '{']",0
"['Map', '<', 'String', ',', 'Object', '>', 'stats', '=', 'elem', '.', 'getStatistics', '(', ')', ';']",0
"['long', 'replication', '=', '(', 'Short', ')', 'stats']",0
"['.', 'get', '(', 'ElementDescriptor', '.', 'BLOCK_REPLICATION_KEY', ')', ';']",0
"['long', 'len', '=', '(', 'Long', ')', 'stats', '.', 'get', '(', 'ElementDescriptor', '.', 'LENGTH_KEY', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', 'elem', '.', 'toString', '(', ')', '+', '""', '<', 'r', '""', '+', 'replication', '+', '""', '>', '\\', 't', '""', '+', 'len', ')', ';']",0
"['protected', 'void', 'processPWD', '(', ')', 'throws', 'IOException']",0
"['System', '.', 'out', '.', 'println', '(', 'mDfs', '.', 'getActiveContainer', '(', ')', '.', 'toString', '(', ')', ')', ';']",0
"['protected', 'void', 'printHelp', '(', ')']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'Commands', ':', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', '<', 'pig', 'latin', 'statement', '>', ';', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'store', '<', 'alias', '>', 'into', '<', 'filename', '>', '[', 'using', '<', 'functionSpec', '>', ']', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'dump', '<', 'alias', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'describe', '<', 'alias', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'kill', '<', 'job_id', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'ls', '<', 'path', '>', '\\', 'r', '\\', 'ndu', '<', 'path', '>', '\\', 'r', '\\', 'nmv', '<', 'src', '>', '<', 'dst', '>', '\\', 'r', '\\', 'ncp', '<', 'src', '>', '<', 'dst', '>', '\\', 'r', '\\', 'nrm', '<', 'src', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'copyFromLocal', '<', 'localsrc', '>', '<', 'dst', '>', '\\', 'r', '\\', 'ncd', '<', 'dir', '>', '\\', 'r', '\\', 'npwd', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'cat', '<', 'src', '>', '\\', 'r', '\\', 'ncopyToLocal', '<', 'src', '>', '<', 'localdst', '>', '\\', 'r', '\\', 'nmkdir', '<', 'path', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'cd', '<', 'path', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'define', '<', 'functionAlias', '>', '<', 'functionSpec', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'register', '<', 'udfJar', '>', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'set', 'key', 'value', '""', ')', ';']",0
"['System', '.', 'out', '.', 'println', '(', '""', 'quit', '""', ')', ';']",0
"['protected', 'void', 'processMove', '(', 'String', 'src', ',', 'String', 'dst', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'srcPath', '=', 'mDfs', '.', 'asElement', '(', 'src', ')', ';']",0
"['ElementDescriptor', 'dstPath', '=', 'mDfs', '.', 'asElement', '(', 'dst', ')', ';']",0
"['if', '(', '!', 'srcPath', '.', 'exists', '(', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'File', 'or', 'directory', '""', '+', 'src', '+', '""', 'does', 'not', 'exist', '.', '""', ')', ';']",0
"['srcPath', '.', 'rename', '(', 'dstPath', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'move', '""', '+', 'src', '+', '""', 'to', '""', '+', 'dst', ',', 'e', ')', ';']",0
"['protected', 'void', 'processCopy', '(', 'String', 'src', ',', 'String', 'dst', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'srcPath', '=', 'mDfs', '.', 'asElement', '(', 'src', ')', ';']",0
"['ElementDescriptor', 'dstPath', '=', 'mDfs', '.', 'asElement', '(', 'dst', ')', ';']",0
"['srcPath', '.', 'copy', '(', 'dstPath', ',', 'mConf', ',', 'false', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'copy', '""', '+', 'src', '+', '""', 'to', '""', '+', 'dst', ',', 'e', ')', ';']",0
"['protected', 'void', 'processCopyToLocal', '(', 'String', 'src', ',', 'String', 'dst', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'srcPath', '=', 'mDfs', '.', 'asElement', '(', 'src', ')', ';']",0
"['ElementDescriptor', 'dstPath', '=', 'mLfs', '.', 'asElement', '(', 'dst', ')', ';']",0
"['srcPath', '.', 'copy', '(', 'dstPath', ',', 'false', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'copy', '""', '+', 'src', '+', '""', 'to', '(', 'locally', ')', '""', '+', 'dst', ',', 'e', ')', ';']",0
"['protected', 'void', 'processCopyFromLocal', '(', 'String', 'src', ',', 'String', 'dst', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'srcPath', '=', 'mLfs', '.', 'asElement', '(', 'src', ')', ';']",0
"['ElementDescriptor', 'dstPath', '=', 'mDfs', '.', 'asElement', '(', 'dst', ')', ';']",0
"['srcPath', '.', 'copy', '(', 'dstPath', ',', 'false', ')', ';']",0
"['catch', '(', 'DataStorageException', 'e', ')', '{']",0
"['throw', 'WrappedIOException', '.', 'wrap', '(', '""', 'Failed', 'to', 'copy', '(', 'loally', ')', '""', '+', 'src', '+', '""', 'to', '""', '+', 'dst', ',', 'e', ')', ';']",0
"['protected', 'void', 'processMkdir', '(', 'String', 'dir', ')', 'throws', 'IOException']",0
"['ContainerDescriptor', 'dirDescriptor', '=', 'mDfs', '.', 'asContainer', '(', 'dir', ')', ';']",0
"['dirDescriptor', '.', 'create', '(', ')', ';']",0
"['protected', 'void', 'processPig', '(', 'String', 'cmd', ')', 'throws', 'IOException']",0
"['int', 'start', '=', '1', ';']",0
"['if', '(', '!', 'mInteractive', ')']",0
"['start', '=', 'getLineNumber', '(', ')', ';']",0
"['if', '(', 'cmd', '.', 'charAt', '(', 'cmd', '.', 'length', '(', ')', '-', '1', ')', '!', '=', ""'"", ';', ""'"", ')']",0
"['mPigServer', '.', 'registerQuery', '(', 'cmd', '+', '""', ';', '""', ',', 'start', ')', ';']",0
"['mPigServer', '.', 'registerQuery', '(', 'cmd', ',', 'start', ')', ';']",0
"['protected', 'void', 'processRemove', '(', 'String', 'path', ',', 'String', 'options', ')', 'throws', 'IOException']",0
"['ElementDescriptor', 'dfsPath', '=', 'mDfs', '.', 'asElement', '(', 'path', ')', ';']",0
"['if', '(', '!', 'dfsPath', '.', 'exists', '(', ')', ')', '{']",0
"['if', '(', 'options', '=', '=', 'null', '|', '|', '!', 'options', '.', 'equalsIgnoreCase', '(', '""', 'force', '""', ')', ')', '{']",0
"['throw', 'new', 'IOException', '(', '""', 'File', 'or', 'directory', '""', '+', 'path', '+', '""', 'does', 'not', 'exist', '.', '""', ')', ';']",0
"['dfsPath', '.', 'delete', '(', ')', ';']",0
"['private', 'PigServer', 'mPigServer', ';']",0
"['private', 'DataStorage', 'mDfs', ';']",0
"['private', 'DataStorage', 'mLfs', ';']",0
"['private', 'Properties', 'mConf', ';']",0
"['private', 'JobClient', 'mJobClient', ';']",0
"['private', 'boolean', 'mDone', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'util', '.', 'Map', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayInputStream', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigWarning', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'PhysicalOperator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'PigLogger', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataBag', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'DataType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'Tuple', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'TupleFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'BagFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'parser', '.', 'ParseException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'data', '.', 'parser', '.', 'TextDataParser', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['/', '*', '*']",0
"['abstract', 'public', 'class', 'Utf8StorageConverter', '{']",0
"['protected', 'BagFactory', 'mBagFactory', '=', 'BagFactory', '.', 'getInstance', '(', ')', ';']",0
"['protected', 'TupleFactory', 'mTupleFactory', '=', 'TupleFactory', '.', 'getInstance', '(', ')', ';']",0
"['protected', 'final', 'Log', 'mLog', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['private', 'Integer', 'mMaxInt', '=', 'new', 'Integer', '(', 'Integer', '.', 'MAX_VALUE', ')', ';']",0
"['private', 'Long', 'mMaxLong', '=', 'new', 'Long', '(', 'Long', '.', 'MAX_VALUE', ')', ';']",0
"['private', 'TextDataParser', 'dataParser', '=', 'null', ';']",0
"['private', 'PigLogger', 'pigLogger', '=', 'PhysicalOperator', '.', 'getPigLogger', '(', ')', ';']",0
"['public', 'Utf8StorageConverter', '(', ')', '{']",0
"['private', 'Object', 'parseFromBytes', '(', 'byte', '[', ']', 'b', ')', 'throws', 'ParseException', '{']",0
"['ByteArrayInputStream', 'in', '=', 'new', 'ByteArrayInputStream', '(', 'b', ')', ';']",0
"['if', '(', 'dataParser', '=', '=', 'null', ')', '{']",0
"['dataParser', '=', 'new', 'TextDataParser', '(', 'in', ')', ';']",0
"['}', 'else', '{']",1
"['dataParser', '.', 'ReInit', '(', 'in', ')', ';']",0
"['return', 'dataParser', '.', 'Parse', '(', ')', ';']",0
"['public', 'DataBag', 'bytesToBag', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['DataBag', 'db', ';']",0
"['db', '=', '(', 'DataBag', ')', 'parseFromBytes', '(', 'b', ')', ';']",0
"['}', 'catch', '(', 'ParseException', 'pe', ')', '{']",1
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'bag', ',', 'caught', 'ParseException', '<', '""', '+']",0
"['pe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['/', '/', 'can', 'happen', 'if', 'parseFromBytes', 'identifies', 'it', 'as', 'being', 'of', 'different', 'type']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'bag', ',', 'caught', 'Exception', '<', '""', '+']",0
"['e', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['return', '(', 'DataBag', ')', 'db', ';']",0
"['public', 'String', 'bytesToCharArray', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['return', 'new', 'String', '(', 'b', ',', '""', 'UTF', '-', '8', '""', ')', ';']",0
"['public', 'Double', 'bytesToDouble', '(', 'byte', '[', ']', 'b', ')', '{']",0
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['return', 'Double', '.', 'valueOf', '(', 'new', 'String', '(', 'b', ')', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'double', ',', 'caught', 'NumberFormatException', '<', '""', '+']",0
"['nfe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Float', 'bytesToFloat', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['String', 's', ';']",0
"['if', '(', 'b', '.', 'length', '>', '0', '&', '&']",0
"['(', 'b', '[', 'b', '.', 'length', '-', '1', ']', '=', '=', ""'"", 'F', ""'"", '|', '|', 'b', '[', 'b', '.', 'length', '-', '1', ']', '=', '=', ""'"", 'f', ""'"", ')', ')', '{']",0
"['s', '=', 'new', 'String', '(', 'b', ',', '0', ',', 'b', '.', 'length', '-', '1', ')', ';']",0
"['s', '=', 'new', 'String', '(', 'b', ')', ';']",0
"['return', 'Float', '.', 'valueOf', '(', 's', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'float', ',', 'caught', 'NumberFormatException', '<', '""', '+']",0
"['nfe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Integer', 'bytesToInteger', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['String', 's', '=', 'new', 'String', '(', 'b', ')', ';']",0
"['return', 'Integer', '.', 'valueOf', '(', 's', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe', ')', '{']",0
"['/', '/', 'It', ""'"", 's', 'possible', 'that', 'this', 'field', 'can', 'be', 'interpreted', 'as', 'a', 'double', '.']",0
"['/', '/', 'Unfortunately', 'Java', 'doesn', ""'"", 't', 'handle', 'this', 'in', 'Integer', '.', 'valueOf', '.', 'So']",0
"['/', '/', 'we', 'need', 'to', 'try', 'to', 'convert', 'it', 'to', 'a', 'double', 'and', 'if', 'that', 'works', 'then']",0
"['/', '/', 'go', 'to', 'an', 'int', '.']",0
"['Double', 'd', '=', 'Double', '.', 'valueOf', '(', 's', ')', ';']",0
"['/', '/', 'Need', 'to', 'check', 'for', 'an', 'overflow', 'error']",0
"['if', '(', 'd', '.', 'doubleValue', '(', ')', '>', 'mMaxInt', '.', 'doubleValue', '(', ')', '+', '1', '.', '0', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Value', '""', '+', 'd', '+', '""', 'too', 'large', 'for', 'integer', '""', ',']",0
"['PigWarning', '.', 'TOO_LARGE_FOR_INT', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['return', 'new', 'Integer', '(', 'd', '.', 'intValue', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe2', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'int', ',', 'caught', 'NumberFormatException', '<', '""', '+']",0
"['nfe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Long', 'bytesToLong', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['String', 's', ';']",0
"['if', '(', 'b', '.', 'length', '>', '0', '&', '&']",0
"['(', 'b', '[', 'b', '.', 'length', '-', '1', ']', '=', '=', ""'"", 'L', ""'"", '|', '|', 'b', '[', 'b', '.', 'length', '-', '1', ']', '=', '=', ""'"", 'l', ""'"", ')', ')', '{']",0
"['s', '=', 'new', 'String', '(', 'b', ',', '0', ',', 'b', '.', 'length', '-', '1', ')', ';']",0
"['s', '=', 'new', 'String', '(', 'b', ')', ';']",0
"['return', 'Long', '.', 'valueOf', '(', 's', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe', ')', '{']",0
"['/', '/', 'It', ""'"", 's', 'possible', 'that', 'this', 'field', 'can', 'be', 'interpreted', 'as', 'a', 'double', '.']",0
"['/', '/', 'Unfortunately', 'Java', 'doesn', ""'"", 't', 'handle', 'this', 'in', 'Long', '.', 'valueOf', '.', 'So']",0
"['/', '/', 'we', 'need', 'to', 'try', 'to', 'convert', 'it', 'to', 'a', 'double', 'and', 'if', 'that', 'works', 'then']",0
"['/', '/', 'go', 'to', 'an', 'long', '.']",0
"['Double', 'd', '=', 'Double', '.', 'valueOf', '(', 's', ')', ';']",0
"['/', '/', 'Need', 'to', 'check', 'for', 'an', 'overflow', 'error']",0
"['if', '(', 'd', '.', 'doubleValue', '(', ')', '>', 'mMaxLong', '.', 'doubleValue', '(', ')', '+', '1', '.', '0', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Value', '""', '+', 'd', '+', '""', 'too', 'large', 'for', 'integer', '""', ',']",0
"['PigWarning', '.', 'TOO_LARGE_FOR_INT', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['return', 'new', 'Long', '(', 'd', '.', 'longValue', '(', ')', ')', ';']",0
"['}', 'catch', '(', 'NumberFormatException', 'nfe2', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'long', ',', 'caught', 'NumberFormatException', '<', '""', '+']",1
"['nfe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['public', 'Map', '<', 'Object', ',', 'Object', '>', 'bytesToMap', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['Map', '<', 'Object', ',', 'Object', '>', 'map', ';']",0
"['map', '=', '(', 'Map', '<', 'Object', ',', 'Object', '>', ')', 'parseFromBytes', '(', 'b', ')', ';']",0
"['catch', '(', 'ParseException', 'pe', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'map', ',', 'caught', 'ParseException', '<', '""', '+']",0
"['pe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['/', '/', 'can', 'happen', 'if', 'parseFromBytes', 'identifies', 'it', 'as', 'being', 'of', 'different', 'type']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'map', ',', 'caught', 'Exception', '<', '""', '+']",0
"['e', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['return', 'map', ';']",0
"['public', 'Tuple', 'bytesToTuple', '(', 'byte', '[', ']', 'b', ')', 'throws', 'IOException', '{']",1
"['if', '(', 'b', '=', '=', 'null', ')']",0
"['return', 'null', ';']",0
"['Tuple', 't', ';']",0
"['t', '=', '(', 'Tuple', ')', 'parseFromBytes', '(', 'b', ')', ';']",0
"['catch', '(', 'ParseException', 'pe', ')', '{']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'tuple', ',', 'caught', 'ParseException', '<', '""', '+']",0
"['pe', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['/', '/', 'can', 'happen', 'if', 'parseFromBytes', 'identifies', 'it', 'as', 'being', 'of', 'different', 'type']",0
"['LogUtils', '.', 'warn', '(', 'this', ',', '""', 'Unable', 'to', 'interpret', 'value', '""', '+', 'b', '+', '""', 'in', 'field', 'being', '""', '+']",0
"['""', 'converted', 'to', 'type', 'tuple', ',', 'caught', 'Exception', '<', '""', '+']",0
"['e', '.', 'getMessage', '(', ')', '+', '""', '>', 'field', 'discarded', '""', ',']",0
"['PigWarning', '.', 'FIELD_DISCARDED_TYPE_CONVERSION_FAILED', ',', 'mLog', ')', ';']",0
"['return', 'null', ';']",0
"['return', 't', ';']",1
"['public', 'byte', '[', ']', 'toBytes', '(', 'DataBag', 'bag', ')', 'throws', 'IOException', '{']",0
"['return', 'bag', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'String', 's', ')', 'throws', 'IOException', '{']",0
"['return', 's', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Double', 'd', ')', 'throws', 'IOException', '{']",0
"['return', 'd', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Float', 'f', ')', 'throws', 'IOException', '{']",0
"['return', 'f', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Integer', 'i', ')', 'throws', 'IOException', '{']",0
"['return', 'i', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Long', 'l', ')', 'throws', 'IOException', '{']",0
"['return', 'l', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Map', '<', 'Object', ',', 'Object', '>', 'm', ')', 'throws', 'IOException', '{']",0
"['return', 'DataType', '.', 'mapToString', '(', 'm', ')', '.', 'getBytes', '(', ')', ';']",0
"['public', 'byte', '[', ']', 'toBytes', '(', 'Tuple', 't', ')', 'throws', 'IOException', '{']",0
"['return', 't', '.', 'toString', '(', ')', '.', 'getBytes', '(', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', ';']",0
"['import', 'java', '.', 'io', '.', 'IOException', ';']",0
"['import', 'java', '.', 'io', '.', 'PrintStream', ';']",0
"['import', 'java', '.', 'util', '.', 'ArrayList', ';']",0
"['import', 'java', '.', 'util', '.', 'HashSet', ';']",0
"['import', 'java', '.', 'util', '.', 'List', ';']",0
"['import', 'java', '.', 'util', '.', 'Set', ';']",0
"['import', 'java', '.', 'util', '.', 'regex', '.', 'Matcher', ';']",0
"['import', 'java', '.', 'util', '.', 'regex', '.', 'Pattern', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'conf', '.', 'Configuration', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobClient', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'JobID', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'RunningJob', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'TaskReport', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'jobcontrol', '.', 'Job', ';']",0
"['import', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'jobcontrol', '.', 'JobControl', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'FuncSpec', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'datastorage', '.', 'HConfiguration', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'HExecutionEngine', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'plans', '.', 'MROperPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'PhysicalOperator', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'plans', '.', 'PhysicalPlan', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'PlanException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'plan', '.', 'VisitorException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['public', 'abstract', 'class', 'Launcher', '{']",0
"['private', 'static', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'Launcher', '.', 'class', ')', ';']",0
"['long', 'totalHadoopTimeSpent', ';']",0
"['String', 'newLine', '=', '""', '\\', 'n', '""', ';']",0
"['boolean', 'pigException', '=', 'false', ';']",0
"['boolean', 'outOfMemory', '=', 'false', ';']",0
"['final', 'String', 'OOM_ERR', '=', '""', 'OutOfMemoryError', '""', ';']",0
"['protected', 'Launcher', '(', ')', '{']",0
"['totalHadoopTimeSpent', '=', '0', ';']",0
"['/', '/', 'handle', 'the', 'windows', 'portion', 'of', '\\', 'r']",0
"['if', '(', 'System', '.', 'getProperty', '(', '""', 'os', '.', 'name', '""', ')', '.', 'toUpperCase', '(', ')', '.', 'startsWith', '(', '""', 'WINDOWS', '""', ')', ')', '{']",0
"['newLine', '=', '""', '\\', 'r', '\\', 'n', '""', ';']",0
"['/', '*', '*']",0
"['public', 'abstract', 'boolean', 'launchPig', '(', 'PhysicalPlan', 'php', ',', 'String', 'grpName', ',', 'PigContext', 'pc', ')']",0
"['throws', 'PlanException', ',', 'VisitorException', ',', 'IOException', ',', 'ExecException', ',']",0
"['JobCreationException', ',', 'Exception', ';']",0
"['/', '*', '*']",0
"['public', 'abstract', 'void', 'explain', '(']",0
"['PhysicalPlan', 'pp', ',']",0
"['PigContext', 'pc', ',']",0
"['PrintStream', 'ps', ')', 'throws', 'PlanException', ',']",0
"['protected', 'boolean', 'isComplete', '(', 'double', 'prog', ')', '{']",0
"['return', '(', 'int', ')', '(', 'Math', '.', 'ceil', '(', 'prog', ')', ')', '=', '=', '(', 'int', ')', '1', ';']",0
"['protected', 'void', 'getStats', '(', 'Job', 'job', ',', 'JobClient', 'jobClient', ',', 'boolean', 'errNotDbg', ',', 'PigContext', 'pigContext', ')', 'throws', 'Exception', '{']",0
"['JobID', 'MRJobID', '=', 'job', '.', 'getAssignedJobID', '(', ')', ';']",0
"['String', 'jobMessage', '=', 'job', '.', 'getMessage', '(', ')', ';']",0
"['if', '(', 'MRJobID', '=', '=', 'null', ')', '{']",0
"['throw', 'getExceptionFromString', '(', 'jobMessage', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['/', '/', 'just', 'get', 'the', 'first', 'line', 'in', 'the', 'message', 'and', 'log', 'the', 'rest']",0
"['String', 'firstLine', '=', 'getFirstLineFromMessage', '(', 'jobMessage', ')', ';']",0
"['LogUtils', '.', 'writeLog', '(', 'new', 'Exception', '(', 'jobMessage', ')', ',', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'pig', '.', 'logfile', '""', ')', ',']",0
"['log', ',', 'false', ',', 'null', ',', 'false', ',', 'false', ')', ';']",0
"['int', 'errCode', '=', '2997', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'recreate', 'exception', 'from', 'backend', 'error', ':', '""', '+', 'firstLine', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e', ')', ';']",0
"['TaskReport', '[', ']', 'mapRep', '=', 'jobClient', '.', 'getMapTaskReports', '(', 'MRJobID', ')', ';']",0
"['getErrorMessages', '(', 'mapRep', ',', '""', 'map', '""', ',', 'errNotDbg', ',', 'pigContext', ')', ';']",0
"['totalHadoopTimeSpent', '+', '=', 'computeTimeSpent', '(', 'mapRep', ')', ';']",0
"['TaskReport', '[', ']', 'redRep', '=', 'jobClient', '.', 'getReduceTaskReports', '(', 'MRJobID', ')', ';']",0
"['getErrorMessages', '(', 'redRep', ',', '""', 'reduce', '""', ',', 'errNotDbg', ',', 'pigContext', ')', ';']",0
"['totalHadoopTimeSpent', '+', '=', 'computeTimeSpent', '(', 'mapRep', ')', ';']",0
"['}', 'catch', '(', 'IOException', 'e', ')', '{']",0
"['if', '(', 'job', '.', 'getState', '(', ')', '=', '=', 'Job', '.', 'SUCCESS', ')', '{']",0
"['/', '/', 'if', 'the', 'job', 'succeeded', ',', 'let', 'the', 'user', 'know', 'that']",0
"['/', '/', 'we', 'were', 'unable', 'to', 'get', 'statistics']",0
"['log', '.', 'warn', '(', '""', 'Unable', 'to', 'get', 'job', 'related', 'diagnostics', '""', ')', ';']",0
"['}', 'else', '{']",1
"['throw', 'e', ';']",1
"['protected', 'long', 'computeTimeSpent', '(', 'TaskReport', '[', ']', 'mapReports', ')', '{']",0
"['long', 'timeSpent', '=', '0', ';']",0
"['for', '(', 'TaskReport', 'r', ':', 'mapReports', ')', '{']",0
"['timeSpent', '+', '=', '(', 'r', '.', 'getFinishTime', '(', ')', '-', 'r', '.', 'getStartTime', '(', ')', ')', ';']",0
"['return', 'timeSpent', ';']",0
"['protected', 'void', 'getErrorMessages', '(', 'TaskReport', 'reports', '[', ']', ',', 'String', 'type', ',', 'boolean', 'errNotDbg', ',', 'PigContext', 'pigContext', ')', 'throws', 'Exception']",0
"['for', '(', 'int', 'i', '=', '0', ';', 'i', '<', 'reports', '.', 'length', ';', 'i', '+', '+', ')', '{']",0
"['String', 'msgs', '[', ']', '=', 'reports', '[', 'i', ']', '.', 'getDiagnostics', '(', ')', ';']",0
"['ArrayList', '<', 'Exception', '>', 'exceptions', '=', 'new', 'ArrayList', '<', 'Exception', '>', '(', ')', ';']",0
"['boolean', 'jobFailed', '=', 'false', ';']",0
"['float', 'successfulProgress', '=', '1', '.', '0f', ';']",0
"['if', '(', 'msgs', '.', 'length', '>', '0', ')', '{']",0
"['/', '/', 'if', 'the', 'progress', 'reported', 'is', 'not', '1', '.', '0f', 'then', 'the', 'map', 'or', 'reduce', 'job', 'failed']",0
"['/', '/', 'this', 'comparison', 'is', 'in', 'place', 'till', 'Hadoop', '0', '.', '20', 'provides', 'methods', 'to', 'query']",0
"['/', '/', 'job', 'status']",0
"['if', '(', 'reports', '[', 'i', ']', '.', 'getProgress', '(', ')', '!', '=', 'successfulProgress', ')', '{']",0
"['jobFailed', '=', 'true', ';']",0
"['Set', '<', 'String', '>', 'errorMessageSet', '=', 'new', 'HashSet', '<', 'String', '>', '(', ')', ';']",0
"['for', '(', 'int', 'j', '=', '0', ';', 'j', '<', 'msgs', '.', 'length', ';', 'j', '+', '+', ')', '{']",0
"['if', '(', '!', 'errorMessageSet', '.', 'contains', '(', 'msgs', '[', 'j', ']', ')', ')', '{']",0
"['errorMessageSet', '.', 'add', '(', 'msgs', '[', 'j', ']', ')', ';']",0
"['if', '(', 'errNotDbg', ')', '{']",0
"['/', '/', 'errNotDbg', 'is', 'used', 'only', 'for', 'failed', 'jobs']",0
"['/', '/', 'keep', 'track', 'of', 'all', 'the', 'unique', 'exceptions']",0
"['Exception', 'e', '=', 'getExceptionFromString', '(', 'msgs', '[', 'j', ']', ')', ';']",1
"['exceptions', '.', 'add', '(', 'e', ')', ';']",1
"['}', 'catch', '(', 'Exception', 'e1', ')', '{']",0
"['String', 'firstLine', '=', 'getFirstLineFromMessage', '(', 'msgs', '[', 'j', ']', ')', ';']",0
"['LogUtils', '.', 'writeLog', '(', 'new', 'Exception', '(', 'msgs', '[', 'j', ']', ')', ',', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'pig', '.', 'logfile', '""', ')', ',']",0
"['log', ',', 'false', ',', 'null', ',', 'false', ',', 'false', ')', ';']",0
"['int', 'errCode', '=', '2997', ';']",0
"['String', 'msg', '=', '""', 'Unable', 'to', 'recreate', 'exception', 'from', 'backed', 'error', ':', '""', '+', 'firstLine', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ',', 'e1', ')', ';']",0
"['}', 'else', '{']",1
"['log', '.', 'debug', '(', '""', 'Error', 'message', 'from', 'task', '(', '""', '+', 'type', '+', '""', ')', '""', '+']",0
"['reports', '[', 'i', ']', '.', 'getTaskID', '(', ')', '+', 'msgs', '[', 'j', ']', ')', ';']",0
"['/', '/', 'if', 'its', 'a', 'failed', 'job', 'then', 'check', 'if', 'there', 'is', 'more', 'than', 'one', 'exception']",0
"['/', '/', 'more', 'than', 'one', 'exception', 'implies', 'possibly', 'different', 'kinds', 'of', 'failures']",0
"['/', '/', 'log', 'all', 'the', 'different', 'failures', 'and', 'throw', 'the', 'exception', 'corresponding']",0
"['/', '/', 'to', 'the', 'first', 'failure']",0
"['if', '(', 'jobFailed', ')', '{']",0
"['if', '(', 'exceptions', '.', 'size', '(', ')', '>', '1', ')', '{']",0
"['for', '(', 'int', 'j', '=', '0', ';', 'j', '<', 'exceptions', '.', 'size', '(', ')', ';', '+', '+', 'j', ')', '{']",0
"['String', 'headerMessage', '=', '""', 'Error', 'message', 'from', 'task', '(', '""', '+', 'type', '+', '""', ')', '""', '+', 'reports', '[', 'i', ']', '.', 'getTaskID', '(', ')', ';']",0
"['LogUtils', '.', 'writeLog', '(', 'exceptions', '.', 'get', '(', 'j', ')', ',', 'pigContext', '.', 'getProperties', '(', ')', '.', 'getProperty', '(', '""', 'pig', '.', 'logfile', '""', ')', ',', 'log', ',', 'false', ',', 'headerMessage', ',', 'false', ',', 'false', ')', ';']",0
"['throw', 'exceptions', '.', 'get', '(', '0', ')', ';']",0
"['}', 'else', 'if', '(', 'exceptions', '.', 'size', '(', ')', '=', '=', '1', ')', '{']",0
"['throw', 'exceptions', '.', 'get', '(', '0', ')', ';']",0
"['}', 'else', '{']",1
"['int', 'errCode', '=', '2115', ';']",0
"['String', 'msg', '=', '""', 'Internal', 'error', '.', 'Expected', 'to', 'throw', 'exception', 'from', 'the', 'backend', '.', 'Did', 'not', 'find', 'any', 'exception', 'to', 'throw', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",1
"['/', '*', '*']",0
"['protected', 'double', 'calculateProgress', '(', 'JobControl', 'jc', ',', 'JobClient', 'jobClient', ')', 'throws', 'IOException', '{']",0
"['double', 'prog', '=', '0', '.', '0', ';']",0
"['prog', '+', '=', 'jc', '.', 'getSuccessfulJobs', '(', ')', '.', 'size', '(', ')', ';']",0
"['List', 'runnJobs', '=', 'jc', '.', 'getRunningJobs', '(', ')', ';']",0
"['for', '(', 'Object', 'object', ':', 'runnJobs', ')', '{']",0
"['Job', 'j', '=', '(', 'Job', ')', 'object', ';']",0
"['prog', '+', '=', 'progressOfRunningJob', '(', 'j', ',', 'jobClient', ')', ';']",0
"['return', 'prog', ';']",0
"['/', '*', '*']",0
"['protected', 'double', 'progressOfRunningJob', '(', 'Job', 'j', ',', 'JobClient', 'jobClient', ')', 'throws', 'IOException', '{']",0
"['JobID', 'mrJobID', '=', 'j', '.', 'getAssignedJobID', '(', ')', ';']",0
"['RunningJob', 'rj', '=', 'jobClient', '.', 'getJob', '(', 'mrJobID', ')', ';']",0
"['if', '(', 'rj', '=', '=', 'null', '&', '&', 'j', '.', 'getState', '(', ')', '=', '=', 'Job', '.', 'SUCCESS', ')']",0
"['return', '1', ';']",0
"['else', 'if', '(', 'rj', '=', '=', 'null', ')']",0
"['return', '0', ';']",0
"['double', 'mapProg', '=', 'rj', '.', 'mapProgress', '(', ')', ';']",0
"['double', 'redProg', '=', 'rj', '.', 'reduceProgress', '(', ')', ';']",0
"['return', '(', 'mapProg', '+', 'redProg', ')', '/', '2', ';']",0
"['public', 'long', 'getTotalHadoopTimeSpent', '(', ')', '{']",0
"['return', 'totalHadoopTimeSpent', ';']",0
"['/', '*', '*']",0
"['Exception', 'getExceptionFromString', '(', 'String', 'stackTrace', ')', 'throws', 'Exception', '{']",0
"['String', '[', ']', 'lines', '=', 'stackTrace', '.', 'split', '(', 'newLine', ')', ';']",0
"['Throwable', 't', '=', 'getExceptionFromStrings', '(', 'lines', ',', '0', ')', ';']",0
"['if', '(', '!', 'pigException', ')', '{']",0
"['int', 'errCode', '=', '6015', ';']",0
"['String', 'msg', '=', '""', 'During', 'execution', ',', 'encountered', 'a', 'Hadoop', 'error', '.', '""', ';']",0
"['ExecException', 'ee', '=', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'REMOTE_ENVIRONMENT', ',', 't', ')', ';']",0
"['ee', '.', 'setStackTrace', '(', 't', '.', 'getStackTrace', '(', ')', ')', ';']",0
"['return', 'ee', ';']",0
"['}', 'else', '{']",1
"['pigException', '=', 'false', ';']",0
"['if', '(', 'outOfMemory', ')', '{']",0
"['outOfMemory', '=', 'false', ';']",0
"['int', 'errCode', '=', '6016', ';']",0
"['String', 'msg', '=', '""', 'Out', 'of', 'memory', '.', '""', ';']",0
"['ExecException', 'ee', '=', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'REMOTE_ENVIRONMENT', ',', 't', ')', ';']",0
"['ee', '.', 'setStackTrace', '(', 't', '.', 'getStackTrace', '(', ')', ')', ';']",0
"['return', 'ee', ';']",0
"['return', '(', 'Exception', ')', 't', ';']",0
"['/', '*', '*']",0
"['private', 'Throwable', 'getExceptionFromStrings', '(', 'String', '[', ']', 'stackTraceLines', ',', 'int', 'startingLineNum', ')', 'throws', 'Exception', '{']",0
"['org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'executionengine', '.', 'ExecException', ':', 'ERROR', '1075', ':', 'Received', 'a', 'bytearray', 'from', 'the', 'UDF', '.', 'Cannot', 'determine', 'how', 'to', 'convert', 'the', 'bytearray', 'to', 'int', '.']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'expressionOperators', '.', 'POCast', '.', 'getNext', '(', 'POCast', '.', 'java', ':', '152', ')']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'expressionOperators', '.', 'LessThanExpr', '.', 'getNext', '(', 'LessThanExpr', '.', 'java', ':', '85', ')']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'physicalLayer', '.', 'relationalOperators', '.', 'POFilter', '.', 'getNext', '(', 'POFilter', '.', 'java', ':', '148', ')']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'PigMapBase', '.', 'runPipeline', '(', 'PigMapBase', '.', 'java', ':', '184', ')']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'PigMapBase', '.', 'map', '(', 'PigMapBase', '.', 'java', ':', '174', ')']",0
"['at', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'PigMapOnly', '$', 'Map', '.', 'map', '(', 'PigMapOnly', '.', 'java', ':', '65', ')']",0
"['at', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'MapRunner', '.', 'run', '(', 'MapRunner', '.', 'java', ':', '47', ')']",0
"['at', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'MapTask', '.', 'run', '(', 'MapTask', '.', 'java', ':', '227', ')']",0
"['at', 'org', '.', 'apache', '.', 'hadoop', '.', 'mapred', '.', 'TaskTracker', '$', 'Child', '.', 'main', '(', 'TaskTracker', '.', 'java', ':', '2207', ')']",0
"['int', 'prevStartingLineNum', '=', 'startingLineNum', ';']",0
"['if', '(', 'stackTraceLines', '.', 'length', '>', '0', '&', '&', 'startingLineNum', '<', '(', 'stackTraceLines', '.', 'length', '-', '1', ')', ')', '{']",0
"['/', '/', 'the', 'regex', 'for', 'matching', 'the', 'exception', 'class', 'name', ';', 'note', 'the', 'use', 'of', 'the', '$', 'for', 'matching', 'nested', 'classes']",0
"['String', 'exceptionNameDelimiter', '=', '""', '(', '\\', '\\', 'w', '+', '(', '\\', '\\', '$', '\\', '\\', 'w', '+', ')', '?', '\\', '\\', '.', ')', '+', '\\', '\\', 'w', '+', '""', ';']",0
"['Pattern', 'exceptionNamePattern', '=', 'Pattern', '.', 'compile', '(', 'exceptionNameDelimiter', ')', ';']",0
"['/', '/', 'from', 'the', 'first', 'line', 'extract', 'the', 'exception', 'name', 'and', 'the', 'exception', 'message']",0
"['Matcher', 'exceptionNameMatcher', '=', 'exceptionNamePattern', '.', 'matcher', '(', 'stackTraceLines', '[', 'startingLineNum', ']', ')', ';']",0
"['String', 'exceptionName', '=', 'null', ';']",0
"['String', 'exceptionMessage', '=', 'null', ';']",0
"['if', '(', 'exceptionNameMatcher', '.', 'find', '(', ')', ')', '{']",0
"['exceptionName', '=', 'exceptionNameMatcher', '.', 'group', '(', ')', ';']",0
"['if', '(', 'exceptionName', '.', 'contains', '(', 'OOM_ERR', ')', ')', '{']",0
"['outOfMemory', '=', 'true', ';']",0
"['if', '(', 'stackTraceLines', '[', 'startingLineNum', ']', '.', 'length', '(', ')', '>', 'exceptionNameMatcher', '.', 'end', '(', ')', ')', '{']",0
"['exceptionMessage', '=', 'stackTraceLines', '[', 'startingLineNum', ']', '.', 'substring', '(', 'exceptionNameMatcher', '.', 'end', '(', ')', '+', '2', ')', ';']",0
"['+', '+', 'startingLineNum', ';']",0
"['/', '/', 'the', 'exceptionName', 'should', 'not', 'be', 'null']",0
"['if', '(', 'exceptionName', '!', '=', 'null', ')', '{']",0
"['ArrayList', '<', 'StackTraceElement', '>', 'stackTraceElements', '=', 'new', 'ArrayList', '<', 'StackTraceElement', '>', '(', ')', ';']",0
"['/', '/', 'Create', 'stack', 'trace', 'elements', 'for', 'the', 'remaining', 'lines']",0
"['String', 'stackElementRegex', '=', '""', '\\', '\\', 's', '+', 'at', '\\', '\\', 's', '+', '(', '\\', '\\', 'w', '+', '(', '\\', '\\', '$', '\\', '\\', 'w', '+', ')', '?', '\\', '\\', '.', ')', '+', '(', '\\', '\\', '<', ')', '?', '\\', '\\', 'w', '+', '(', '\\', '\\', '>', ')', '?', '""', ';']",0
"['Pattern', 'stackElementPattern', '=', 'Pattern', '.', 'compile', '(', 'stackElementRegex', ')', ';']",0
"['String', 'pigExceptionRegex', '=', '""', 'org', '\\', '\\', '.', 'apache', '\\', '\\', '.', 'pig', '\\', '\\', '.', '""', ';']",0
"['Pattern', 'pigExceptionPattern', '=', 'Pattern', '.', 'compile', '(', 'pigExceptionRegex', ')', ';']",0
"['String', 'moreElementRegex', '=', '""', '\\', '\\', 's', '+', '\\', '\\', '.', '\\', '\\', '.', '\\', '\\', '.', '\\', '\\', 's', '+', '\\', '\\', 'd', '+', '\\', '\\', 's', '+', 'more', '""', ';']",0
"['Pattern', 'moreElementPattern', '=', 'Pattern', '.', 'compile', '(', 'moreElementRegex', ')', ';']",0
"['String', 'pigPackageRegex', '=', '""', 'org', '.', 'apache', '.', 'pig', '""', ';']",0
"['int', 'lineNum', '=', 'startingLineNum', ';']",0
"['for', '(', ';', 'lineNum', '<', '(', 'stackTraceLines', '.', 'length', '-', '1', ')', ';', '+', '+', 'lineNum', ')', '{']",0
"['Matcher', 'stackElementMatcher', '=', 'stackElementPattern', '.', 'matcher', '(', 'stackTraceLines', '[', 'lineNum', ']', ')', ';']",0
"['if', '(', 'stackElementMatcher', '.', 'find', '(', ')', ')', '{']",0
"['StackTraceElement', 'ste', '=', 'getStackTraceElement', '(', 'stackTraceLines', '[', 'lineNum', ']', ')', ';']",0
"['stackTraceElements', '.', 'add', '(', 'ste', ')', ';']",0
"['String', 'className', '=', 'ste', '.', 'getClassName', '(', ')', ';']",0
"['Matcher', 'pigExceptionMatcher', '=', 'pigExceptionPattern', '.', 'matcher', '(', 'className', ')', ';']",0
"['if', '(', 'pigExceptionMatcher', '.', 'find', '(', ')', ')', '{']",0
"['pigException', '=', 'true', ';']",0
"['}', 'else', '{']",1
"['Matcher', 'moreElementMatcher', '=', 'moreElementPattern', '.', 'matcher', '(', 'stackTraceLines', '[', 'lineNum', ']', ')', ';']",0
"['if', '(', 'moreElementMatcher', '.', 'find', '(', ')', ')', '{']",0
"['+', '+', 'lineNum', ';']",0
"['startingLineNum', '=', 'lineNum', ';']",0
"['/', '/', 'create', 'the', 'appropriate', 'exception', ';', 'setup', 'the', 'stack', 'trace', 'and', 'message']",0
"['Object', 'object', '=', 'PigContext', '.', 'instantiateFuncFromSpec', '(', 'exceptionName', ')', ';']",0
"['if', '(', 'object', 'instanceof', 'PigException', ')', '{']",0
"['/', '/', 'extract', 'the', 'error', 'code', 'and', 'message', 'the', 'regex', 'for', 'matching', 'the', 'custom', 'format', 'of', 'ERROR', '<', 'ERROR', 'CODE', '>', ':']",0
"['String', 'errMessageRegex', '=', '""', 'ERROR', '\\', '\\', 's', '+', '\\', '\\', 'd', '+', ':', '""', ';']",0
"['Pattern', 'errMessagePattern', '=', 'Pattern', '.', 'compile', '(', 'errMessageRegex', ')', ';']",0
"['Matcher', 'errMessageMatcher', '=', 'errMessagePattern', '.', 'matcher', '(', 'exceptionMessage', ')', ';']",0
"['if', '(', 'errMessageMatcher', '.', 'find', '(', ')', ')', '{']",0
"['String', 'errMessageStub', '=', 'errMessageMatcher', '.', 'group', '(', ')', ';']",0
"['exceptionMessage', '=', 'exceptionMessage', '.', 'substring', '(', 'errMessageMatcher', '.', 'end', '(', ')', '+', '1', ')', ';']",0
"['/', '/', 'the', 'regex', 'to', 'match', 'the', 'error', 'code', 'wich', 'is', 'a', 'string', 'of', 'numerals']",0
"['String', 'errCodeRegex', '=', '""', '\\', '\\', 'd', '+', '""', ';']",0
"['Pattern', 'errCodePattern', '=', 'Pattern', '.', 'compile', '(', 'errCodeRegex', ')', ';']",0
"['Matcher', 'errCodeMatcher', '=', 'errCodePattern', '.', 'matcher', '(', 'errMessageStub', ')', ';']",0
"['String', 'code', '=', 'null', ';']",0
"['if', '(', 'errCodeMatcher', '.', 'find', '(', ')', ')', '{']",0
"['code', '=', 'errCodeMatcher', '.', 'group', '(', ')', ';']",0
"['/', '/', 'could', 'receive', 'a', 'number', 'format', 'exception', 'here', 'but', 'it', 'will', 'be', 'propagated', 'up', 'the', 'stack']",0
"['int', 'errCode', '=', 'Integer', '.', 'parseInt', '(', 'code', ')', ';']",0
"['/', '/', 'create', 'the', 'exception', 'with', 'the', 'message', 'and', 'then', 'set', 'the', 'error', 'code', 'and', 'error', 'source']",0
"['FuncSpec', 'funcSpec', '=', 'new', 'FuncSpec', '(', 'exceptionName', ',', 'exceptionMessage', ')', ';']",0
"['object', '=', 'PigContext', '.', 'instantiateFuncFromSpec', '(', 'funcSpec', ')', ';']",0
"['(', '(', 'PigException', ')', 'object', ')', '.', 'setErrorCode', '(', 'errCode', ')', ';']",0
"['(', '(', 'PigException', ')', 'object', ')', '.', 'setErrorSource', '(', 'PigException', '.', 'determineErrorSource', '(', 'errCode', ')', ')', ';']",0
"['}', 'else', '{', '/', '/', 'else', 'for', 'if', '(', 'errMessageMatcher', '.', 'find', '(', ')', ')']",0
"['FuncSpec', 'funcSpec', '=', 'new', 'FuncSpec', '(', 'exceptionName', ',', 'exceptionMessage', ')', ';']",0
"['object', '=', 'PigContext', '.', 'instantiateFuncFromSpec', '(', 'funcSpec', ')', ';']",0
"['(', '(', 'PigException', ')', 'object', ')', '.', 'setErrorCode', '(', '2997', ')', ';', '/', '/', 'generic', 'error', 'code']",0
"['(', '(', 'PigException', ')', 'object', ')', '.', 'setErrorSource', '(', 'PigException', '.', 'BUG', ')', ';']",0
"['}', 'else', '{', '/', '/', 'else', 'for', 'if', '(', 'object', 'instanceof', 'PigException', ')']",0
"['/', '/', 'its', 'not', 'PigException', ';', 'create', 'the', 'exception', 'with', 'the', 'message']",0
"['object', '=', 'PigContext', '.', 'instantiateFuncFromSpec', '(', 'exceptionName', '+', '""', '(', '""', '+', 'exceptionMessage', '+', '""', ')', '""', ')', ';']",0
"['StackTraceElement', '[', ']', 'steArr', '=', 'new', 'StackTraceElement', '[', 'stackTraceElements', '.', 'size', '(', ')', ']', ';']",0
"['(', '(', 'Throwable', ')', 'object', ')', '.', 'setStackTrace', '(', '(', 'StackTraceElement', '[', ']', ')', '(', 'stackTraceElements', '.', 'toArray', '(', 'steArr', ')', ')', ')', ';']",0
"['if', '(', 'startingLineNum', '<', '(', 'stackTraceLines', '.', 'length', '-', '1', ')', ')', '{']",0
"['Throwable', 'e', '=', 'getExceptionFromStrings', '(', 'stackTraceLines', ',', 'startingLineNum', ')', ';']",0
"['(', '(', 'Throwable', ')', 'object', ')', '.', 'initCause', '(', 'e', ')', ';']",0
"['return', '(', 'Throwable', ')', 'object', ';']",0
"['}', 'else', '{', '/', '/', 'else', 'for', 'if', '(', 'exceptionName', '!', '=', 'null', ')']",0
"['int', 'errCode', '=', '2055', ';']",0
"['String', 'msg', '=', '""', 'Did', 'not', 'find', 'exception', 'name', 'to', 'create', 'exception', 'from', 'string', ':', '""', '+', 'stackTraceLines', '.', 'toString', '(', ')', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",1
"['}', 'else', '{', '/', '/', 'else', 'for', 'if', '(', 'lines', '.', 'length', '>', '0', ')']",0
"['int', 'errCode', '=', '2056', ';']",0
"['String', 'msg', '=', '""', 'Cannot', 'create', 'exception', 'from', 'empty', 'string', '.', '""', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",1
"['/', '*', '*']",0
"['public', 'StackTraceElement', 'getStackTraceElement', '(', 'String', 'line', ')', 'throws', 'Exception', '{']",0
"['String', '[', ']', 'items', ';']",0
"['String', 'qualifiedMethodNameRegex', '=', '""', '(', '\\', '\\', 'w', '+', '(', '\\', '\\', '$', '\\', '\\', 'w', '+', ')', '?', '\\', '\\', '.', ')', '+', '(', '<', ')', '?', '\\', '\\', 'w', '+', '(', '>', ')', '?', '""', ';']",0
"['Pattern', 'qualifiedMethodNamePattern', '=', 'Pattern', '.', 'compile', '(', 'qualifiedMethodNameRegex', ')', ';']",0
"['Matcher', 'contentMatcher', '=', 'qualifiedMethodNamePattern', '.', 'matcher', '(', 'line', ')', ';']",0
"['/', '/', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'PigMapOnly', '$', 'Map', '.', 'map', '(', 'PigMapOnly', '.', 'java', ':', '65', ')']",0
"['String', 'content', '=', 'null', ';']",0
"['if', '(', 'contentMatcher', '.', 'find', '(', ')', ')', '{']",0
"['content', '=', 'line', '.', 'substring', '(', 'contentMatcher', '.', 'start', '(', ')', ')', ';']",0
"['}', 'else', '{']",1
"['int', 'errCode', '=', '2057', ';']",0
"['String', 'msg', '=', '""', 'Did', 'not', 'find', 'fully', 'qualified', 'method', 'name', 'to', 'reconstruct', 'stack', 'trace', ':', '""', '+', 'line', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",1
"['Matcher', 'qualifiedMethodNameMatcher', '=', 'qualifiedMethodNamePattern', '.', 'matcher', '(', 'content', ')', ';']",0
"['/', '/', 'org', '.', 'apache', '.', 'pig', '.', 'backend', '.', 'hadoop', '.', 'executionengine', '.', 'mapReduceLayer', '.', 'PigMapOnly', '$', 'Map', '.', 'map']",0
"['String', 'qualifiedMethodName', '=', 'null', ';']",0
"['/', '/', '(', 'PigMapOnly', '.', 'java', ':', '65', ')']",0
"['String', 'fileDetails', '=', 'null', ';']",0
"['if', '(', 'qualifiedMethodNameMatcher', '.', 'find', '(', ')', ')', '{']",0
"['qualifiedMethodName', '=', 'qualifiedMethodNameMatcher', '.', 'group', '(', ')', ';']",0
"['fileDetails', '=', 'content', '.', 'substring', '(', 'qualifiedMethodNameMatcher', '.', 'end', '(', ')', '+', '1', ')', ';']",0
"['}', 'else', '{']",1
"['int', 'errCode', '=', '2057', ';']",0
"['String', 'msg', '=', '""', 'Did', 'not', 'find', 'fully', 'qualified', 'method', 'name', 'to', 'reconstruct', 'stack', 'trace', ':', '""', '+', 'line', ';']",0
"['throw', 'new', 'ExecException', '(', 'msg', ',', 'errCode', ',', 'PigException', '.', 'BUG', ')', ';']",1
"['/', '/', 'From', 'the', 'fully', 'qualified', 'method', 'name', ',', 'extract', 'the', 'declaring', 'class', 'and', 'method', 'name']",0
"['items', '=', 'qualifiedMethodName', '.', 'split', '(', '""', '\\', '\\', '.', '""', ')', ';']",0
"['/', '/', 'initialize', 'the', 'declaringClass', '(', 'to', 'org', 'in', 'most', 'cases', ')']",0
"['String', 'declaringClass', '=', 'items', '[', '0', ']', ';']",0
"['/', '/', 'the', 'last', 'member', 'is', 'always', 'the', 'method', 'name']",0
"['String', 'methodName', '=', 'items', '[', 'items', '.', 'length', '-', '1', ']', ';']",0
"['/', '/', 'concatenate', 'the', 'names', 'by', 'adding', 'the', 'dot', '(', '.', ')', 'between', 'the', 'members', 'till', 'the', 'penultimate', 'member']",0
"['for', '(', 'int', 'i', '=', '1', ';', 'i', '<', 'items', '.', 'length', '-', '1', ';', '+', '+', 'i', ')', '{']",0
"['declaringClass', '+', '=', '""', '.', '""', ';']",0
"['declaringClass', '+', '=', 'items', '[', 'i', ']', ';']",0
"['/', '/', 'from', 'the', 'file', 'details', 'extract', 'the', 'file', 'name', 'and', 'the', 'line', 'number']",0
"['/', '/', 'PigMapOnly', '.', 'java', ':', '65']",0
"['fileDetails', '=', 'fileDetails', '.', 'substring', '(', '0', ',', 'fileDetails', '.', 'length', '(', ')', '-', '1', ')', ';']",0
"['items', '=', 'fileDetails', '.', 'split', '(', '""', ':', '""', ')', ';']",0
"['/', '/', 'PigMapOnly', '.', 'java']",0
"['String', 'fileName', '=', 'null', ';']",0
"['int', 'lineNumber', '=', '0', ';']",0
"['if', '(', 'items', '.', 'length', '>', '0', ')', '{']",0
"['fileName', '=', 'items', '[', '0', ']', ';']",0
"['lineNumber', '=', 'Integer', '.', 'parseInt', '(', 'items', '[', '1', ']', ')', ';']",0
"['return', 'new', 'StackTraceElement', '(', 'declaringClass', ',', 'methodName', ',', 'fileName', ',', 'lineNumber', ')', ';']",0
"['private', 'String', 'getFirstLineFromMessage', '(', 'String', 'message', ')', '{']",0
"['String', '[', ']', 'messages', '=', 'message', '.', 'split', '(', 'newLine', ')', ';']",0
"['if', '(', 'messages', '.', 'length', '>', '0', ')', '{']",0
"['return', 'messages', '[', '0', ']', ';']",0
"['}', 'else', '{']",1
"['return', 'new', 'String', '(', 'message', ')', ';']",0
"['package', 'org', '.', 'apache', '.', 'pig', '.', 'test', ';']",0
"['import', 'org', '.', 'junit', '.', 'Test', ';']",0
"['import', 'junit', '.', 'framework', '.', 'TestCase', ';']",0
"['import', 'junit', '.', 'framework', '.', 'AssertionFailedError', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'Log', ';']",0
"['import', 'org', '.', 'apache', '.', 'commons', '.', 'logging', '.', 'LogFactory', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'ExecType', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigException', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'PigServer', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'PigContext', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'tools', '.', 'grunt', '.', 'Grunt', ';']",0
"['import', 'org', '.', 'apache', '.', 'pig', '.', 'impl', '.', 'util', '.', 'LogUtils', ';']",0
"['import', 'java', '.', 'io', '.', 'ByteArrayInputStream', ';']",0
"['import', 'java', '.', 'io', '.', 'InputStreamReader', ';']",0
"['import', 'java', '.', 'io', '.', 'BufferedReader', ';']",0
"['public', 'class', 'TestGrunt', 'extends', 'TestCase', '{']",0
"['MiniCluster', 'cluster', '=', 'MiniCluster', '.', 'buildCluster', '(', ')', ';']",0
"['private', 'String', 'basedir', ';']",0
"['private', 'final', 'Log', 'log', '=', 'LogFactory', '.', 'getLog', '(', 'getClass', '(', ')', ')', ';']",0
"['public', 'TestGrunt', '(', 'String', 'name', ')', '{']",0
"['super', '(', 'name', ')', ';']",0
"['basedir', '=', '""', 'test', '/', 'org', '/', 'apache', '/', 'pig', '/', 'test', '/', 'data', '""', ';']",0
"['/', '*', '@', 'Test']",0
"['public', 'void', 'testCopyFromLocal', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', 'ExecType', '.', 'MAPREDUCE', ',', 'cluster', '.', 'getProperties', '(', ')', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'copyFromLocal', '/', 'bin', '/', 'sh', '.', ';', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['}', '*', '/']",0
"['public', 'void', 'testDefine', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'define', 'myudf', 'org', '.', 'apache', '.', 'pig', '.', 'builtin', '.', 'AVG', '(', ')', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'Encountered', '\\', '""', 'define', '\\', '""', '""', ')', ')', ';']",0
"['assertTrue', '(', 'null', '!', '=', 'context', '.', 'getFuncSpecFromAlias', '(', '""', 'myudf', '""', ')', ')', ';']",0
"['public', 'void', 'testBagSchema', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'c', ':', 'chararray', ',', 'f', ':', 'float', ')', '}', ')', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testBagSchemaFail', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", 'as', '(', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'c', ':', 'chararray', ',', 'f', ':', 'float', ')', '}', ')', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['PigException', 'pe', '=', 'LogUtils', '.', 'getPigException', '(', 'e', ')', ';']",0
"['String', 'msg', '=', '(', 'pe', '=', '=', 'null', '?', 'e', '.', 'getMessage', '(', ')', ':', 'pe', '.', 'getMessage', '(', ')', ')', ';']",0
"['assertTrue', '(', 'msg', '.', 'contains', '(', '""', 'Encountered', '\\', '""', '\\', '""', ';', '""', ')', ')', ';']",0
"['public', 'void', 'testBagConstant', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testBagConstantWithSchema', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', 'b', '=', 'foreach', 'a', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', 'as', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'c', ':', 'chararray', ',', 'd', ':', 'double', ')', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testBagConstantInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', 'b', '=', 'foreach', 'a', '{', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testBagConstantWithSchemaInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'input1', ""'"", ';', 'b', '=', 'foreach', 'a', '{', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', 'as', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'c', ':', 'chararray', ',', 'd', ':', 'double', ')', '}', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingAsInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', '{', 'generate', 'SUM', '(', 'a', '.', 'fast', ')', 'as', 'fast', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingAsInForeachWithOutBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', 'generate', 'SUM', '(', 'a', '.', 'fast', ')', 'as', 'fast', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingWordWithAsInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', '{', 'generate', 'SUM', '(', 'a', '.', 'fast', ')', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingWordWithAsInForeachWithOutBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', 'generate', 'SUM', '(', 'a', '.', 'fast', ')', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingWordWithAsInForeachWithOutBlock2', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'cash', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ')', ';', 'b', '=', 'foreach', 'cash', 'generate', 'fast', '*', '2', '.', '0', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingGenerateInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', '{', 'generate', 'a', '.', 'regenerate', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingGenerateInForeachWithOutBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', 'generate', 'a', '.', 'regenerate', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingAsGenerateInForeachBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', '{', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', 'as', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'cease', ':', 'chararray', ',', 'degenerate', ':', 'double', ')', '}', ',', 'SUM', '(', 'a', '.', 'fast', ')', 'as', 'fast', ',', 'a', '.', 'regenerate', 'as', 'degenerated', ';', '}', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testParsingAsGenerateInForeachWithOutBlock', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'b', '=', 'group', 'a', 'by', 'foo', ';', 'c', '=', 'foreach', 'b', 'generate', '{', '(', '1', ',', ""'"", '1', ""'"", ',', '0', '.', '4f', ')', ',', '(', '2', ',', ""'"", '2', ""'"", ',', '0', '.', '45', ')', '}', 'as', 'b', ':', 'bag', '{', 't', '(', 'i', ':', 'int', ',', 'cease', ':', 'chararray', ',', 'degenerate', ':', 'double', ')', '}', ',', 'SUM', '(', 'a', '.', 'fast', ')', 'as', 'fast', ',', 'a', '.', 'regenerate', 'as', 'degenerated', ';', '\\', 'n', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testRunStatment', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', '""', '+']",0
"['""', 'run', '-', 'param', 'LIMIT', '=', '5', '-', 'param_file', '""', '+', 'basedir', '+']",0
"['""', '/', 'test_broken', '.', 'ppf', '""', '+', 'basedir', '+', '""', '/', 'testsub', '.', 'pig', ';', 'explain', 'bar', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testExecStatment', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['boolean', 'caught', '=', 'false', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', '""', '+']",0
"['""', 'exec', '-', 'param', 'LIMIT', '=', '5', '-', 'param', 'FUNCTION', '=', 'COUNT', '""', '+']",0
"['""', '-', 'param', 'FILE', '=', 'foo', '""', '+', 'basedir', '+', '""', '/', 'testsub', '.', 'pig', ';', 'explain', 'bar', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['caught', '=', 'true', ';']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'alias', 'bar', '""', ')', ')', ';']",0
"['assertTrue', '(', 'caught', ')', ';']",0
"['public', 'void', 'testRunStatmentNested', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'run', '""']",0
"['+', 'basedir', '+', '""', '/', 'testsubnested_run', '.', 'pig', ';', 'explain', 'bar', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['public', 'void', 'testExecStatmentNested', '(', ')', 'throws', 'Throwable', '{']",0
"['PigServer', 'server', '=', 'new', 'PigServer', '(', '""', 'MAPREDUCE', '""', ')', ';']",0
"['PigContext', 'context', '=', 'server', '.', 'getPigContext', '(', ')', ';']",0
"['boolean', 'caught', '=', 'false', ';']",0
"['String', 'strCmd', '=', '""', 'a', '=', 'load', ""'"", 'foo', ""'"", 'as', '(', 'foo', ',', 'fast', ',', 'regenerate', ')', ';', 'exec', '""']",0
"['+', 'basedir', '+', '""', '/', 'testsubnested_exec', '.', 'pig', ';', 'explain', 'bar', '""', ';']",0
"['ByteArrayInputStream', 'cmd', '=', 'new', 'ByteArrayInputStream', '(', 'strCmd', '.', 'getBytes', '(', ')', ')', ';']",0
"['InputStreamReader', 'reader', '=', 'new', 'InputStreamReader', '(', 'cmd', ')', ';']",0
"['Grunt', 'grunt', '=', 'new', 'Grunt', '(', 'new', 'BufferedReader', '(', 'reader', ')', ',', 'context', ')', ';']",0
"['grunt', '.', 'exec', '(', ')', ';']",0
"['}', 'catch', '(', 'Exception', 'e', ')', '{']",0
"['caught', '=', 'true', ';']",0
"['assertTrue', '(', 'e', '.', 'getMessage', '(', ')', '.', 'contains', '(', '""', 'alias', 'bar', '""', ')', ')', ';']",0
"['assertTrue', '(', 'caught', ')', ';']",0
